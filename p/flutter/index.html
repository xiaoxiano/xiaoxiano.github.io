<!doctype html><html lang=zh-cn dir=ltr><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta name=description content="安装 java版本控制（jvms） 我们可能需要多个java版本，主要是为了兼容Gradle版本。 下载，解压到想要的路径 管理员身份打开cmd，c"><title>flutter基础</title><link rel=canonical href=https://xiaoxiano.github.io/p/flutter/><link rel=stylesheet href=/scss/style.min.d41860860756ab9c450238ff299dc8627d464cd484019706d7090e378ee95bf0.css><meta property="og:title" content="flutter基础"><meta property="og:description" content="安装 java版本控制（jvms） 我们可能需要多个java版本，主要是为了兼容Gradle版本。 下载，解压到想要的路径 管理员身份打开cmd，c"><meta property="og:url" content="https://xiaoxiano.github.io/p/flutter/"><meta property="og:site_name" content="Janus"><meta property="og:type" content="article"><meta property="article:section" content="Post"><meta property="article:published_time" content="2022-04-30T00:00:00+00:00"><meta property="article:modified_time" content="2024-11-30T00:00:00+00:00"><meta name=twitter:title content="flutter基础"><meta name=twitter:description content="安装 java版本控制（jvms） 我们可能需要多个java版本，主要是为了兼容Gradle版本。 下载，解压到想要的路径 管理员身份打开cmd，c"><link rel=icon type=image/svg+xml href=/favicon.svg><link rel=manifest href=/site.webmanifest><link rel=mask-icon href=/safari-pinned-tab.svg color=#5bbad5><meta name=msapplication-TileColor content="#00aba9"><meta name=msapplication-TileImage content="/mstile-144x144.png"><meta name=theme-color content="#ffffff"><meta name=apple-mobile-web-app-title content="rmdhnreza.my.id - Blog Tutorial For Linux & Windows"><meta name=application-name content="rmdhnreza.my.id - Blog Tutorial For Linux & Windows"><script type=application/ld+json>{"@context":"https://schema.org","@type":"BlogPosting","name":"flutter基础","headline":"flutter基础","description":"安装 java版本控制（jvms） 我们可能需要多个java版本，主要是为了兼容Gradle版本。 下载，解压到想要的路径 管理员身份打开cmd，c","inLanguage":"id-ID","isFamilyFriendly":"true","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/xiaoxiano.github.io\/p\/flutter\/"},"author":{"@type":"Person","name":"rmdhnreza","url":"https://github.com/rmdhnreza"},"creator":{"@type":"Person","name":"rmdhnreza"},"accountablePerson":{"@type":"Person","name":"rmdhnreza"},"copyrightHolder":"Janus","copyrightYear":"2022","datePublished":"2022-04-30T00:00:00+00:00","dateModified":"2024-11-30T00:00:00+00:00","publisher":{"@type":"Organization","name":"Janus","url":"https://xiaoxiano.github.io","logo":{"@type":"ImageObject","url":"https:\/\/xiaoxiano.github.io/favicon-96x96.png","width":"112","height":"112"}},"image":"https://xiaoxiano.github.io","url":"https:\/\/xiaoxiano.github.io\/p\/flutter\/","wordCount":"26999","tag":[],"keywords":[],"articleSection":["computer"]}</script></head><body class=article-page><script>(function(){const e="StackColorScheme";localStorage.getItem(e)||localStorage.setItem(e,"auto")})()</script><script>(function(){const t="StackColorScheme",e=localStorage.getItem(t),n=window.matchMedia("(prefers-color-scheme: dark)").matches===!0;e=="dark"||e==="auto"&&n?document.documentElement.dataset.scheme="dark":document.documentElement.dataset.scheme="light"})()</script><div class="container main-container flex on-phone--column extended"><aside class="sidebar left-sidebar sticky"><button class="hamburger hamburger--spin" type=button id=toggle-menu aria-label=切换菜单>
<span class=hamburger-box><span class=hamburger-inner></span></span></button><header><figure class=site-avatar><a href=/><img src=/img/avatar_hu45d9d6b92b0e2c7b760024d72fbde663_30609_300x0_resize_box_3.png width=300 height=263 class=site-logo loading=lazy alt=Avatar></a></figure><div class=site-meta><h1 class=site-name><a href=/>Janus</a></h1><h2 class=site-description>个人杂记</h2></div></header><ul class=menu id=main-menu><li><a href=/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-home-2" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round" style="stroke-width:2.5px"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><polyline points="5 12 3 12 12 3 21 12 19 12"/><path d="M5 12v7a2 2 0 002 2h10a2 2 0 002-2v-7"/><rect x="10" y="12" width="4" height="4"/></svg>首页</a></li><li><a href=/search/><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-search" width="44" height="44" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round" style="stroke-width:2.5px"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><circle cx="10" cy="10" r="7"/><line x1="21" y1="21" x2="15" y2="15"/></svg>搜索</a></li><li><a href=/archives/><svg role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" style="fill:currentColor"><title>GitBook icon</title><path d="M10.802 17.77a.703.703.0 11-.002 1.406.703.703.0 01.002-1.406m11.024-4.347a.703.703.0 11.001-1.406.703.703.0 01-.001 1.406m0-2.876a2.176 2.176.0 00-2.174 2.174c0 .233.039.465.115.691l-7.181 3.823a2.165 2.165.0 00-1.784-.937c-.829.0-1.584.475-1.95 1.216l-6.451-3.402c-.682-.358-1.192-1.48-1.138-2.502.028-.533.212-.947.493-1.107.178-.1.392-.092.62.027l.042.023c1.71.9 7.304 3.847 7.54 3.956.363.169.565.237 1.185-.057l11.564-6.014c.17-.064.368-.227.368-.474.0-.342-.354-.477-.355-.477-.658-.315-1.669-.788-2.655-1.25-2.108-.987-4.497-2.105-5.546-2.655-.906-.474-1.635-.074-1.765.006l-.252.125C7.78 6.048 1.46 9.178 1.1 9.397.457 9.789.058 10.57.006 11.539c-.08 1.537.703 3.14 1.824 3.727l6.822 3.518a2.175 2.175.0 002.15 1.862 2.177 2.177.0 002.173-2.14l7.514-4.073c.38.298.853.461 1.337.461A2.176 2.176.0 0024 12.72a2.176 2.176.0 00-2.174-2.174"/></svg>档案</a></li><li><a href=/%E5%85%B3%E4%BA%8E/><svg xmlns="http://www.w3.org/2000/svg" fill="currentcolor" width="24" height="24" xmlns:v="https://vecta.io/nano"><path d="M12 5.9a2.1 2.1.0 110 4.2 2.1 2.1.0 110-4.2m0 9c2.97.0 6.1 1.46 6.1 2.1v1.1H5.9V17c0-.64 3.13-2.1 6.1-2.1M12 4a4 4 0 100 8 4 4 0 100-8zm0 9c-2.67.0-8 1.34-8 4v3h16v-3c0-2.66-5.33-4-8-4z"/></svg>关于</a></li><li id=dark-mode-toggle><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-left" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="8" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-toggle-right" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="16" cy="12" r="2"/><rect x="2" y="6" width="20" height="12" rx="6"/></svg><span>暗色模式</span></li><li class=menu-bottom-section></li></ul></aside><aside class="sidebar right-sidebar sticky"><section class="widget archives"><div class=widget-icon><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-hash" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><line x1="5" y1="9" x2="19" y2="9"/><line x1="5" y1="15" x2="19" y2="15"/><line x1="11" y1="4" x2="7" y2="20"/><line x1="17" y1="4" x2="13" y2="20"/></svg></div><h2 class="widget-title section-title">目录</h2><div class=widget--toc><nav id=TableOfContents><ol><li><a href=#安装>安装</a><ol><li><a href=#java版本控制jvms>java版本控制（jvms）</a></li><li><a href=#android-studio>Android Studio</a></li><li><a href=#flutter版本控制fvm>flutter版本控制（fvm）</a></li><li><a href=#直接安装>直接安装</a></li></ol></li><li><a href=#创建-flutter-项目>创建 Flutter 项目</a></li><li><a href=#构建>构建</a><ol><li><a href=#gradle>Gradle</a><ol><li><a href=#基础>基础</a></li><li><a href=#java插件>java插件</a></li></ol></li><li><a href=#故障排除>故障排除</a><ol><li><a href=#配置>配置</a></li><li><a href=#更新>更新</a></li><li><a href=#报错>报错</a></li></ol></li></ol></li><li><a href=#dart>dart</a><ol><li><a href=#变量>变量</a></li><li><a href=#类型>类型</a><ol><li><a href=#常规类型>常规类型</a></li><li><a href=#其它类型>其它类型</a></li><li><a href=#不常用的类型>不常用的类型</a></li><li><a href=#类型转换>类型转换</a></li></ol></li><li><a href=#函数>函数</a><ol><li><a href=#参数>参数</a></li></ol></li><li><a href=#运算符>运算符</a></li><li><a href=#类>类</a><ol><li><a href=#方法>方法</a><ol><li><a href=#实例变量和方法>实例变量和方法</a></li><li><a href=#静态变量和方法>静态变量和方法</a></li><li><a href=#get-和-set>get 和 set</a></li><li><a href=#抽象类抽象方法>抽象类、抽象方法</a></li><li><a href=#call>call()</a></li></ol></li><li><a href=#构造函数>构造函数</a></li><li><a href=#回调函数>回调函数</a><ol><li><a href=#function-class>Function class</a></li><li><a href=#widgets之间的通信>widgets之间的通信</a></li></ol></li><li><a href=#扩展>扩展</a><ol><li><a href=#扩展类>扩展类</a></li><li><a href=#super>super</a></li><li><a href=#扩展方法>扩展方法</a></li></ol></li></ol></li><li><a href=#泛型>泛型</a></li><li><a href=#异步>异步</a></li></ol></li><li><a href=#flutter>flutter</a><ol><li><a href=#widget生命周期>Widget生命周期</a><ol><li><a href=#使用>使用</a></li></ol></li><li><a href=#getx>Getx</a><ol><li><a href=#状态管理>状态管理</a><ol><li><a href=#介绍>介绍</a></li><li><a href=#controller>Controller</a></li><li><a href=#反应状态管理>反应状态管理</a></li><li><a href=#简单状态管理>简单状态管理</a></li><li><a href=#workers>Workers</a></li></ol></li><li><a href=#路由管理>路由管理</a><ol><li><a href=#普通路由>普通路由</a></li><li><a href=#别名路由>别名路由</a></li></ol></li><li><a href=#依赖注入>依赖注入</a></li><li><a href=#其他>其他</a><ol><li><a href=#getview>GetView</a></li><li><a href=#getxservice>GetxService</a></li><li><a href=#其他高级-api>其他高级 API</a></li></ol></li></ol></li><li><a href=#dio>dio</a><ol><li><a href=#原理>原理</a></li></ol></li><li><a href=#webview>WebView</a></li><li><a href=#flexcolorpicker>FlexColorPicker</a></li><li><a href=#widgetbook仅作了解>Widgetbook(仅作了解)</a><ol><li><a href=#windows配置>Windows配置</a></li><li><a href=#使用-1>使用</a></li></ol></li><li><a href=#plugin>Plugin</a><ol><li><a href=#flutter-1>Flutter</a></li><li><a href=#android>Android</a><ol><li><a href=#java>Java</a></li><li><a href=#进程和线程>进程和线程</a></li><li><a href=#生命周期>生命周期</a></li><li><a href=#android四大组件>android四大组件</a></li><li><a href=#builder模式>builder模式</a></li><li><a href=#channel>Channel</a></li><li><a href=#androidmanifestxml>AndroidManifest.xml</a></li><li><a href=#xml视图>XML视图</a></li></ol></li><li><a href=#常用-api>常用 API：</a></li></ol></li><li><a href=#调试>调试</a><ol><li><a href=#vs-code-debug>VS Code debug</a></li><li><a href=#布局调试>布局调试</a></li><li><a href=#模拟器>模拟器</a></li></ol></li><li><a href=#ai画图>AI画图</a></li><li><a href=#动画>动画</a></li><li><a href=#上架>上架</a><ol><li><a href=#包名>包名</a></li><li><a href=#应用名称>应用名称</a></li><li><a href=#图标>图标</a></li><li><a href=#启动图片>启动图片</a></li><li><a href=#签名安卓>签名（安卓）</a></li><li><a href=#编译>编译</a></li></ol></li><li><a href=#其他-1>其他</a></li></ol></li></ol></nav></div></section></aside><main class="main full-width"><article class=main-article itemscope itemtype=https://schema.org/Article><header class=article-header><div class=article-details><h2 class="article-title center-text"><a itemprop=url href=/p/flutter/><span itemprop=name>flutter基础</span></a></h2><div class=article-time><span class=text-time>发布时间: <time class=time datetime="2022-04-30 00:00:00 +0000 UTC" title="2022-04-30 00:00:00 +0000 UTC">April 30, 2022</time></span>
<span class=text-time>更新时间: <time class=time datetime="2024-11-30 00:00:00 +0000 UTC" title="2024-11-30 00:00:00 +0000 UTC">November 30, 2024</time></span></div><ul id=menu class="breadcrumb article-category" itemscope itemtype=https://schema.org/BreadcrumbList><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=/><span itemprop=name>Home</span><meta itemprop=position content="1"></a></li><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><a itemprop=item href=/categories/computer><span itemprop=name>computer</span></a><meta itemprop=position content="2"><li itemprop=itemListElement itemscope itemtype=https://schema.org/ListItem><span style=display:none class=bold__text itemprop=name>flutter基础</span><meta itemprop=position content="3"></li></ul></div></header><section class=article-content><h1 id=安装>安装</h1><h2 id=java版本控制jvms>java版本控制（jvms）</h2><p>我们可能需要多个java版本，主要是为了<a class=link href=https://docs.gradle.org/current/userguide/compatibility.html#compatibility target=_blank rel=noopener>兼容Gradle版本</a>。</p><ol><li><a class=link href=https://github.com/ystyle/jvms/releases target=_blank rel=noopener>下载</a>，解压到想要的路径</li><li>管理员身份打开cmd，cd到在jvms.exe所在的目录下，执行<code>jvms init</code></li><li><code>jvms.exe rls</code>可列出java版本，如果失败，打开<code>https://site.ip138.com/raw.Githubusercontent.com/</code>查看ip，在<code>C:\Windows\System32\drivers\etc\hosts</code>末尾添加一行<code>[ip] raw.githubusercontent.com</code></li><li>安装<code>jvms install [version]</code></li><li><code>jvms.exe ls</code>列出已安装JDK版本</li><li><code>jvms.exe switch [version]</code>切换版本</li><li><code>java -version</code></li><li><code>jvms.exe remove [version]</code>删除某个版本</li></ol><p><strong>更多命令</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>// 创建新项目
</span></span><span class=line><span class=cl>fvm flutter create
</span></span><span class=line><span class=cl>// 更新项目依赖
</span></span><span class=line><span class=cl>fvm flutter pub get
</span></span><span class=line><span class=cl>// 清除缓存
</span></span><span class=line><span class=cl>fvm flutter clean 
</span></span></code></pre></div><h2 id=android-studio>Android Studio</h2><p><strong>安装配置Android Studio</strong></p><p><a class=link href=https://developer.android.com/studio target=_blank rel=noopener>下载地址</a></p><p><strong>Android SDK Tools:</strong></p><ul><li>path:<code>C:\Users\[username]\AppData\Local\Android\Sdk\tools</code></li></ul><p><strong>Android SDK Platform-Tools:</strong></p><ul><li>path:<code>C:\Users\[username]\AppData\Local\Android\Sdk\platform-tools</code></li></ul><p><strong>Android SDK</strong></p><p>Tools -> SDK Manager -> 编辑Android SDK Location（默认即可）</p><ul><li>SDK Platforms：推荐Android 7.0及以上</li><li>SDK Tools<ul><li><a class=link href=https://github.com/intel/haxm/releases target=_blank rel=noopener>下载安装</a> -> Intel x86 Emulator Accelerator (HAXM installer)-Deprecated（模拟器支持）</li><li>Android SDK Command-line Tools</li></ul></li></ul><h2 id=flutter版本控制fvm>flutter版本控制（fvm）</h2><ol><li>安装 fvm，命令行运行以下命令：</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>choco install fvm
</span></span></code></pre></div><ol start=2><li>查看当前有哪些版本可用</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>fvm releases
</span></span></code></pre></div><ol start=3><li>安装指定版本</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>// 有可能缺失，建议手动下载
</span></span><span class=line><span class=cl>fvm install [version]
</span></span></code></pre></div><ol start=4><li>列出所有已安装的 Flutter SDK 版本。</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>fvm list
</span></span></code></pre></div><ol start=5><li>VS Code配置</li></ol><p>在项目中创建一个.vscode文件夹，然后创建一个名为settings.json的文件并添加：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>{
</span></span><span class=line><span class=cl>  &#34;dart.flutterSdkPath&#34;: &#34;.fvm/flutter_sdk&#34;,
</span></span><span class=line><span class=cl>  // Remove .fvm files from search
</span></span><span class=line><span class=cl>  &#34;search.exclude&#34;: {
</span></span><span class=line><span class=cl>    &#34;**/.fvm&#34;: true
</span></span><span class=line><span class=cl>  },
</span></span><span class=line><span class=cl>  // Remove from file watching
</span></span><span class=line><span class=cl>  &#34;files.watcherExclude&#34;: {
</span></span><span class=line><span class=cl>    &#34;**/.fvm&#34;: true
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><ol start=6><li>切换版本</li></ol><ul><li>全局切换：<code>fvm global [version]</code></li><li>项目中切换（每次都要）：项目目录下，终端运行<code>fvm use [version]</code>，重启vscode</li></ul><style type=text/css>.box{padding:1.6em;padding-top:1.4em;line-height:1.4em;margin-top:2em;margin-bottom:4em;border-radius:4px;color:#444;background:#f3ebe850}.box-title{margin:-18px -18px 12px;padding:4px 18px;border-radius:4px 4px 0 0;font-weight:700;color:#fff;background:#6ab0de}.box.warning .box-title{background:#ff6b6b}.box.warning{background:#ff6b6b4f}.box.info .box-title{background:#0089e488}.box.info{background:#0089e41c;box-shadow:3px 3px 5px #0089e410}.box.important .box-title{background:#f7ec2c}.box.important{background:#f7ec2c7d}.box.tip .box-title{background:#a3ffa34d}.box.tip{background:#a3ffa34d;box-shadow:3px 3px 5px #0089e410}.icon-box{display:inline-flex;align-self:center;margin-right:8px}.icon-box img,.icon-box svg{height:1em;width:1em;fill:currentColor}.icon-box img,.icon-box.baseline svg{top:.125em;position:relative}.box p{margin-bottom:.6em}.box p:first-of-type{display:inline}.box p:nth-of-type(2){margin-top:.6em}.box p:last-child{margin-bottom:0}</style><svg width="0" height="0" display="none" xmlns="http://www.w3.org/2000/svg"><symbol id="tip-box" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M504 256c0 136.967-111.033 248-248 248S8 392.967 8 256 119.033 8 256 8s248 111.033 248 248zM227.314 387.314l184-184c6.248-6.248 6.248-16.379.0-22.627l-22.627-22.627c-6.248-6.249-16.379-6.249-22.628.0L216 308.118l-70.059-70.059c-6.248-6.248-16.379-6.248-22.628.0l-22.627 22.627c-6.248 6.248-6.248 16.379.0 22.627l104 104c6.249 6.249 16.379 6.249 22.628.001z"/></symbol><symbol id="important-box" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M504 256c0 136.997-111.043 248-248 248S8 392.997 8 256C8 119.083 119.043 8 256 8s248 111.083 248 248zm-248 50c-25.405.0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346 7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373.0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884.0-12.356 5.78-11.981 12.654z"/></symbol><symbol id="warning-box" viewBox="0 0 576 512" preserveAspectRatio="xMidYMid meet"><path d="M569.517 440.013C587.975 472.007 564.806 512 527.94 512H48.054c-36.937.0-59.999-40.055-41.577-71.987L246.423 23.985c18.467-32.009 64.72-31.951 83.154.0l239.94 416.028zM288 354c-25.405.0-46 20.595-46 46s20.595 46 46 46 46-20.595 46-46-20.595-46-46-46zm-43.673-165.346 7.418 136c.347 6.364 5.609 11.346 11.982 11.346h48.546c6.373.0 11.635-4.982 11.982-11.346l7.418-136c.375-6.874-5.098-12.654-11.982-12.654h-63.383c-6.884.0-12.356 5.78-11.981 12.654z"/></symbol><symbol id="info-box" viewBox="0 0 512 512" preserveAspectRatio="xMidYMid meet"><path d="M256 8C119.043 8 8 119.083 8 256c0 136.997 111.043 248 248 248s248-111.003 248-248C504 119.083 392.957 8 256 8zm0 110c23.196.0 42 18.804 42 42s-18.804 42-42 42-42-18.804-42-42 18.804-42 42-42zm56 254c0 6.627-5.373 12-12 12h-88c-6.627.0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h12v-64h-12c-6.627.0-12-5.373-12-12v-24c0-6.627 5.373-12 12-12h64c6.627.0 12 5.373 12 12v1e2h12c6.627.0 12 5.373 12 12v24z"/></symbol></svg><div class="box info"><span class="icon-box baseline"><svg><use href="#info-box"/></svg></span><p>运行上述命令后，项目中创建了一个名为.fvm 的文件夹，文件夹中有 flutter SDK，如果不希望提交此文件夹，在.gitignore文件中添加<code>.fvm/flutter_sdk</code></p></div><ol start=7><li>删除某个版本</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>fvm remove [version]
</span></span></code></pre></div><h2 id=直接安装>直接安装</h2><ol><li>安装 JDK</li></ol><p><a class=link href=https://www.oracle.com/java/technologies/downloads/#jdk17-windows target=_blank rel=noopener>下载地址</a></p><ol start=2><li>安装flutter(windows)</li></ol><p><a class=link href=https://docs.flutter.dev/get-started/install/windows target=_blank rel=noopener>flutter安装</a></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>set PUB_HOSTED_URL=&#34;https://mirrors.tuna.tsinghua.edu.cn/dart-pub&#34;   #配置国内镜像
</span></span><span class=line><span class=cl>set FLUTTER_STORAGE_BASE_URL=&#34;https://mirrors.tuna.tsinghua.edu.cn/flutter&#34;
</span></span></code></pre></div><ol start=3><li>配置环境变量</li></ol><p><strong>Dart:</strong> 无需配置，flutter现在自带dart。</p><p><strong>Flutter:</strong></p><ul><li>path:<code>C:\flutter\bin</code></li></ul><p><strong>Java:</strong></p><ul><li><p><code>JAVA_HOME</code>:<code>C:\Program Files\Java\jdk-1.8</code></p></li><li><p>path:<code>%JAVA_HOME%\bin</code></p></li><li><p>path:<code>%JAVA_HOME%\jre\bin</code> (如果是jdk-17则不需要配置jre)</p></li><li><p>删除自动配置的环境变量path：</p><ul><li><code>C:\Program Files\Common Files\Oracle\Java\javapath</code></li><li><code>C:\Program Files (x86)\Common Files\Oracle\Java\javapath</code></li></ul></li></ul><div class="box info"><span class="icon-box baseline"><svg><use href="#info-box"/></svg></span><p>不推荐设置系统环境变量<code>classpath</code>，始终建议通过<code>-cp</code>命令传入，JVM默认的<code>classpath</code>为<code>.</code>，即当前目录。</p></div><h1 id=创建-flutter-项目>创建 Flutter 项目</h1><p><img src=/p/flutter/1.jpg width=1317 height=897 srcset="/p/flutter/1_huff754efb2c95fdbde3860fe3076e21cb_150899_480x0_resize_q75_box.jpg 480w, /p/flutter/1_huff754efb2c95fdbde3860fe3076e21cb_150899_1024x0_resize_q75_box.jpg 1024w" loading=lazy class=gallery-image data-flex-grow=146 data-flex-basis=352px></p><p><img src=/p/flutter/2.jpg width=1279 height=903 srcset="/p/flutter/2_hucf4eac703c21ad8fecf4d8297c8a4909_91996_480x0_resize_q75_box.jpg 480w, /p/flutter/2_hucf4eac703c21ad8fecf4d8297c8a4909_91996_1024x0_resize_q75_box.jpg 1024w" loading=lazy class=gallery-image data-flex-grow=141 data-flex-basis=339px></p><p><img src=/p/flutter/3.jpg width=1234 height=897 srcset="/p/flutter/3_huf5771a4378f496e08370a30e6aea2a57_268237_480x0_resize_q75_box.jpg 480w, /p/flutter/3_huf5771a4378f496e08370a30e6aea2a57_268237_1024x0_resize_q75_box.jpg 1024w" loading=lazy class=gallery-image data-flex-grow=137 data-flex-basis=330px></p><p><img src=/p/flutter/4.jpg width=1738 height=975 srcset="/p/flutter/4_hu749a3588d7f75328d4ce8cfeb04f0fea_609718_480x0_resize_q75_box.jpg 480w, /p/flutter/4_hu749a3588d7f75328d4ce8cfeb04f0fea_609718_1024x0_resize_q75_box.jpg 1024w" loading=lazy class=gallery-image data-flex-grow=178 data-flex-basis=427px></p><h1 id=构建>构建</h1><p>构建项目工具是必学内容，也是项目容易报错的部分，所以放在前面。</p><p>Gradle是Android官方工具，比Maven更灵活高效，它具有高度可定制性，以适应不同的项目。</p><h2 id=gradle>Gradle</h2><p><strong>注意不同版本的Gradle存在差异</strong></p><ul><li>一般情况下Android项目使用Android Gradle Plugin(AGP)的版本，新项目请<a class=link href="https://developer.android.com/build/releases/gradle-plugin?hl=zh-cn#updating-gradle" target=_blank rel=noopener>检查AGP对应gradle版本</a></li><li>flutter SDK有它自己对应的gradle版本</li><li>clone的java项目<a class=link href=https://gradle.org/releases/ target=_blank rel=noopener>下载相应gradle</a>到项目目录，在<code>Settings -> Build Tools -> Distribution:Local installation</code>使用。</li></ul><p>更新AGP：<code>Tools -> AGP upgrade assistant</code></p><p>更改项目/模块gradle版本：<code>File -> Project Structure -> Project/Modules</code></p><p>参考：<a class=link href=https://gradle.org/releases/ target=_blank rel=noopener>文档</a>、示例：https://docs.gradle.org/[version]/samples/index.html#java</p><h3 id=基础>基础</h3><ul><li>项目 build.gradle：配置项目整体属性，比如指定的代码仓库、依赖</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>buildscript {
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    repositories {   // gradle脚本执行需要的依赖
</span></span><span class=line><span class=cl>        google()     // 引用google上的开源项目
</span></span><span class=line><span class=cl>        jcenter()    // 引用 jcenter上的开源项目
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    dependencies {    // 依赖的jar包
</span></span><span class=line><span class=cl>        classpath &#39;com.android.tools.build:gradle:3.0.0&#39;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>allprojects {       // 项目本身需要的依赖
</span></span><span class=line><span class=cl>    repositories {
</span></span><span class=line><span class=cl>        google()
</span></span><span class=line><span class=cl>        jcenter()
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>task clean(type: Delete) {   // 执行task任务：删除根目录中的build目录
</span></span><span class=line><span class=cl>    delete rootProject.buildDir
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><ul><li>模块 build.gradle：配置当前Module的编译参数</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>// 使用插件
</span></span><span class=line><span class=cl>apply plugin: &#39;com.android.application&#39;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>android {
</span></span><span class=line><span class=cl>    compileSdk 34                                   // 设置编译时用的Android版本
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    defaultConfig {
</span></span><span class=line><span class=cl>        applicationId &#34;com.example.myapplication&#34;   // 项目的包名（子模块不能指定）
</span></span><span class=line><span class=cl>        minSdkVersion 15                            // 最低兼容的版本
</span></span><span class=line><span class=cl>        targetSdk 34                                // 目标版本
</span></span><span class=line><span class=cl>        versionCode 1                               // 版本号
</span></span><span class=line><span class=cl>        versionName &#34;1.0&#34;                           // 版本名称
</span></span><span class=line><span class=cl>        // 使用AndroidJUnitRunner进行单元测试
</span></span><span class=line><span class=cl>        testInstrumentationRunner  &#34;android.support.test.runner.AndroidJUnitRunner&#34;    
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    buildTypes {
</span></span><span class=line><span class=cl>        release {   // 生产环境
</span></span><span class=line><span class=cl>            buildConfigField(&#34;boolean&#34;, &#34;LOG_DEBUG&#34;, &#34;false&#34;)     // 配置Log日志
</span></span><span class=line><span class=cl>            buildConfigField(&#34;String&#34;, &#34;URL_PERFIX&#34;, &#34;&#34;https://release.cn/&#34;&#34;)    // 配置URL前缀
</span></span><span class=line><span class=cl>            minifyEnabled false                                   // 是否对代码进行混淆
</span></span><span class=line><span class=cl>            //指定混淆的规则文件
</span></span><span class=line><span class=cl>            proguardFiles getDefaultProguardFile(&#39;proguard-android.txt&#39;), &#39;proguard-rules.pro&#39;
</span></span><span class=line><span class=cl>            signingConfig signingConfigs.release                  // 设置签名信息
</span></span><span class=line><span class=cl>            pseudoLocalesEnabled false                            // 是否在APK中生成伪语言环境，帮助国际化
</span></span><span class=line><span class=cl>            zipAlignEnabled true                                  // 是否对APK包进行ZIP对齐优化
</span></span><span class=line><span class=cl>            applicationIdSuffix &#39;test&#39;                            // 在applicationId 中添加了一个后缀，一般使用的不多
</span></span><span class=line><span class=cl>            versionNameSuffix &#39;test&#39;                              // 在applicationId 中添加了一个后缀，一般使用的不多
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>        debug {   // 测试环境
</span></span><span class=line><span class=cl>            buildConfigField(&#34;boolean&#34;, &#34;LOG_DEBUG&#34;, &#34;true&#34;)                  // 配置Log日志
</span></span><span class=line><span class=cl>            buildConfigField(&#34;String&#34;, &#34;URL_PERFIX&#34;, &#34;&#34;https://test.com/&#34;&#34;)   // 配置URL前缀
</span></span><span class=line><span class=cl>            minifyEnabled false                                               //是否对代码进行混淆
</span></span><span class=line><span class=cl>            //指定混淆的规则文件
</span></span><span class=line><span class=cl>            proguardFiles getDefaultProguardFile(&#39;proguard-android.txt&#39;), &#39;proguard-rules.pro&#39;   
</span></span><span class=line><span class=cl>            signingConfig signingConfigs.debug                                // 设置签名信息
</span></span><span class=line><span class=cl>            debuggable false                                                  // 是否支持断点调试
</span></span><span class=line><span class=cl>            jniDebuggable false                                               // 是否可以调试NDK代码
</span></span><span class=line><span class=cl>            renderscriptDebuggable false                                      // 是否开启渲染脚本
</span></span><span class=line><span class=cl>            zipAlignEnabled true                                              // 是否对APK包执行ZIP对齐优化
</span></span><span class=line><span class=cl>            pseudoLocalesEnabled false                                        // 是否在APK中生成伪语言环境，帮助国际化
</span></span><span class=line><span class=cl>            applicationIdSuffix &#39;test&#39;                                        // 在applicationId 中添加了一个后缀，一般使用的不多
</span></span><span class=line><span class=cl>            versionNameSuffix &#39;test&#39;                                          // 在applicationId 中添加了一个后缀，一般使用的不多
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>dependencies {     //项目的依赖关系
</span></span><span class=line><span class=cl>    👉// 本地jar包依赖：新建 Project\app\libs 文件夹，粘贴 jar
</span></span><span class=line><span class=cl>    implementation fileTree(include: [&#39;*.jar&#39;], dir: &#39;libs&#39;)    
</span></span><span class=line><span class=cl>    testImplementation &#39;junit:junit:4.12&#39;                       // 声明测试用例库
</span></span><span class=line><span class=cl>    implementation &#39;com.android.support:appcompat-v7:26.1.0&#39;    // 远程依赖
</span></span><span class=line><span class=cl>    implementation project(&#39;:library&#39;)                          // 项目本地的Library模块
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><details class=spoiler id=spoiler-2><summary>其他配置</summary><p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>android {
</span></span><span class=line><span class=cl>    signingConfigs {                        // 自动化打包配置
</span></span><span class=line><span class=cl>            release {                       // 线上环境
</span></span><span class=line><span class=cl>                keyAlias &#39;test&#39;
</span></span><span class=line><span class=cl>                keyPassword &#39;123456&#39;
</span></span><span class=line><span class=cl>                storeFile file(&#39;test.keystore&#39;)
</span></span><span class=line><span class=cl>                storePassword &#39;123456&#39;
</span></span><span class=line><span class=cl>            }
</span></span><span class=line><span class=cl>            debug {                         // 开发环境
</span></span><span class=line><span class=cl>                keyAlias &#39;test&#39;
</span></span><span class=line><span class=cl>                keyPassword &#39;123456&#39;
</span></span><span class=line><span class=cl>                storeFile file(&#39;test.keystore&#39;)
</span></span><span class=line><span class=cl>                storePassword &#39;123456&#39;
</span></span><span class=line><span class=cl>            }
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    sourceSets {                             // 目录指向配置
</span></span><span class=line><span class=cl>            main {
</span></span><span class=line><span class=cl>                jniLibs.srcDirs = [&#39;libs&#39;]   // 指定lib库目录
</span></span><span class=line><span class=cl>            }
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>    packagingOptions{
</span></span><span class=line><span class=cl>            // 当有重复文件时 ,使用第一个匹配的文件打包进apk
</span></span><span class=line><span class=cl>            pickFirsts = [&#39;META-INF/LICENSE&#39;]
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            // 当出现重复文件时 合并重复的文件打包进apk
</span></span><span class=line><span class=cl>            merge &#39;META-INF/LICENSE&#39;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            // 同时使用butterknife、dagger2框架处理 （常用）
</span></span><span class=line><span class=cl>            exclude &#39;META-INF/services/javax.annotation.processing.Processor&#39;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    productFlavors {
</span></span><span class=line><span class=cl>        wandoujia {     // 豌豆荚渠道包配置
</span></span><span class=line><span class=cl>            manifestPlaceholders = [UMENG_CHANNEL_VALUE: &#34;wandoujia&#34;]
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>        xiaomi {
</span></span><span class=line><span class=cl>            manifestPlaceholders = [UMENG_CHANNEL_VALUE: &#34;xiaomi&#34;]
</span></span><span class=line><span class=cl>            applicationId &#34;com.wiky.gradle.xiaomi&#34;   // 配置包名
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>        _360 {
</span></span><span class=line><span class=cl>            manifestPlaceholders = [UMENG_CHANNEL_VALUE: &#34;_360&#34;]
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>        //...
</span></span><span class=line><span class=cl>    } 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    lintOptions {                     // 关闭检查lint（有错误会停止build）
</span></span><span class=line><span class=cl>            abortOnError false        // 即使报错也不会停止打包
</span></span><span class=line><span class=cl>            checkReleaseBuilds false  // 打包release版本的时候进行检测
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>    buildFeatures { // true表示生成build/app/generated/source/buildConfig/release/com/example/app/BuildConfig.java，不需要手动维护版本号、渠道等常量
</span></span><span class=line><span class=cl>        buildConfig = false
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div></p></details><ul><li>gradle-wrapper-properties：配置 Gradle Wrapper</li><li>gradle-properties：配置 Gradle编译参数，详见<a class=link href=URLhttps://docs.gradle.org/current/userguide/build_environment.html#sec:gradle_configuration_properties>文档</a></li><li>setting.gradle：配置 Gradle 的多项目管理</li><li>local.properties：存放 Android 项目的私有属性配置，如 SDK 路径</li><li>multiDexKeep.pro、proguard-rules.pro：可选的混淆文件，用于配置放置在主 Dex 的类、声明避免混淆的类</li></ul><h3 id=java插件>java插件</h3><p><a class=link href="https://juejin.cn/post/7098383560746696718?searchId=20241129193310F29515280AF1035FC168#heading-9" target=_blank rel=noopener>参考</a></p><p><strong>简介</strong></p><ul><li>Android App：APK文件，新建时选择Empty Views Activity</li><li>Android Library：ARR文件，在目录结构上与Android App相同，包含构建APP所需的一切。当你需要构建不同的APK时，具有通用的模块（如账户管理），可以将library添加为每个APP模块的依赖项</li><li>Java or Kotlin Library（插件）：JAR文件，打包可重用的代码，不含资源文件，如res中的图片</li></ul><p><strong>使用</strong></p><ol><li>生成jar\arr</li></ol><p>Android Studio 打开右侧的 Gradle，选择需要打包的module —> Tasks —> build, 双击 assemble</p><ol start=2><li><p>生成jar\arr到Project\build\library\libs或outputs\aar，移到Project\app\libs</p></li><li><p>在模块gradle添加</p></li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>implementation fileTree(dir: &#39;libs&#39;, include: [&#39;*.aar&#39;])
</span></span><span class=line><span class=cl>implementation fileTree(dir: &#39;libs&#39;, include: [&#39;*.jar&#39;])
</span></span></code></pre></div><p><strong>自定义插件的三种方式</strong></p><ul><li>build script：在<code>build.gradle</code>脚本中直接编写，只能在本文件内使用</li><li>buildSrc项目：新建一个名为<code>buildSrc</code>的Module，Gradle会自动编译和测试，只能在本项目中使用</li><li>独立项目：在独立的项目中编写插件，发布到本地或者远程jcenter、maven仓库供其他项目使用</li></ul><p>独立项目打包jar到maven：</p><ol><li><p>在项目中新建File -> New -> New Module -> Java or Kotlin Library</p></li><li><p>修改build.gradle：</p></li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>// Gradle插件
</span></span><span class=line><span class=cl>apply plugin: &#39;groovy&#39;
</span></span><span class=line><span class=cl>apply plugin: &#39;maven&#39;
</span></span><span class=line><span class=cl>apply plugin: &#39;java-gradle-plugin&#39;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 依赖
</span></span><span class=line><span class=cl>dependencies {
</span></span><span class=line><span class=cl>    implementation gradleApi()     //Groovy DSL
</span></span><span class=line><span class=cl>    implementation localGroovy()   //Gradle DSL
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 仓库
</span></span><span class=line><span class=cl>repositories {
</span></span><span class=line><span class=cl>    mavenCentral()
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 配置插件id和映射类（生成resources文件夹储存)
</span></span><span class=line><span class=cl>gradlePlugin {
</span></span><span class=line><span class=cl>    plugins {
</span></span><span class=line><span class=cl>        greeting {
</span></span><span class=line><span class=cl>            // 插件id
</span></span><span class=line><span class=cl>            id = &#39;CustomPlugin&#39;
</span></span><span class=line><span class=cl>            // 插件实现类
</span></span><span class=line><span class=cl>            implementationClass = &#39;com.group.myplugin.CustomPlugin&#39;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>def group=&#39;com.group.myplugin&#39;
</span></span><span class=line><span class=cl>def artifactId=&#39;myplugin&#39;
</span></span><span class=line><span class=cl>def version=&#39;1.0.0&#39;
</span></span><span class=line><span class=cl>// 指定本地maven的路径，在插件目录下
</span></span><span class=line><span class=cl>def uploadRepo = &#39;../myplugin&#39;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 打包到本地maven仓库
</span></span><span class=line><span class=cl>uploadArchives {
</span></span><span class=line><span class=cl>    repositories {
</span></span><span class=line><span class=cl>        mavenDeployer {
</span></span><span class=line><span class=cl>            pom.groupId = group
</span></span><span class=line><span class=cl>            pom.artifactId = artifactId
</span></span><span class=line><span class=cl>            pom.version = version
</span></span><span class=line><span class=cl>            repository(url: uri(uploadRepo))
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><ol start=3><li>新建CustomPlugin.groovy文件写插件：实现Plugin接口</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>package com.group.myplugin
</span></span><span class=line><span class=cl>import org.gradle.api.Plugin
</span></span><span class=line><span class=cl>import org.gradle.api.Project
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>class CustomPlugin implements Plugin<span class=p>&lt;</span><span class=nt>Project</span><span class=p>&gt;</span> {
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    @Override
</span></span><span class=line><span class=cl>    void apply(Project project) {
</span></span><span class=line><span class=cl>        println(&#34;Hello gradle plugin&#34;)
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><ol start=4><li>将插件发布到本地 Maven 仓库的2种方式：</li></ol><ul><li><p>执行<code>./gradlew uploadArchives</code>命令</p></li><li><p>可视化界面的 uploadArchives Task 点击发布</p></li></ul><h2 id=故障排除>故障排除</h2><h3 id=配置>配置</h3><ul><li>配置build.gradle(project:android)</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>allprojects {
</span></span><span class=line><span class=cl>    repositories {
</span></span><span class=line><span class=cl>        google()
</span></span><span class=line><span class=cl>        jcenter()
</span></span><span class=line><span class=cl>        maven { url &#34;https://storage.googleapis.com/download.flutter.io&#34; }
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><h3 id=更新>更新</h3><ul><li>flutter</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>flutter upgrade
</span></span><span class=line><span class=cl>flutter doctor
</span></span></code></pre></div><h3 id=报错>报错</h3><p><strong>查看错误信息</strong>
控制台Terminal：<code>./gradlew assembleDebug --info</code></p><p><strong>常见错误</strong></p><ul><li>更新Android Studio</li><li>重新建项目</li><li>\android\app\build.gradle</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>compileSdkVersion 33
</span></span><span class=line><span class=cl>minSdkVersion 21
</span></span></code></pre></div><p><strong>其他错误</strong></p><ul><li>Attribute application@label value=(Dormitory) from AndroidManifest.xml</li></ul><p>解决：进入\android\app\src\main\AndroidManifest.xml</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>manifest</span> <span class=na>xmlns:android</span><span class=o>=</span><span class=s>&#34;http://schemas.android.com/apk/res/android&#34;</span>
</span></span><span class=line><span class=cl>    <span class=na>xmlns:tools</span><span class=o>=</span><span class=s>&#34;http://schemas.android.com/tools&#34;</span>  <span class=err>//</span> <span class=err>添加此行</span>
</span></span><span class=line><span class=cl>    <span class=na>package</span><span class=o>=</span><span class=s>&#34;com.example.model_dev&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>   <span class=p>&lt;</span><span class=nt>application</span>
</span></span><span class=line><span class=cl>        <span class=na>tools:replace</span><span class=o>=</span><span class=s>&#34;android:label&#34;</span>              <span class=err>//</span> <span class=err>添加此行</span>
</span></span><span class=line><span class=cl>        <span class=na>android:label</span><span class=o>=</span><span class=s>&#34;model_dev&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;${applicationName}&#34;</span>
</span></span><span class=line><span class=cl>        <span class=na>android:icon</span><span class=o>=</span><span class=s>&#34;@mipmap/ic_launcher&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>activity</span>
</span></span></code></pre></div><ul><li>Gradle threw an error while downloading artifacts from the network</li></ul><p>解决：Gradle损坏，进入 C:\Users\username 删除 .gradle 文件夹</p><ul><li>Execution failed for task:generateDebugRFile
Android Studio -> Analyze -> Code Inspect</li></ul><h1 id=dart>dart</h1><h2 id=变量>变量</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl># 创建一个变量并将其初始化
</span></span><span class=line><span class=cl>var name = &#39;Bob&#39;;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 指定类型
</span></span><span class=line><span class=cl>String name = &#39;Bob&#39;;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl># 如果对象(name)不局限于单一的类型(例如String),可以将其指定为 Object（或 dynamic）类型
</span></span><span class=line><span class=cl>Object name = &#39;Bob&#39;;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>? 可空类型
</span></span><span class=line><span class=cl>int? a=123;   // int? 表示a是一个可空类型
</span></span><span class=line><span class=cl>int? a;  // 未初始化变量的初始值为null 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>! 类型断言
</span></span><span class=line><span class=cl>a!    // a不为空
</span></span></code></pre></div><ul><li>late
<a class=link href=https://dart.dev/null-safety/understanding-null-safety#lazy-initialization target=_blank rel=noopener>延迟初始化</a>:字段被第一次访问时延迟运行，而不是在实例化后立即运行。</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>class Weather {
</span></span><span class=line><span class=cl>  late int _temperature = _readThermometer();
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><ul><li>final
已经实例化的final对象不能指向另一个不同的对象，但其字段可以更改。</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>final name = &#39;Bob&#39;; 
</span></span><span class=line><span class=cl>final String nickname = &#39;Bobby&#39;;
</span></span></code></pre></div><ul><li>const
编译时常量：一经定义就会在编译期间对其进行初始化，const对象及其字段无法更改。</li></ul><h2 id=类型>类型</h2><h3 id=常规类型>常规类型</h3><div class="box info"><span class="icon-box baseline"><svg><use href="#info-box"/></svg></span><p>注意首字母大小写</p></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>int    整数值
</span></span><span class=line><span class=cl>double 浮点数字
</span></span><span class=line><span class=cl>String 字符串                  
</span></span><span class=line><span class=cl>bool   布尔类型
</span></span><span class=line><span class=cl>List   列表类型
</span></span><span class=line><span class=cl>Map    字典型
</span></span></code></pre></div><ul><li><p>List<br>属性：</p><ul><li>length　　　　　　　　　　长度</li><li>reversed　　　　　　　　　翻转</li><li>isEmpty　　　　　　　　　是否为空</li><li>isNotEmpty　　　　　　　是否不为空</li></ul><p>方法：</p><ul><li>add()　　　　　　　　　　　　　增加</li><li>addAll()　　　　　　　　　　　　拼接数组</li><li>indexOf()　　　　　　　　　　　查找 传入具体值</li><li>remove()　　　　　　　　　　　删除 传入具体值</li><li>removeAt()　　　　　　　　　　删除 传入索引值</li><li>fillRange()　　　　　　　　　　　修改</li><li>insert(index,value);　　　　　　　指定位置插入</li><li>insertAll(index,list)　　　　　　　指定位置插入List</li><li>toList()　　　　　　　　　　　　其他类型转换成List</li><li>join()　　　　　　　　　　　　　List转换成字符串</li><li>split()　　　　　　　　　　　　　字符串转化成List</li><li>forEach()</li><li>map()<br>示例：<code>List&lt;Widget>.from(MyMap.keys.map((item) => SomeWidget(item)).toList());</code><br>map()可以传入List或Map的每项数据，toList()转换成List，List<widget>.from接收Iterable（[Map.keys]、[List] 和 [Set] 都是 <code>Iterable</code>），返回widget List。</li><li>where()</li><li>any()</li><li>every()</li></ul></li><li><p>Map<br>属性：</p><ul><li>keys　　　　　　　　　获取所有的key值</li><li>values　　　　　　　　获取所有的value值</li><li>isEmpty　　　　　　　　是否为空</li><li>isNotEmpty　　　　　　是否不为空</li></ul><p>方法：</p><ul><li>remove(key)　　　　　　　　　删除指定key的数据</li><li>addAll({&mldr;})　　　　　　　　　合并映射 给映射内增加属性</li><li>containsValue()　　　　　　　查看映射内的值 返回true/false</li><li>forEach()</li><li>map()</li><li>where()</li><li>any()</li><li>every()</li></ul></li></ul><h3 id=其它类型>其它类型</h3><ul><li><p><a class=link href=https://dart.dev/guides/language/language-tour#enumerated-types target=_blank rel=noopener>enum</a>　　枚举类型,用于表示固定数量的常量值。在switch语句中运行良好。</p></li><li><p>Object　对象类型，允许任何类型。</p></li><li><p><a class=link href=https://dart.dev/guides/language/effective-dart/design#avoid-using-dynamic-unless-you-want-to-disable-static-checking target=_blank rel=noopener>dynamic</a>　动态类型，不仅接受所有对象，而且还允许所有操作</p></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>void main() {
</span></span><span class=line><span class=cl>  dynamic foo=&#34;bar&#34;;
</span></span><span class=line><span class=cl>  print(foo); 
</span></span><span class=line><span class=cl>  foo=123;
</span></span><span class=line><span class=cl>  print(foo);
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><ul><li>Set　无序集合，主要的功能就是去除数组重复内容</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>void main(){
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  List myList=[&#39;香蕉&#39;,&#39;苹果&#39;,&#39;西瓜&#39;,&#39;香蕉&#39;,&#39;苹果&#39;,&#39;香蕉&#39;,&#39;苹果&#39;];
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  var s=new Set();
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  s.addAll(myList);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  print(s);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  print(s.toList());
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><ul><li>Future　用于<a class=link href=https://dart.dev/language/async target=_blank rel=noopener>异步支持</a>。</li><li>Stream　用于异步支持。</li><li>Iterable　用在<a class=link href=https://dart.dev/guides/libraries/library-tour#iteration target=_blank rel=noopener>for-in 循环</a>和同步<a class=link href=https://dart.dev/language/functions#generators target=_blank rel=noopener>生成器函数</a>中。</li><li>Never　表示表达式永远无法成功完成计算。最常用于总是抛出异常的函数。</li><li>void　表示从未使用过某个值。通常用作返回类型。</li><li>(value1, value2)　记录（需dart3）</li><li>Null　空值</li></ul><h3 id=不常用的类型>不常用的类型</h3><ul><li><p>runes 暴露了字符串的 Unicode 代码点（Unicode 为每个字母、数字和符号定义了一个唯一的数值）。例如，用于表情符号，(😆) 是<code>\u{1f606}</code>。经常被 &ldquo;characters&rdquo; API 取代。</p></li><li><p>Symbol 表示标识符，例如<code>#</code>。</p></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>void main() {
</span></span><span class=line><span class=cl>  assert(Symbol(&#39;bar&#39;)==#bar);
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>// true
</span></span></code></pre></div><h3 id=类型转换>类型转换</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>myint = int.parse(myString);            // String -&gt; int
</span></span><span class=line><span class=cl>myString = myint.toString();            // int -&gt; String
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>mydouble = double.parse(myString);      // String -&gt; double
</span></span><span class=line><span class=cl>myString = 3.14159.toStringAsFixed(2);  // double -&gt; String (myString = &#39;3.14&#39;) 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>mynum.member = mynum.values.byName(myString);   // String -&gt; enum
</span></span><span class=line><span class=cl>myString = mynum.member.name;                   // enum -&gt; String
</span></span></code></pre></div><h2 id=函数>函数</h2><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>bool isNoble(int atomicNumber) {                 // bool:返回类型
</span></span><span class=line><span class=cl>  return _nobleGases[atomicNumber] != null;
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><ul><li><p>箭头函数 =></p><p><code>=> expr</code> 是 <code>{ return expr; }</code>的简写</p></li></ul><h3 id=参数>参数</h3><ul><li>命名参数（可传可不传）</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>  String printUserInfo(String username, {int age = 0, String sex = &#39;男&#39;}) {//行参，用大括号    
</span></span><span class=line><span class=cl>    if (age != 0) {
</span></span><span class=line><span class=cl>      return &#34;姓名:$username---性别:$sex--年龄:$age&#34;;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    return &#34;姓名:$username---性别:$sex--年龄保密&#34;;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>  print(printUserInfo(&#39;张三&#39;));                         //实参 
</span></span><span class=line><span class=cl>  print(printUserInfo(&#39;张三&#39;, age: 20, sex: &#39;未知&#39;));   //实参,命名参数的实参必须传入参数名age: sex: 
</span></span></code></pre></div><ul><li>位置参数（可传可不传）</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>  String printUserInfo(String username,[String sex=&#39;男&#39;,int age=0]){  //行参，用中括号
</span></span><span class=line><span class=cl>    if(age!=0){
</span></span><span class=line><span class=cl>      return &#34;姓名:$username---性别:$sex--年龄:$age&#34;;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>    return &#34;姓名:$username---性别:$sex--年龄保密&#34;;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>  print(printUserInfo(&#39;张三&#39;));           //实参
</span></span><span class=line><span class=cl>  print(printUserInfo(&#39;小李&#39;,&#39;女&#39;,30));   //实参
</span></span></code></pre></div><h2 id=运算符>运算符</h2><ul><li><p>算术运算符</p><p><code>+</code>(加)　　<code>–</code>(减)　　<code>-</code>(负)　　<code>*</code>(乘)　　<code>/</code>(除)　　<code>~/</code>(取整)　　<code>%</code>（取余）</p></li><li><p>关系运算符</p><p><code>==</code>　　<code>！=</code>　　<code>></code>　　<code>&lt;</code>　　<code>>=</code>　　<code>&lt;=</code></p></li><li><p>逻辑运算符</p><p><code>!</code>(取反)　　<code>&&</code>(与)　　<code>||</code>(或)</p></li><li><p>赋值运算符</p><p>基础赋值运算符　　<code>=</code>　　<code>??=</code>(为 null 的变量赋值)</p><p>复合赋值运算符　　<code>+=</code>　　<code>-=</code>　　<code>*=</code>　　<code>/=</code>　　<code>%=</code>　　<code>~/=</code></p></li><li><p>其他运算符
<code>()</code>　　使用一个方法</p><p><code>[]</code>　　访问 List</p><p><code>?[]</code>　　访问 List,左侧/?表示可以为null</p><p><code>.</code>　　访问成员</p><p><code>?.</code>　　访问成员,左侧/?表示可以为null</p><p><code>..</code> 级联，可以在同一个对象上访问实例成员和调用多个实例方法</p></li><li><p>if-else的表达式：</p><ul><li>condition <code>?</code> expr1 <code>:</code> expr2</li></ul><p>如果条件为真，则计算expr1（并返回其值）；否则，计算并返回expr2的值。</p><ul><li>expr1 <code>??</code> expr2</li></ul><p>如果expr1不为 null，则返回其值；否则，计算并返回expr2的值。</p></li></ul><h2 id=类>类</h2><h3 id=方法>方法</h3><h4 id=实例变量和方法>实例变量和方法</h4><p>实例变量:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>class Point {
</span></span><span class=line><span class=cl>  double? x; // Declare instance variable x, initially null.
</span></span><span class=line><span class=cl>  double? y; // Declare y, initially null.
</span></span><span class=line><span class=cl>  double z = 0; // Declare z, initially 0.
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>实例方法可以访问实例变量和 this</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>import &#39;dart:math&#39;;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>class Point {
</span></span><span class=line><span class=cl>  final double x;
</span></span><span class=line><span class=cl>  final double y;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  Point(this.x, this.y);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  double distanceTo(Point other) {
</span></span><span class=line><span class=cl>    var dx = x - other.x;
</span></span><span class=line><span class=cl>    var dy = y - other.y;
</span></span><span class=line><span class=cl>    return sqrt(dx * dx + dy * dy);
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><h4 id=静态变量和方法>静态变量和方法</h4><p>使用关键字 static 可以声明类变量或类方法。静态成员可以通过类名称直接访问（不需要实例化），提高性能。静态方法不能访问非静态成员，非静态方法可以访问静态成员，不能使用this关键字。</p><h4 id=get-和-set>get 和 set</h4><p>特殊方法:实例对象的每一个属性都有一个隐式的 Getter 方法，非 final 属性还会有一个 Setter 方法。</p><ul><li>通过get和set修饰的方法不带小括号，可以使访问方法像访问属性一样，简便我们的使用、访问</li><li>set：传入属性，get：访问属性。</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>class Rectangle {
</span></span><span class=line><span class=cl>  double left, top, width, height;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  Rectangle(this.left, this.top, this.width, this.height);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  double get right =&gt; left + width;
</span></span><span class=line><span class=cl>  set right(double value) =&gt; left = value - width;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>void main() {
</span></span><span class=line><span class=cl>  var rect = Rectangle(3, 4, 20, 15);
</span></span><span class=line><span class=cl>  // 通过getter访问 right
</span></span><span class=line><span class=cl>  assert(rect.right == 23);
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>  // 通过setter修改  right 属性
</span></span><span class=line><span class=cl>  rect.right = 12;
</span></span><span class=line><span class=cl>  assert(rect.left == -8);
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><h4 id=抽象类抽象方法>抽象类、抽象方法</h4><p>抽象类常用于定义接口，抽象类常常会包含抽象方法</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>abstract class Doer {
</span></span><span class=line><span class=cl>  // Define instance variables and methods...
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  void doSomething(); // Define an abstract method.
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>class EffectiveDoer extends Doer {
</span></span><span class=line><span class=cl>  void doSomething() {
</span></span><span class=line><span class=cl>    // Provide an implementation, so the method is not abstract here...
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><h4 id=call>call()</h4><p>在别人项目经常看到此方法，看其解释感觉可以省略不写。</p><p>所有 Dart函数（具有函数类型而不是类/接口类型的对象）都有一个call方法。</p><p>该call方法与函数本身具有相同的函数类型，并且在调用它时它的行为完全相同。您甚至可以说调用函数就是隐式调用其call方法。如果您编写函数调用e1(e2, e3)，那么编译器会检查是否e1有call方法，如果有，则将其转换为方法调用e1.call(e2, e3)。</p><h3 id=构造函数>构造函数</h3><link href="https://fonts.googleapis.com/css?family=default" rel=stylesheet type=text/css><div style=font-family:default;font-size:20px;font-style:normal;font-weight:700;color:blue>特点：</div><ul><li><p>实例化类时会被自动触发</p></li><li><p>一般用于初始化操作</p></li><li><p>没有返回值</p></li></ul><link href="https://fonts.googleapis.com/css?family=default" rel=stylesheet type=text/css><div style=font-family:default;font-size:20px;font-style:normal;font-weight:700;color:blue>普通构造函数</div><p>构造函数方法名和类名相同</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>class Point {
</span></span><span class=line><span class=cl>  num x, y;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  Point(num x, num y) {
</span></span><span class=line><span class=cl>    // There&#39;s a better way to do this, stay tuned.
</span></span><span class=line><span class=cl>    this.x = x;
</span></span><span class=line><span class=cl>    this.y = y;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>简化形式：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>class Point {
</span></span><span class=line><span class=cl>  num x, y;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  // Syntactic sugar for setting x and y
</span></span><span class=line><span class=cl>  // before the constructor body runs.
</span></span><span class=line><span class=cl>  Point(this.x, this.y);
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><link href="https://fonts.googleapis.com/css?family=default" rel=stylesheet type=text/css><div style=font-family:default;font-size:20px;font-style:normal;font-weight:700;color:blue>命名构造函数</div><p>命名构造函数(类名.函数名)可以实现多个构造器。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>class Point {
</span></span><span class=line><span class=cl>  num x, y;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  Point(this.x, this.y);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  // 命名构造函数
</span></span><span class=line><span class=cl>  Point.origin() {
</span></span><span class=line><span class=cl>    x = 0;
</span></span><span class=line><span class=cl>    y = 0;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>请记住，命名构造函数不可继承，如果子类想要有 和父类一样的命名构造函数，那就写个同名的（通常也会在子类的命名构造函数里，调用父类的同名命名构造函数）</p><link href="https://fonts.googleapis.com/css?family=default" rel=stylesheet type=text/css><div style=font-family:default;font-size:20px;font-style:normal;font-weight:700;color:blue>调用父类构造函数</div><p>如果你的类，继承于父类，那么子类的构造函数，势必要调用父类的构造函数，这时候就要分两种情况：</p><ul><li>Dart语言帮你调用父类的无参数构造函数</li><li>代码中显式调用父类的构造函数</li></ul><ol><li>默认调用调用父类的无参数构造函数</li></ol><p>如果你没有显式调用父类的构造函数，并且父类有一个无参数构造函数，那么Dart就会帮你在子类的构造函数方法体的最前面，调用父类的无参数构造函数。当然，后面我们会说道，构造函数分成好几部分来初始化成员变量，调用的顺序如下：</p><ul><li>初始化列表</li><li>父类的无参数构造函数</li><li>子类的无参数构造函数</li></ul><p>当然，如果父类没有无参数构造函数，或者Dart这种隐式调用无法满足你的要求，那就需要显式调用父类的构造函数了</p><ol start=2><li>显式调用父类构造函数</li></ol><p>显式调用父类构造函数，应该在初始化列表中完成</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>class Person {
</span></span><span class=line><span class=cl>  String firstName;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  Person.fromJson(Map data) {
</span></span><span class=line><span class=cl>    print(&#39;in Person&#39;);
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>class Employee extends Person {
</span></span><span class=line><span class=cl>  // Person does not have a default constructor;
</span></span><span class=line><span class=cl>  // you must call super.fromJson(data).
</span></span><span class=line><span class=cl>  Employee.fromJson(Map data) : super.fromJson(data) {
</span></span><span class=line><span class=cl>    print(&#39;in Employee&#39;);
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>main() {
</span></span><span class=line><span class=cl>  var emp = new Employee.fromJson({});
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  // Prints:
</span></span><span class=line><span class=cl>  // in Person
</span></span><span class=line><span class=cl>  // in Employee
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><link href="https://fonts.googleapis.com/css?family=default" rel=stylesheet type=text/css><div style=font-family:default;font-size:20px;font-style:normal;font-weight:700;color:blue>初始化列表</div><p>在构造函数后加上<code>: x = , y =</code></p><ul><li><p>可以在构造函数中设置属性的默认值</p></li><li><p>在构造函数体执行之前执行</p></li><li><p>可以调用超类的构造函数</p></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>// Initializer list sets instance variables before
</span></span><span class=line><span class=cl>// the constructor body runs.
</span></span><span class=line><span class=cl>Point.fromJson(Map<span class=p>&lt;</span><span class=nt>String</span><span class=err>,</span> <span class=na>num</span><span class=p>&gt;</span> json)
</span></span><span class=line><span class=cl>    : x = json[&#39;x&#39;],
</span></span><span class=line><span class=cl>      y = json[&#39;y&#39;] {
</span></span><span class=line><span class=cl>  print(&#39;In Point.fromJson(): ($x, $y)&#39;);
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>尤其是初始化那些final修饰的成员变量时，初始化列表很有用，因为在方法体中，不能给final修饰的成员变量赋值，因为<strong>在执行方法体的时候，final修饰的成员变量已经不能变了</strong>。这个地方很多人犯错。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>import &#39;dart:math&#39;;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>class Point {
</span></span><span class=line><span class=cl>  final num x;
</span></span><span class=line><span class=cl>  final num y;
</span></span><span class=line><span class=cl>  final num distanceFromOrigin;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  Point(x, y)
</span></span><span class=line><span class=cl>      : x = x,
</span></span><span class=line><span class=cl>        y = y,
</span></span><span class=line><span class=cl>        distanceFromOrigin = sqrt(x * x + y * y);
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>main() {
</span></span><span class=line><span class=cl>  var p = new Point(2, 3);
</span></span><span class=line><span class=cl>  print(p.distanceFromOrigin);
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><link href="https://fonts.googleapis.com/css?family=default" rel=stylesheet type=text/css><div style=font-family:default;font-size:20px;font-style:normal;font-weight:700;color:blue>重定向构造函数</div><p>定义构造函数的时候，除了一个普通构造函数，还可以有若干命名构造函数，这些构造函数之间，有时候会有一些相同的逻辑，如果分别书写在各个构造函数中，会有些多余，所以构造函数可以传递。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>class Point {
</span></span><span class=line><span class=cl>  num x, y;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  // The main constructor for this class.
</span></span><span class=line><span class=cl>  Point(this.x, this.y);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  // Delegates to the main constructor.
</span></span><span class=line><span class=cl>  Point.alongXAxis(num x) : this(x, 0);
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>传递构造函数，没有方法体，会在初始化列表中，调用另一个构造函数。</p><link href="https://fonts.googleapis.com/css?family=default" rel=stylesheet type=text/css><div style=font-family:default;font-size:20px;font-style:normal;font-weight:700;color:blue>常量构造函数</div><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>class ImmutablePoint {
</span></span><span class=line><span class=cl>  static final ImmutablePoint origin =
</span></span><span class=line><span class=cl>      const ImmutablePoint(0, 0);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  final num x, y;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  const ImmutablePoint(this.x, this.y);
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>如果你的类，创建的对象永远不会改变，你可以在编译期就创建这个常量实例，并且定义一个常量构造函数，并且确保所有的成员变量都是final的。</p><link href="https://fonts.googleapis.com/css?family=default" rel=stylesheet type=text/css><div style=font-family:default;font-size:20px;font-style:normal;font-weight:700;color:blue>工厂构造函数/单例模式</div><p>在构造函数前加上<code>factory</code></p><ul><li><p>只实例化一次，节省相同实例化带来的消耗</p></li><li><p>第一次调用命名构造函数进入工厂函数中实例化，后续调用就用缓存中现成的实例</p></li><li><p>工厂构造函数，没有权利访问this</p></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>class Logger {
</span></span><span class=line><span class=cl>  final String name;
</span></span><span class=line><span class=cl>  bool mute = false;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  // _cache is library-private, thanks to
</span></span><span class=line><span class=cl>  // the _ in front of its name.
</span></span><span class=line><span class=cl>  static final Map<span class=p>&lt;</span><span class=nt>String</span><span class=err>,</span> <span class=na>Logger</span><span class=p>&gt;</span> _cache =
</span></span><span class=line><span class=cl>      <span class=p>&lt;</span><span class=nt>String</span><span class=err>,</span> <span class=na>Logger</span><span class=p>&gt;</span>{};
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  factory Logger(String name) {
</span></span><span class=line><span class=cl>    if (_cache.containsKey(name)) {
</span></span><span class=line><span class=cl>      return _cache[name];
</span></span><span class=line><span class=cl>    } else {
</span></span><span class=line><span class=cl>      final logger = Logger._internal(name);   # 调用构造函数
</span></span><span class=line><span class=cl>      _cache[name] = logger;
</span></span><span class=line><span class=cl>      return logger;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  Logger._internal(this.name);    # 定义命名构造函数
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  void log(String msg) {
</span></span><span class=line><span class=cl>    if (!mute) print(msg);
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>main() {
</span></span><span class=line><span class=cl>    var logger = Logger(&#39;UI&#39;);
</span></span><span class=line><span class=cl>    logger.log(&#39;Button clicked&#39;);
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>上例的意思是，类中又一个静态缓存<code>_cache</code>保存着一些Logger类实例，创建实例时，给工厂构造函数传递的name，如果在缓存中已经存在，就用缓存中现成的实例，如果没有，就新建一个实例，并且也放到缓存中。</p><p>如此，我们可以创建名字为UI / SYS / API 等的实例，然后在debug的时候，如果设置名字为UI的Logger实例的mute为true，就不会打印UI相关的log，而不影响其它两个名字的log。</p><h3 id=回调函数>回调函数</h3><p>回调函数本质上是把函数作为参数传递给小部件的函数，当按钮按下时调用此函数。</p><p>官方实现：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>/// Signature of callbacks that have no arguments and return no data.
</span></span><span class=line><span class=cl>typedef VoidCallback = void Function();
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>/// Signature for callbacks that report that an underlying value has changed.
</span></span><span class=line><span class=cl>/// See also:
</span></span><span class=line><span class=cl>///  * [ValueSetter], for callbacks that report that a value has been set.
</span></span><span class=line><span class=cl>typedef ValueChanged<span class=p>&lt;</span><span class=nt>T</span><span class=p>&gt;</span> = void Function(T value);
</span></span></code></pre></div><p>示例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>import &#39;package:flutter/material.dart&#39;;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>void main() {
</span></span><span class=line><span class=cl>  runApp(const MyApp());
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>class MyApp extends StatefulWidget {
</span></span><span class=line><span class=cl>  const MyApp({Key? key}) : super(key: key);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  @override
</span></span><span class=line><span class=cl>  State<span class=p>&lt;</span><span class=nt>MyApp</span><span class=p>&gt;</span> createState() =&gt; _MyAppState();
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>class _MyAppState extends State<span class=p>&lt;</span><span class=nt>MyApp</span><span class=p>&gt;</span> {
</span></span><span class=line><span class=cl>  String topic = &#34;Packages&#34;;
</span></span><span class=line><span class=cl>  callback(varTopic) {
</span></span><span class=line><span class=cl>    // setState:通知内部状态已更改从而重建UI
</span></span><span class=line><span class=cl>    setState(() {
</span></span><span class=line><span class=cl>      topic = varTopic;
</span></span><span class=line><span class=cl>    });
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  @override
</span></span><span class=line><span class=cl>  Widget build(BuildContext context) {
</span></span><span class=line><span class=cl>    return MaterialApp(
</span></span><span class=line><span class=cl>      home: Scaffold(
</span></span><span class=line><span class=cl>        appBar: AppBar(
</span></span><span class=line><span class=cl>          title: const Text(&#34;Learning Flutter&#34;),
</span></span><span class=line><span class=cl>        ),
</span></span><span class=line><span class=cl>        body: Column(
</span></span><span class=line><span class=cl>          children: [
</span></span><span class=line><span class=cl>            Container(
</span></span><span class=line><span class=cl>              width: double.maxFinite,
</span></span><span class=line><span class=cl>              height: 70,
</span></span><span class=line><span class=cl>              margin: const EdgeInsets.only(
</span></span><span class=line><span class=cl>                  top: 50, left: 40, right: 40, bottom: 20),
</span></span><span class=line><span class=cl>              decoration: BoxDecoration(
</span></span><span class=line><span class=cl>                  color: Colors.lightBlue,
</span></span><span class=line><span class=cl>                  borderRadius: BorderRadius.circular(20)),
</span></span><span class=line><span class=cl>              child: Center(
</span></span><span class=line><span class=cl>                child: Text(
</span></span><span class=line><span class=cl>                  &#34;We are learning Flutter $topic&#34;,
</span></span><span class=line><span class=cl>                  style: const TextStyle(fontSize: 20, color: Colors.white),
</span></span><span class=line><span class=cl>                ),
</span></span><span class=line><span class=cl>              ),
</span></span><span class=line><span class=cl>            ),
</span></span><span class=line><span class=cl>            MyButtons(topic: &#34;Cubit&#34;, callbackFunction: callback),
</span></span><span class=line><span class=cl>            MyButtons(topic: &#34;BLoc&#34;, callbackFunction: callback),
</span></span><span class=line><span class=cl>            MyButtons(topic: &#34;GetX&#34;, callbackFunction: callback)
</span></span><span class=line><span class=cl>          ],
</span></span><span class=line><span class=cl>        ),
</span></span><span class=line><span class=cl>      ),
</span></span><span class=line><span class=cl>    );
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>class MyButtons extends StatelessWidget {
</span></span><span class=line><span class=cl>  final String topic;
</span></span><span class=line><span class=cl>  final Function callbackFunction;
</span></span><span class=line><span class=cl>  const MyButtons(
</span></span><span class=line><span class=cl>      {Key? key, required this.topic, required this.callbackFunction})
</span></span><span class=line><span class=cl>      : super(key: key);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  @override
</span></span><span class=line><span class=cl>  Widget build(BuildContext context) {
</span></span><span class=line><span class=cl>    return GestureDetector(
</span></span><span class=line><span class=cl>      onTap: () {
</span></span><span class=line><span class=cl>        callbackFunction(topic);
</span></span><span class=line><span class=cl>      },
</span></span><span class=line><span class=cl>      child: Container(
</span></span><span class=line><span class=cl>        width: double.maxFinite,
</span></span><span class=line><span class=cl>        height: 70,
</span></span><span class=line><span class=cl>        margin: const EdgeInsets.only(top: 20, left: 40, right: 40, bottom: 20),
</span></span><span class=line><span class=cl>        decoration: BoxDecoration(
</span></span><span class=line><span class=cl>            color: Colors.lightBlue, borderRadius: BorderRadius.circular(20)),
</span></span><span class=line><span class=cl>        child: Center(
</span></span><span class=line><span class=cl>          child: Text(
</span></span><span class=line><span class=cl>            topic,
</span></span><span class=line><span class=cl>            style: const TextStyle(fontSize: 20, color: Colors.white),
</span></span><span class=line><span class=cl>          ),
</span></span><span class=line><span class=cl>        ),
</span></span><span class=line><span class=cl>      ),
</span></span><span class=line><span class=cl>    );
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><h4 id=function-class>Function class</h4><p>Function是所有函数类型的超类。</p><p>Function有一些没有声明的特殊功能：</p><ul><li>Function 静态类型的值仍然可以像函数一样被调用（这样的调用是动态调用,编译器无法在编译时检查类型的正确性,在运行时将执行检查以确保参数类型一致）。</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>Function f = (int x) =&gt; &#34;$x&#34;;
</span></span><span class=line><span class=cl>print(f(1)); // Prints &#34;1&#34;.
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>f(&#34;not&#34;, &#34;one&#34;, &#34;int&#34;); // Throws! No static warning.
</span></span></code></pre></div><h4 id=widgets之间的通信>widgets之间的通信</h4><p><a class=link href=https://medium.com/flutter-community/flutter-communication-between-widgets-f5590230df1e target=_blank rel=noopener>https://medium.com/flutter-community/flutter-communication-between-widgets-f5590230df1e</a></p><h3 id=扩展>扩展</h3><h4 id=扩展类>扩展类</h4><link href="https://fonts.googleapis.com/css?family=default" rel=stylesheet type=text/css><div style=font-family:default;font-size:20px;font-style:normal;font-weight:400;color:blue>extends</div><p>Extends是典型的OOP类继承。如果 a类 扩展了 b类，则 a类 可以使用或覆盖 b类 中实现的所有属性、变量、函数 。在 Dart 中，一个类只能扩展一个类。
<img src=/p/flutter/5.jpg width=1233 height=641 srcset="/p/flutter/5_hu572765b138c1f7437a19c6cea77cac10_136967_480x0_resize_q75_box.jpg 480w, /p/flutter/5_hu572765b138c1f7437a19c6cea77cac10_136967_1024x0_resize_q75_box.jpg 1024w" loading=lazy class=gallery-image data-flex-grow=192 data-flex-basis=461px></p><link href="https://fonts.googleapis.com/css?family=default" rel=stylesheet type=text/css><div style=font-family:default;font-size:20px;font-style:normal;font-weight:400;color:blue>implements</div><p>创建另一个类或接口的实现。当 a类 实现 b类 时，<strong>必须实现</strong> b类 中定义的所有功能(所有属性、变量、函数)。一个类可以实现多个接口。</p><link href="https://fonts.googleapis.com/css?family=default" rel=stylesheet type=text/css><div style=font-family:default;font-size:20px;font-style:normal;font-weight:400;color:blue>with</div><p>mixin使用with关键字，类似于继承，可以扩展多个类。mixins的类只能继承自Object，不能再继承其他类，且不能有构造函数。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl># extends只能扩展一个类，而mixin没有限制，可以一起使用
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>class Maestro extends Person with Musical, Aggressive, Demented {
</span></span><span class=line><span class=cl>  Maestro(String maestroName) {
</span></span><span class=line><span class=cl>    name = maestroName;
</span></span><span class=line><span class=cl>    canConduct = true;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><h4 id=super>super</h4><p><code>super</code>关键字用于调用父类的对象、方法、构造函数和子类中的属性。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>// 访问父类变量
</span></span><span class=line><span class=cl>super.variable_name; 
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 访问父类方法
</span></span><span class=line><span class=cl>super.method_name();
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 转发给超类的构造函数
</span></span><span class=line><span class=cl>const MyApp({Key? key}) : super(key: key);
</span></span></code></pre></div><h4 id=扩展方法>扩展方法</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>// 扩展 num，就可以使用 num.attribute 和 num.method 
</span></span><span class=line><span class=cl>extension FancyNum on num {
</span></span><span class=line><span class=cl>  num plus(num other) =&gt; this + other;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  num times(num other) =&gt; this * other;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>print(5.plus(3)); // Equal to &#34;5 + 3&#34;.
</span></span><span class=line><span class=cl>print(5.times(8)); // Equal to &#34;5 * 8&#34;.
</span></span><span class=line><span class=cl>print(2.plus(1).times(3)); // Equal to &#34;(2 + 1) * 3&#34;.
</span></span></code></pre></div><h2 id=泛型>泛型</h2><p>泛型常用于需要要求类型安全的情况，可以减少代码重复。
<img src=/p/flutter/fanxing.jpg width=1122 height=449 srcset="/p/flutter/fanxing_hu6d02cad28d2736a6e42659b75fd941e7_62001_480x0_resize_q75_box.jpg 480w, /p/flutter/fanxing_hu6d02cad28d2736a6e42659b75fd941e7_62001_1024x0_resize_q75_box.jpg 1024w" loading=lazy class=gallery-image data-flex-grow=249 data-flex-basis=599px>
如果 T 是一个class，则表示传入该类型的参数。</p><p>@override 注解来表示你重写了一个成员
<img src=/p/flutter/override.jpg width=1173 height=659 srcset="/p/flutter/override_huf3ae0c28a53250be072483b49c760168_125842_480x0_resize_q75_box.jpg 480w, /p/flutter/override_huf3ae0c28a53250be072483b49c760168_125842_1024x0_resize_q75_box.jpg 1024w" loading=lazy class=gallery-image data-flex-grow=177 data-flex-basis=427px></p><h2 id=异步>异步</h2><link href="https://fonts.googleapis.com/css?family=default" rel=stylesheet type=text/css><div style=font-family:default;font-size:20px;font-style:normal;font-weight:700;color:blue>Isolate</div><p>Isolate 是运行所有 Dart 代码的地方，在许多其他语言里（例如 C++），你可以让多个线程共享相同的内存，但是在 Dart 中，每个线程都有自己的 Isolate 和它自己的内存。</p><p>如果你要运行的计算量太过庞大，在 main Isolate 中运行可能会导致丢帧，如果处理可能需要几百毫秒，则考虑创建单独的Isolate，例如：</p><ul><li>解码 JSON，HttpRequest 的结果 => compute</li><li>加密可能非常耗时</li><li>处理图像（例如裁剪）</li><li>从 Web 加载图像</li></ul><p><strong>事件循环</strong></p><p>Dart使用永不阻塞的单线程来处理所有事件。因此，它运行一个事件循环，它从事件队列中取得最先发生的事件，处理它，返回下一个事件进行处理，依此类推，直到事件队列清空为止。</p><link href="https://fonts.googleapis.com/css?family=default" rel=stylesheet type=text/css><div style=font-family:default;font-size:20px;font-style:normal;font-weight:700;color:blue>Future</div><p><strong>定义</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>// Future<span class=p>&lt;</span><span class=nt>type</span><span class=p>&gt;</span>是一种类型
</span></span><span class=line><span class=cl>Future<span class=p>&lt;</span><span class=nt>void</span><span class=p>&gt;</span> myVoidFuture() {}   // 不返回任何内容，但可以在最终完成时通知调用者。 
</span></span><span class=line><span class=cl>Future<span class=p>&lt;</span><span class=nt>bool</span><span class=p>&gt;</span> myTypedFuture() {}  // 如果需要返回一个值，那么你传递给它一个类型。
</span></span></code></pre></div><p>Future 有两种状态：</p><ul><li>未完成(Uncompleted): 你刚刚得到一个 Future，还未打开<br>首先，事件发生，事件循环获取事件，并调用你写的处理程序，得到一个返回的 Future，此时Future是关着的，此时 Future 未能完成，事件循环继续执行其他事件。</li><li>已完成<ul><li>Completed with a value: 打开了，带有一个值<br>等到数据抵达时，Future 得到数据并打开它，如果Future 完成并带有一个值，此时会触发你的 <code>then</code> 回调。<code>then</code> 是你可以用来在每个 Future 上注册回调的实例方法，你可以用它创建一个函数，传入一个匹配 Future 类型的参数。</li><li>Completed with an error: 打开了，抛出一个异常<br>如果Future 在完成时没有带一个值，你可以使用 <code>catchError</code>注册另一个回调，catchError 的工作方式和 then 一样，唯一不同的是它捕获异常而不是值。你甚至可以给它一个<code>test</code>方法，你可以通过这种方式使用多个 catchError 方法，每种方法都会检查错误返回值的类型。</li></ul></li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>void main() {
</span></span><span class=line><span class=cl>  Future<span class=p>&lt;</span><span class=nt>int</span><span class=p>&gt;</span>.delayed (
</span></span><span class=line><span class=cl>    Duration (seconds: 3),
</span></span><span class=line><span class=cl>    () { return 100; },
</span></span><span class=line><span class=cl>  ).then((value) {
</span></span><span class=line><span class=cl>    print(value);
</span></span><span class=line><span class=cl>  }).catchError(
</span></span><span class=line><span class=cl>    (err) {
</span></span><span class=line><span class=cl>      print(&#39;Caught $err&#39;);
</span></span><span class=line><span class=cl>    },
</span></span><span class=line><span class=cl>    test: (err) =&gt; err.runtimeType == String,
</span></span><span class=line><span class=cl>  ).whenComplete (() {
</span></span><span class=line><span class=cl>    print(&#39;All finished!&#39;);
</span></span><span class=line><span class=cl>  });
</span></span><span class=line><span class=cl>  print(&#39;waiting...&#39;);
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p><strong>Future方法</strong></p><ul><li><p>Future.value<br>如果你已经知道 Future 返回的值，你可以使用 Future.value 为构造函数命名，构建缓存服务时可以用这个</p></li><li><p>Future.error<br>它需要一个异常对象和一个可选的堆栈跟踪</p></li><li><p>Future.delayed<br>在运行函数和 Future 完成之前，指定等待时长，可以创建测试用的模拟网络服务</p></li></ul><link href="https://fonts.googleapis.com/css?family=default" rel=stylesheet type=text/css><div style=font-family:default;font-size:20px;font-style:normal;font-weight:700;color:blue>Streams</div><p>每个 future 单一地传递错误，或者数据，Streams随着时间的推移，可以传送零个、多个值，或者是错误。</p><p><link href="https://fonts.googleapis.com/css?family=default" rel=stylesheet type=text/css><div style=font-family:default;font-size:20px;font-style:normal;font-weight:700;color:blue>async await</div>async 和 await 实际上只是 future 和 streams 的替代语法，在连续的Future中，每一处Future都需要定义、then、return，而且所有内容添加到then下不易阅读，而await只需如下写：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>import &#39;dart:io&#39;;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>void main() {
</span></span><span class=line><span class=cl>  createData();
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Future<span class=p>&lt;</span><span class=nt>ProcessedData</span><span class=p>&gt;</span> createData() async {
</span></span><span class=line><span class=cl>  try {
</span></span><span class=line><span class=cl>    final id = await _loadFromDisk();
</span></span><span class=line><span class=cl>    final data = await _fetchNetworkData(id);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    return ProcessedData(data);
</span></span><span class=line><span class=cl>  } on HttpException catch (err) {
</span></span><span class=line><span class=cl>    print(&#39;Network error: $err&#39;);
</span></span><span class=line><span class=cl>    return ProcessedData.empty();
</span></span><span class=line><span class=cl>  } finally {
</span></span><span class=line><span class=cl>    print(&#39;All done!&#39;);
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Future<span class=p>&lt;</span><span class=nt>int</span><span class=p>&gt;</span> _loadFromDisk() async {
</span></span><span class=line><span class=cl>  print(&#39;loadFromDisk&#39;);
</span></span><span class=line><span class=cl>  return 0;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Future<span class=p>&lt;</span><span class=nt>String</span><span class=p>&gt;</span> _fetchNetworkData(int id) async {
</span></span><span class=line><span class=cl>  print(&#39;NetworkData&#39;);
</span></span><span class=line><span class=cl>  return &#39;NetworkData&#39;;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>class ProcessedData {
</span></span><span class=line><span class=cl>  ProcessedData(this.data);
</span></span><span class=line><span class=cl>  final String data;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  static Future<span class=p>&lt;</span><span class=nt>ProcessedData</span><span class=p>&gt;</span> empty() async {
</span></span><span class=line><span class=cl>    var empty = ProcessedData(&#39;empty&#39;);
</span></span><span class=line><span class=cl>    print(empty);
</span></span><span class=line><span class=cl>    return empty;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>上面官方示例介绍了连续的 await，这是更清晰的使用示例：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>void main() async {
</span></span><span class=line><span class=cl>  print(getMeSomeFood());      
</span></span><span class=line><span class=cl>  print(await getMeSomethingBetter());       
</span></span><span class=line><span class=cl>  maybeSomethingSweet().then((String value) {
</span></span><span class=line><span class=cl>    print(value);                    
</span></span><span class=line><span class=cl>  });
</span></span><span class=line><span class=cl>  print(&#39;done&#39;);
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>Future<span class=p>&lt;</span><span class=nt>String</span><span class=p>&gt;</span> getMeSomeFood() async {
</span></span><span class=line><span class=cl>  return &#34;an apple&#34;;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>Future<span class=p>&lt;</span><span class=nt>String</span><span class=p>&gt;</span> getMeSomethingBetter() async {
</span></span><span class=line><span class=cl>  return &#34;a burger?&#34;;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>Future<span class=p>&lt;</span><span class=nt>String</span><span class=p>&gt;</span> maybeSomethingSweet() async {
</span></span><span class=line><span class=cl>  return &#34;a chocolate cake!!&#34;;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// output: 
</span></span><span class=line><span class=cl>// Instance of ‘_Future<span class=p>&lt;</span><span class=nt>String</span><span class=p>&gt;</span>’      不等待，返回一个future
</span></span><span class=line><span class=cl>// a burger?                          等待future完成
</span></span><span class=line><span class=cl>// done                               
</span></span><span class=line><span class=cl>// a chocolate cake!!                 不等待，先继续执行print(&#39;done&#39;)，future完成后再调用then
</span></span></code></pre></div><link href="https://fonts.googleapis.com/css?family=default" rel=stylesheet type=text/css><div style=font-family:default;font-size:20px;font-style:normal;font-weight:700;color:blue>Generator</div><div class=table-wrapper><table><thead><tr><th></th><th>Single value</th><th>Zero or more values</th></tr></thead><tbody><tr><td>Sync:</td><td>int</td><td>Iterable<int></td></tr><tr><td>Async:</td><td>Future<int></td><td>Stream<int></td></tr></tbody></table></div><p>当您需要延迟生成一系列值时，请考虑使用<em>生成器函数</em>。Dart 内置支持两种生成器函数：</p><ul><li><strong>同步</strong>生成器：返回一个<a class=link href=https://api.dart.dev/stable/dart-core/Iterable-class.html target=_blank rel=noopener><code>Iterable</code></a>对象。</li><li><strong>异步</strong>生成器：返回一个<a class=link href=https://api.dart.dev/stable/dart-async/Stream-class.html target=_blank rel=noopener><code>Stream</code></a>对象。</li></ul><p>实现一个<strong>同步</strong>生成器函数，将函数体标记为<code>sync*</code>，使用<code>yield</code>语句传递值：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=n>Iterable</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>naturalsTo</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>)</span> <span class=kd>sync</span><span class=o>*</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=m>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=p>(</span><span class=n>k</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>)</span> <span class=kd>yield</span> <span class=n>k</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>实现<strong>异步</strong>生成器函数，将函数体标记为<code>async*</code>，使用<code>yield</code>语句传递值：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=n>Stream</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>asynchronousNaturalsTo</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>)</span> <span class=kd>async</span><span class=o>*</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=kt>int</span> <span class=n>k</span> <span class=o>=</span> <span class=m>0</span><span class=p>;</span>
</span></span><span class=line><span class=cl>  <span class=k>while</span> <span class=p>(</span><span class=n>k</span> <span class=o>&lt;</span> <span class=n>n</span><span class=p>)</span> <span class=kd>yield</span> <span class=n>k</span><span class=o>++</span><span class=p>;</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><p>如果您的生成器是递归的，您可以使用以下方法提高其性能<code>yield*</code>：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-dart data-lang=dart><span class=line><span class=cl><span class=n>Iterable</span><span class=o>&lt;</span><span class=kt>int</span><span class=o>&gt;</span> <span class=n>naturalsDownFrom</span><span class=p>(</span><span class=kt>int</span> <span class=n>n</span><span class=p>)</span> <span class=kd>sync</span><span class=o>*</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>  <span class=k>if</span> <span class=p>(</span><span class=n>n</span> <span class=o>&gt;</span> <span class=m>0</span><span class=p>)</span> <span class=p>{</span>
</span></span><span class=line><span class=cl>    <span class=kd>yield</span> <span class=n>n</span><span class=p>;</span>
</span></span><span class=line><span class=cl>    <span class=kd>yield</span><span class=o>*</span> <span class=n>naturalsDownFrom</span><span class=p>(</span><span class=n>n</span> <span class=o>-</span> <span class=m>1</span><span class=p>);</span>
</span></span><span class=line><span class=cl>  <span class=p>}</span>
</span></span><span class=line><span class=cl><span class=p>}</span>
</span></span></code></pre></div><h1 id=flutter>flutter</h1><h2 id=widget生命周期>Widget生命周期</h2><p><strong>StatelessWidget生命周期源码图</strong>
<img src=/p/flutter/6.jpg width=1787 height=966 srcset="/p/flutter/6_hu9df739c1aeb15e1ce9f35dea789d6e83_349244_480x0_resize_q75_box.jpg 480w, /p/flutter/6_hu9df739c1aeb15e1ce9f35dea789d6e83_349244_1024x0_resize_q75_box.jpg 1024w" loading=lazy class=gallery-image data-flex-grow=184 data-flex-basis=443px></p><p>Flutter 中万物皆为Widget，<code>widget</code>类继承自<code>DiagnosticableTree</code>。</p><p><code>DiagnosticableTree</code>即“诊断树”，主要作用是提供调试信息。</p><p>Flutter 中的 UI 或一堆小部件组成，通常称为小部件树，根据 Widget 树生成一个 Element 树，Widget 和 Element 是一一对应的，根据 Element 树生成 Render 树（渲染树），真正的布局和渲染逻辑在 Render 树中。</p><p><code>Widget.createElement()</code> :创建一个Element实例，记为<code>element</code>。</p><p><code>BuildContext</code>是widget对应的Element，用于跟踪树中的每个小部件并定位它们及其在树中的位置。每个小部件的<code>BuildContext</code>都传递给它们的<code>build</code>方法。<code>build</code>方法返回小部件呈现的小部件树。</p><p><code>context</code>参数是BuildContext类的一个实例，表示当前 widget 在 widget 树中的上下文，每一个 widget 都会对应一个 context 对象。在很多时候我们都需要使用context，比如获取主题：<code>Theme.of(context).colorScheme.primary</code>。</p><p><code>Key</code>: [Key]是[Widget]、[Element]和[SemanticsNode]的标识符。Key可以保持组件之前的状态，比如在用户滑动时或者修改集合时，决定的条件在<code>canUpdate()</code>方法中。使用 <code>GlobalKey</code>时，Flutter 不仅会在树中查找与特定级别匹配的键，还会在整个应用程序中查找,GlobalKey就像全局变量。</p><p><code>canUpdate(...)</code>: <code>newWidget</code>与<code>oldWidget</code>的<code>runtimeType</code>和<code>key</code>同时相等时就会用<code>new widget</code>去更新<code>Element</code>对象的配置。如果 Type 相同但 Key 不同，则Element将被deactivated（释放，但它可能仍然存在）。如果 Type 不同，则Element将被disposed（永久删除）。</p><p><code>element.mount()</code> :调用<code>createRenderObject</code>创建RenderObject，并使用<code>attachRenderObject</code>将RenderObject关联到Element上。</p><h3 id=使用>使用</h3><p><strong>StatelessWidget</strong> 要求我们重写<code>build</code>方法,它将<code>state</code>作为输入并提供相应的 UI 显示在用户屏幕上：UI = build(state),当我们初始化一个StatelessWidget对象时会调用 build 方法。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>class CounterWidget extends StatelessWidget {
</span></span><span class=line><span class=cl>  final bool isLoading;
</span></span><span class=line><span class=cl>  final int counter;  
</span></span><span class=line><span class=cl>  const CounterWidget({
</span></span><span class=line><span class=cl>    required this.isLoading,
</span></span><span class=line><span class=cl>    required this.counter,
</span></span><span class=line><span class=cl>  });  
</span></span><span class=line><span class=cl>  @override
</span></span><span class=line><span class=cl>  Widget build(BuildContext context) {
</span></span><span class=line><span class=cl>    return isLoading ? CircularProgressIndicator() : Text(&#39;$counter&#39;);
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p><strong>StatefulWidget</strong> 要求我们重写<code>createState</code>功能:</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>class MyHomePage extends StatefulWidget {
</span></span><span class=line><span class=cl>  final bool isLoading;
</span></span><span class=line><span class=cl>  final int counter;  
</span></span><span class=line><span class=cl>  const MyHomePage({
</span></span><span class=line><span class=cl>    required this.isLoading,
</span></span><span class=line><span class=cl>    required this.counter,
</span></span><span class=line><span class=cl>  });  
</span></span><span class=line><span class=cl>  @override
</span></span><span class=line><span class=cl>  State<span class=p>&lt;</span><span class=nt>MyHomePage</span><span class=p>&gt;</span> createState() {
</span></span><span class=line><span class=cl>    return MyHomePageState();
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p><code>createState()</code>会为每一个<code>StatefulElement</code>创建一个State对象。示例中创建了<code>MyHomePageState</code>对象，当<code>MyHomePageState</code>初始化时，它会调用<code>build</code>函数。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>class MyHomePageState extends State<span class=p>&lt;</span><span class=nt>MyHomePage</span><span class=p>&gt;</span> {
</span></span><span class=line><span class=cl>  @override
</span></span><span class=line><span class=cl>  Widget build(BuildContext context) {
</span></span><span class=line><span class=cl>    return Scaffold(
</span></span><span class=line><span class=cl>      body: Center(
</span></span><span class=line><span class=cl>        child: CounterWidget(
</span></span><span class=line><span class=cl>          isLoading: widget.isLoading,
</span></span><span class=line><span class=cl>          counter: widget.counter,
</span></span><span class=line><span class=cl>        ),
</span></span><span class=line><span class=cl>      ),
</span></span><span class=line><span class=cl>    );
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p><code>widget.isLoading</code>、<code>widget.counter</code>属性用于表示当前配置信息，并且在父级更新小部件时会被自动更新。<code>setState</code>是State的方法。当我们调用setState方法时，build方法将立即再次被调用。</p><p>当你的组件是静态的，不需要更新自身状态,使用StatelessWidget。当你的组件需要根据事件或交互来动态更新自身状态,使用StatefulWidget。</p><h2 id=getx>Getx</h2><h3 id=状态管理>状态管理</h3><h4 id=介绍>介绍</h4><div class=table-wrapper><table><tr><td>分类</td><td>状态管理器</td><td>消耗RAM</td><td>结论</td></tr><tr><td>无状态页面</td><td>GetView</td><td>最少</td><td>相当于StatelessWidget,性能最好，最常用</td></tr><tr><td>简单的状态管理（一个页面的状态管理）</td><td>GetBuilder</td><td>较少</td><td>相当于StatefulWidget,性能较好</td></tr><tr><td rowspan=2>反应式状态管理（全局的状态管理）</td><td>Obx</td><td>稍多</td><td>反应式的基础层，较Getx简洁</td></tr><tr><td>GetX</td><td>较多</td><td>可以灵活使用的反应式状态管理</td></tr><tr><td>混合态管理</td><td>MixinBuilder</td><td>最多</td><td>在GetBuilder中插入一个Obx，既可以响应式更新、也可以手动更新</td></tr></table></div><h4 id=controller>Controller</h4><p>Getx状态管理的代码结构都可以分为GetXController（控制器层）和view（界面层），GetXController 可以进一步分为state（状态层/变量层），logic（逻辑层）。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>└── sinup
</span></span><span class=line><span class=cl>    ├── controller.dart    ──┤─ ─ logic.dart
</span></span><span class=line><span class=cl>    │                        │─ ─ state.dart
</span></span><span class=line><span class=cl>    ├── view.dart 
</span></span></code></pre></div><p><link href="https://fonts.googleapis.com/css?family=default" rel=stylesheet type=text/css><div style=font-family:default;font-size:20px;font-style:normal;font-weight:700;color:#000>生命周期</div>在 StatefulWidget 中，使用<code>initState</code>或<code>dispose()</code>，而在 Controller 中我们可以使用相对应的操作：</p><ol><li><code>onStart</code>（开始）<strong>[不可覆盖]</strong>：组件在内存分配的时间点就会被调用，完成后会调用onInit方法</li><li><code>onInit</code>（初始化）：组件在内存分配后会被马上调用，适用于初始化 Controller（例如一些成员属性的初始化），详见Workers小节</li><li><code>onReady</code>（加载完成）：在 onInit 一帧后被调用，适合做一些导航进入的事件（例如对话框提示、SnackBar）或异步网络请求</li><li><code>onClose</code>（控制器被释放）：在 <code>onDelete</code> 方法前调用、用于销毁 <code>controller</code> 使用的资源（例如关闭事件监听，关闭流对象、动画）或者销毁可能造成内存泄露的对象（例如 <code>TextEditingController</code>，<code>AniamtionController</code>）。也适用于将数据进行离线持久化。</li><li><code>onDelete</code>（删除）<strong>[不可覆盖]</strong>：在 <code>controller</code>销毁前调用，将控制器从内存中删除</li></ol><h4 id=反应状态管理>反应状态管理</h4><h5 id=反应变量>反应变量</h5><p>使用反应状态管理需要声明反应变量，你有3种方法可以把一个变量变成是 &ldquo;可观察的&rdquo;。</p><p>1 - 第一种是使用 <strong><code>Rx{Type}</code></strong>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>// 建议使用初始值，但不是强制性的
</span></span><span class=line><span class=cl>final name = RxString(&#39;&#39;);
</span></span><span class=line><span class=cl>final isLogged = RxBool(false);
</span></span><span class=line><span class=cl>final count = RxInt(0);
</span></span><span class=line><span class=cl>final balance = RxDouble(0.0);
</span></span><span class=line><span class=cl>final items = RxList&lt;String&gt;([]);
</span></span><span class=line><span class=cl>final myMap = RxMap&lt;String, int&gt;({});
</span></span></code></pre></div><p>2 - 第二种是使用 <strong><code>Rx</code></strong>，规定泛型 <code>Rx&lt;Type></code>。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>final name = Rx&lt;String&gt;(&#39;&#39;);
</span></span><span class=line><span class=cl>final isLogged = Rx&lt;Bool&gt;(false);
</span></span><span class=line><span class=cl>final count = Rx&lt;Int&gt;(0);
</span></span><span class=line><span class=cl>final balance = Rx&lt;Double&gt;(0.0);
</span></span><span class=line><span class=cl>final number = Rx&lt;Num&gt;(0)
</span></span><span class=line><span class=cl>final items = Rx&lt;List&lt;String&gt;&gt;([]);
</span></span><span class=line><span class=cl>final myMap = Rx&lt;Map&lt;String, int&gt;&gt;({});
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 自定义类 - 可以是任何类
</span></span><span class=line><span class=cl>final user = Rx&lt;User&gt;();
</span></span></code></pre></div><p>3 - 第三种更实用、更简单和<strong>首选的</strong>方法，只需添加 <strong><code>.obs</code></strong> 作为<code>value</code>的属性。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>final name = &#39;&#39;.obs;
</span></span><span class=line><span class=cl>final isLogged = false.obs;
</span></span><span class=line><span class=cl>final count = 0.obs;
</span></span><span class=line><span class=cl>final balance = 0.0.obs;
</span></span><span class=line><span class=cl>final number = 0.obs;
</span></span><span class=line><span class=cl>final items = &lt;String&gt;[].obs;
</span></span><span class=line><span class=cl>final myMap = &lt;String, int&gt;{}.obs;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 自定义类 - 可以是任何class, literally
</span></span><span class=line><span class=cl>final user = User().obs;
</span></span></code></pre></div><h5 id=使用value>使用value</h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>// controller
</span></span><span class=line><span class=cl>final count1 = 0.obs;
</span></span><span class=line><span class=cl>final count2 = 0.obs;
</span></span><span class=line><span class=cl>int get sum =&gt; count1.value + count2.value;   // 由于.obs把变量换成`Rx{Type}`类型，所以需要用.value取值
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-fallback data-lang=fallback><span class=line><span class=cl>// 视图
</span></span><span class=line><span class=cl>GetX&lt;Controller&gt;(
</span></span><span class=line><span class=cl>  builder: (controller) {
</span></span><span class=line><span class=cl>    print(&#34;count 1 rebuild&#34;);
</span></span><span class=line><span class=cl>    return Text(&#39;${controller.count1.value}&#39;);
</span></span><span class=line><span class=cl>  },
</span></span><span class=line><span class=cl>),
</span></span><span class=line><span class=cl>GetX&lt;Controller&gt;(
</span></span><span class=line><span class=cl>  builder: (controller) {
</span></span><span class=line><span class=cl>    print(&#34;count 2 rebuild&#34;);
</span></span><span class=line><span class=cl>    return Text(&#39;${controller.count2.value}&#39;);
</span></span><span class=line><span class=cl>  },
</span></span><span class=line><span class=cl>),
</span></span><span class=line><span class=cl>GetX&lt;Controller&gt;(
</span></span><span class=line><span class=cl>  builder: (controller) {
</span></span><span class=line><span class=cl>    print(&#34;count 3 rebuild&#34;);
</span></span><span class=line><span class=cl>    return Text(&#39;${controller.sum}&#39;);
</span></span><span class=line><span class=cl>  },
</span></span><span class=line><span class=cl>),
</span></span></code></pre></div><h5 id=obx>Obx</h5><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>class StateObxView extends StatelessWidget {
</span></span><span class=line><span class=cl>  StateObxView({Key? key}) : super(key: key);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  final count = 0.obs;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  @override
</span></span><span class=line><span class=cl>  Widget build(BuildContext context) {
</span></span><span class=line><span class=cl>    return Scaffold(
</span></span><span class=line><span class=cl>      appBar: AppBar(
</span></span><span class=line><span class=cl>        title: Text(&#34;Obx(...)&#34;),
</span></span><span class=line><span class=cl>      ),
</span></span><span class=line><span class=cl>      body: Center(
</span></span><span class=line><span class=cl>        child: Column(
</span></span><span class=line><span class=cl>          children: [
</span></span><span class=line><span class=cl>            Obx(() =&gt; Text(&#34;count1 -&gt; &#34; + count.toString())),
</span></span><span class=line><span class=cl>            Obx(() =&gt; Text(&#34;count2 -&gt; &#34; + count.toString())),
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            //
</span></span><span class=line><span class=cl>            Divider(),
</span></span><span class=line><span class=cl>            ElevatedButton(
</span></span><span class=line><span class=cl>              onPressed: () {
</span></span><span class=line><span class=cl>                count.value++;
</span></span><span class=line><span class=cl>              },
</span></span><span class=line><span class=cl>              child: Text(&#39;add&#39;),
</span></span><span class=line><span class=cl>            ),
</span></span><span class=line><span class=cl>          ],
</span></span><span class=line><span class=cl>        ),
</span></span><span class=line><span class=cl>      ),
</span></span><span class=line><span class=cl>    );
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><h5 id=getx-1>GetX</h5><p>Controller</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>class CountController extends GetxController {
</span></span><span class=line><span class=cl>  final _count = 0.obs;
</span></span><span class=line><span class=cl>  set count(value) =&gt; this._count.value = value;
</span></span><span class=line><span class=cl>  get count =&gt; this._count.value;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  final _count2 = 0.obs;
</span></span><span class=line><span class=cl>  set count2(value) =&gt; this._count2.value = value;
</span></span><span class=line><span class=cl>  get count2 =&gt; this._count2.value;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  add() =&gt; _count.value++;
</span></span><span class=line><span class=cl>  add2() =&gt; _count2.value++;
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>View</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>class StateGetxView extends StatelessWidget {
</span></span><span class=line><span class=cl>  StateGetxView({Key? key}) : super(key: key);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  final controller = CountController();
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  @override
</span></span><span class=line><span class=cl>  Widget build(BuildContext context) {
</span></span><span class=line><span class=cl>    return Scaffold(
</span></span><span class=line><span class=cl>      appBar: AppBar(
</span></span><span class=line><span class=cl>        title: Text(&#34;Getx&#34;),
</span></span><span class=line><span class=cl>      ),
</span></span><span class=line><span class=cl>      body: Center(
</span></span><span class=line><span class=cl>        child: Column(
</span></span><span class=line><span class=cl>          children: [
</span></span><span class=line><span class=cl>            GetX<span class=p>&lt;</span><span class=nt>CountController</span><span class=p>&gt;</span>(
</span></span><span class=line><span class=cl>              init: controller,
</span></span><span class=line><span class=cl>              initState: (_) {},
</span></span><span class=line><span class=cl>              builder: (_) {
</span></span><span class=line><span class=cl>                print(&#34;GetX - 1&#34;);
</span></span><span class=line><span class=cl>                return Text(&#39;value 1 -&gt; ${_.count}&#39;);
</span></span><span class=line><span class=cl>              },
</span></span><span class=line><span class=cl>            ),
</span></span><span class=line><span class=cl>            GetX<span class=p>&lt;</span><span class=nt>CountController</span><span class=p>&gt;</span>(
</span></span><span class=line><span class=cl>              init: controller,
</span></span><span class=line><span class=cl>              initState: (_) {},
</span></span><span class=line><span class=cl>              builder: (_) {
</span></span><span class=line><span class=cl>                print(&#34;GetX - 2&#34;);
</span></span><span class=line><span class=cl>                return Text(&#39;value 2 -&gt; ${_.count}&#39;);
</span></span><span class=line><span class=cl>              },
</span></span><span class=line><span class=cl>            ),
</span></span><span class=line><span class=cl>            Divider(),
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            //
</span></span><span class=line><span class=cl>            GetX<span class=p>&lt;</span><span class=nt>CountController</span><span class=p>&gt;</span>(
</span></span><span class=line><span class=cl>              init: controller,
</span></span><span class=line><span class=cl>              initState: (_) {},
</span></span><span class=line><span class=cl>              builder: (_) {
</span></span><span class=line><span class=cl>                print(&#34;GetX - 3&#34;);
</span></span><span class=line><span class=cl>                return Column(
</span></span><span class=line><span class=cl>                  children: [
</span></span><span class=line><span class=cl>                    Text(&#39;value 3 -&gt; ${_.count}&#39;),
</span></span><span class=line><span class=cl>                    ElevatedButton(
</span></span><span class=line><span class=cl>                      onPressed: () {
</span></span><span class=line><span class=cl>                        _.add();
</span></span><span class=line><span class=cl>                      },
</span></span><span class=line><span class=cl>                      child: Text(&#39;count1&#39;),
</span></span><span class=line><span class=cl>                    )
</span></span><span class=line><span class=cl>                  ],
</span></span><span class=line><span class=cl>                );
</span></span><span class=line><span class=cl>              },
</span></span><span class=line><span class=cl>            ),
</span></span><span class=line><span class=cl>            Divider(),
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            // count2
</span></span><span class=line><span class=cl>            GetX<span class=p>&lt;</span><span class=nt>CountController</span><span class=p>&gt;</span>(
</span></span><span class=line><span class=cl>              init: controller,
</span></span><span class=line><span class=cl>              initState: (_) {},
</span></span><span class=line><span class=cl>              builder: (_) {
</span></span><span class=line><span class=cl>                print(&#34;GetX - 4&#34;);
</span></span><span class=line><span class=cl>                return Text(&#39;value 4 -&gt; ${_.count2}&#39;);
</span></span><span class=line><span class=cl>              },
</span></span><span class=line><span class=cl>            ),
</span></span><span class=line><span class=cl>            Divider(),
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            // 按钮
</span></span><span class=line><span class=cl>            ElevatedButton(
</span></span><span class=line><span class=cl>              onPressed: () {
</span></span><span class=line><span class=cl>                controller.add();
</span></span><span class=line><span class=cl>              },
</span></span><span class=line><span class=cl>              child: Text(&#39;count1&#39;),
</span></span><span class=line><span class=cl>            ),
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            ElevatedButton(
</span></span><span class=line><span class=cl>              onPressed: () {
</span></span><span class=line><span class=cl>                controller.add2();
</span></span><span class=line><span class=cl>              },
</span></span><span class=line><span class=cl>              child: Text(&#39;count2&#39;),
</span></span><span class=line><span class=cl>            ),
</span></span><span class=line><span class=cl>          ],
</span></span><span class=line><span class=cl>        ),
</span></span><span class=line><span class=cl>      ),
</span></span><span class=line><span class=cl>    );
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><h4 id=简单状态管理>简单状态管理</h4><h5 id=getbuilder>GetBuilder</h5><p>Controller同Getx</p><p>View</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>class StateGetBuilderView extends StatelessWidget {
</span></span><span class=line><span class=cl>  StateGetBuilderView({Key? key}) : super(key: key);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  final controller = CountController();
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  @override
</span></span><span class=line><span class=cl>  Widget build(BuildContext context) {
</span></span><span class=line><span class=cl>    return Scaffold(
</span></span><span class=line><span class=cl>      appBar: AppBar(
</span></span><span class=line><span class=cl>        title: Text(&#34;GetBuilder&#34;),
</span></span><span class=line><span class=cl>      ),
</span></span><span class=line><span class=cl>      body: Center(
</span></span><span class=line><span class=cl>        child: Column(
</span></span><span class=line><span class=cl>          children: [
</span></span><span class=line><span class=cl>            GetBuilder<span class=p>&lt;</span><span class=nt>CountController</span><span class=p>&gt;</span>(
</span></span><span class=line><span class=cl>              init: controller,
</span></span><span class=line><span class=cl>              initState: (_) {},
</span></span><span class=line><span class=cl>              builder: (_) {
</span></span><span class=line><span class=cl>                print(&#34;GetBuilder - 1&#34;);
</span></span><span class=line><span class=cl>                return Text(&#39;value -&gt; ${_.count}&#39;);
</span></span><span class=line><span class=cl>              },
</span></span><span class=line><span class=cl>            ),
</span></span><span class=line><span class=cl>            GetBuilder<span class=p>&lt;</span><span class=nt>CountController</span><span class=p>&gt;</span>(
</span></span><span class=line><span class=cl>              init: controller,
</span></span><span class=line><span class=cl>              initState: (_) {},
</span></span><span class=line><span class=cl>              builder: (_) {
</span></span><span class=line><span class=cl>                print(&#34;GetBuilder - 2&#34;);
</span></span><span class=line><span class=cl>                return Text(&#39;value -&gt; ${_.count}&#39;);
</span></span><span class=line><span class=cl>              },
</span></span><span class=line><span class=cl>            ),
</span></span><span class=line><span class=cl>            Divider(),
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            //
</span></span><span class=line><span class=cl>            GetBuilder<span class=p>&lt;</span><span class=nt>CountController</span><span class=p>&gt;</span>(
</span></span><span class=line><span class=cl>              init: controller,
</span></span><span class=line><span class=cl>              initState: (_) {},
</span></span><span class=line><span class=cl>              builder: (_) {
</span></span><span class=line><span class=cl>                print(&#34;GetBuilder - 3&#34;);
</span></span><span class=line><span class=cl>                return Column(
</span></span><span class=line><span class=cl>                  children: [
</span></span><span class=line><span class=cl>                    Text(&#39;value -&gt; ${_.count}&#39;),
</span></span><span class=line><span class=cl>                    ElevatedButton(
</span></span><span class=line><span class=cl>                      onPressed: () {
</span></span><span class=line><span class=cl>                        _.add();
</span></span><span class=line><span class=cl>                      },
</span></span><span class=line><span class=cl>                      child: Text(&#39;GetBuilder -&gt; add&#39;),
</span></span><span class=line><span class=cl>                    )
</span></span><span class=line><span class=cl>                  ],
</span></span><span class=line><span class=cl>                );
</span></span><span class=line><span class=cl>              },
</span></span><span class=line><span class=cl>            ),
</span></span><span class=line><span class=cl>            Divider(),
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            // count2
</span></span><span class=line><span class=cl>            GetBuilder<span class=p>&lt;</span><span class=nt>CountController</span><span class=p>&gt;</span>(
</span></span><span class=line><span class=cl>              init: controller,
</span></span><span class=line><span class=cl>              initState: (_) {},
</span></span><span class=line><span class=cl>              builder: (_) {
</span></span><span class=line><span class=cl>                print(&#34;GetBuilder - 4&#34;);
</span></span><span class=line><span class=cl>                return Text(&#39;value count2 -&gt; ${_.count2}&#39;);
</span></span><span class=line><span class=cl>              },
</span></span><span class=line><span class=cl>            ),
</span></span><span class=line><span class=cl>            Divider(),
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            // id2 标记一个 `builder` ，触发方式`controller.update([&#34;id2&#34;]);` ，可传多个 `Array` 类型。
</span></span><span class=line><span class=cl>            GetBuilder<span class=p>&lt;</span><span class=nt>CountController</span><span class=p>&gt;</span>(
</span></span><span class=line><span class=cl>              id: &#34;id2&#34;,
</span></span><span class=line><span class=cl>              init: controller,
</span></span><span class=line><span class=cl>              initState: (_) {},
</span></span><span class=line><span class=cl>              builder: (_) {
</span></span><span class=line><span class=cl>                print(&#34;GetBuilder - 4&#34;);
</span></span><span class=line><span class=cl>                return Text(&#39;id2 -&gt; value count2 -&gt; ${_.count2}&#39;);
</span></span><span class=line><span class=cl>              },
</span></span><span class=line><span class=cl>            ),
</span></span><span class=line><span class=cl>            Divider(),
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            // 按钮
</span></span><span class=line><span class=cl>            ElevatedButton(
</span></span><span class=line><span class=cl>              onPressed: () {
</span></span><span class=line><span class=cl>                controller.add();
</span></span><span class=line><span class=cl>              },
</span></span><span class=line><span class=cl>              child: Text(&#39;add&#39;),
</span></span><span class=line><span class=cl>            ),
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            ElevatedButton(
</span></span><span class=line><span class=cl>              onPressed: () {
</span></span><span class=line><span class=cl>                controller.add2();
</span></span><span class=line><span class=cl>              },
</span></span><span class=line><span class=cl>              child: Text(&#39;add2&#39;),
</span></span><span class=line><span class=cl>            ),
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            ElevatedButton(
</span></span><span class=line><span class=cl>              onPressed: () {
</span></span><span class=line><span class=cl>                controller.update();
</span></span><span class=line><span class=cl>              },
</span></span><span class=line><span class=cl>              child: Text(&#39;controller.update()&#39;),
</span></span><span class=line><span class=cl>            ),
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            ElevatedButton(
</span></span><span class=line><span class=cl>              onPressed: () {
</span></span><span class=line><span class=cl>                controller.update([&#34;id2&#34;]);
</span></span><span class=line><span class=cl>              },
</span></span><span class=line><span class=cl>              child: Text(&#39;controller.update(id2)&#39;),
</span></span><span class=line><span class=cl>            ),
</span></span><span class=line><span class=cl>          ],
</span></span><span class=line><span class=cl>        ),
</span></span><span class=line><span class=cl>      ),
</span></span><span class=line><span class=cl>    );
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><h4 id=workers>Workers</h4><p>Workers可以精确控制事件发生时触发回调，常用于Controller的onInit中：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>class CountController extends GetxController {
</span></span><span class=line><span class=cl>  final _count = 0.obs;
</span></span><span class=line><span class=cl>  set count(value) =&gt; this._count.value = value;
</span></span><span class=line><span class=cl>  get count =&gt; this._count.value;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  add() =&gt; _count.value++;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  @override
</span></span><span class=line><span class=cl>  void onInit() {
</span></span><span class=line><span class=cl>    super.onInit();
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    // 每次_count变化时调用
</span></span><span class=line><span class=cl>    ever(_count, (value) {
</span></span><span class=line><span class=cl>      print(&#34;ever -&gt; &#34; + value.toString());
</span></span><span class=line><span class=cl>    });
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    // 第一次被改变时才会被调用。
</span></span><span class=line><span class=cl>    once(_count, (value) {
</span></span><span class=line><span class=cl>      print(&#34;once -&gt; &#34; + value.toString());
</span></span><span class=line><span class=cl>    });
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    // 防DDos - 每当用户停止输入1秒时调用
</span></span><span class=line><span class=cl>    debounce(
</span></span><span class=line><span class=cl>      _count,
</span></span><span class=line><span class=cl>      (value) {
</span></span><span class=line><span class=cl>        print(&#34;debounce -&gt; &#34; + value.toString());
</span></span><span class=line><span class=cl>      },
</span></span><span class=line><span class=cl>      time: Duration(seconds: 1),
</span></span><span class=line><span class=cl>    );
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    // 忽略1秒内的所有变化。
</span></span><span class=line><span class=cl>    interval(
</span></span><span class=line><span class=cl>      _count,
</span></span><span class=line><span class=cl>      (value) {
</span></span><span class=line><span class=cl>        print(&#34;interval -&gt; &#34; + value.toString());
</span></span><span class=line><span class=cl>      },
</span></span><span class=line><span class=cl>      time: Duration(seconds: 1),
</span></span><span class=line><span class=cl>    );
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><h3 id=路由管理>路由管理</h3><h4 id=普通路由>普通路由</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>// 导航到新的页面。
</span></span><span class=line><span class=cl>Get.to(NextScreen());
</span></span><span class=line><span class=cl>// 要导航到下一条路由，并在返回后立即接收或更新数据。
</span></span><span class=line><span class=cl>var data = await Get.to(Payment());
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 关闭SnackBars、Dialogs、BottomSheets或任何你通常会用Navigator.pop(context)关闭的东西。
</span></span><span class=line><span class=cl>Get.back();
</span></span><span class=line><span class=cl>// 在另一个页面上，发送前一个路由的数据。并使用它。
</span></span><span class=line><span class=cl>Get.back(result: &#39;success&#39;);
</span></span><span class=line><span class=cl>if(data == &#39;success&#39;) madeAnything();
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 进入下一个页面，但没有返回上一个页面的选项（用于SplashScreens，登录页面等）。
</span></span><span class=line><span class=cl>Get.off(NextScreen());
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 进入下一个界面并取消之前的所有路由（在购物车、投票和测试中很有用）。
</span></span><span class=line><span class=cl>Get.offAll(NextScreen());
</span></span></code></pre></div><h4 id=别名路由>别名路由</h4><p>普通路由管理起来比较麻烦,通常我们使用别名路由。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>// 导航到下一个页面
</span></span><span class=line><span class=cl>Get.toNamed(&#34;/NextScreen&#34;);
</span></span><span class=line><span class=cl>// 传递参数
</span></span><span class=line><span class=cl>Get.toNamed(&#34;/NextScreen&#34;, arguments: &#34;Hello&#34;);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 浏览并删除前一个页面。
</span></span><span class=line><span class=cl>Get.offNamed(&#34;/NextScreen&#34;);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 浏览并删除所有以前的页面。
</span></span><span class=line><span class=cl>Get.offAllNamed(&#34;/NextScreen&#34;);
</span></span><span class=line><span class=cl>// 动态URL
</span></span><span class=line><span class=cl>Get.offAllNamed(&#34;/NextScreen?device=phone<span class=ni>&amp;id=354&amp;name=Enzo&#34;);</span>
</span></span></code></pre></div><p><strong>示例 1</strong></p><p>注册时跳到到Pin页面，路由传参：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>// RegisterController
</span></span><span class=line><span class=cl>Get.offNamed(
</span></span><span class=line><span class=cl>  RouteNames.systemRegisterPin,
</span></span><span class=line><span class=cl>  arguments: UserRegisterReq(
</span></span><span class=line><span class=cl>    username: userNameController.text,
</span></span><span class=line><span class=cl>    email: emailController.text,
</span></span><span class=line><span class=cl>    password: password,
</span></span><span class=line><span class=cl>  ),
</span></span><span class=line><span class=cl>);
</span></span></code></pre></div><p>从路由接收参数：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>// RegisterPinController
</span></span><span class=line><span class=cl>UserRegisterReq? req = Get.arguments;
</span></span></code></pre></div><h3 id=依赖注入>依赖注入</h3><p><strong>Get.put()：</strong> 不使用控制器实例也会被创建</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>Get.put(CountController());
</span></span></code></pre></div><p><strong>Get.lazyPut()：</strong> 懒加载方式创建实例，只有在使用时才创建</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>Get.lazyPut<span class=p>&lt;</span><span class=nt>CountController</span><span class=p>&gt;</span>(() =&gt; CountController());
</span></span></code></pre></div><p><strong>Get.putAsync()：</strong> <code>Get.put()</code>的异步版版本</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>Get.putAsync<span class=p>&lt;</span><span class=nt>CountController</span><span class=p>&gt;</span>(() async =&gt; await CountController());
</span></span></code></pre></div><p><strong>Get.create()：</strong> 每次使用都会创建一个新的实例</p><p><strong>Get.find()：</strong> 你可以实例化100万个控制器，Get总会找到你所需的控制器</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>Get.find<span class=p>&lt;</span><span class=nt>CountController</span><span class=p>&gt;</span>();
</span></span></code></pre></div><h3 id=其他>其他</h3><h4 id=getview>GetView</h4><p>一个已注册Controller的<code>const Stateless</code>Widget。</p><h4 id=getxservice>GetxService</h4><p>这个类就像一个GetxController，需要在应用程序的生命周期绝对持久化类实例，使用GetxService。</p><h4 id=其他高级-api>其他高级 API</h4><p><a class=link href=https://github.com/jonataslaw/getx#other-advanced-apis target=_blank rel=noopener>https://github.com/jonataslaw/getx#other-advanced-apis</a></p><h2 id=dio>dio</h2><h3 id=原理>原理</h3><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl># dio_mixin.dart 文件中 DioMixin 实现了 Dio
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>abstract class DioMixin implements Dio {
</span></span><span class=line><span class=cl>  @override
</span></span><span class=line><span class=cl>  Future<span class=p>&lt;</span><span class=nt>Response</span><span class=err>&lt;</span><span class=na>T</span><span class=p>&gt;</span>&gt; post<span class=p>&lt;</span><span class=nt>T</span><span class=p>&gt;</span>(
</span></span><span class=line><span class=cl>    String path, {                            # path： 请求的url链接
</span></span><span class=line><span class=cl>    data,                                     # data： 请求数据，例如上传用到的FromData
</span></span><span class=line><span class=cl>    Map<span class=p>&lt;</span><span class=nt>String</span><span class=err>,</span> <span class=na>dynamic</span><span class=p>&gt;</span>? queryParameters,    # data： 请求数据，例如上传用到的FromData
</span></span><span class=line><span class=cl>    Options? options,                         # queryParameters： 查询参数
</span></span><span class=line><span class=cl>    CancelToken? cancelToken,                 # cancelToken： 用来取消发送请求的token
</span></span><span class=line><span class=cl>    ProgressCallback? onSendProgress,         # onSendProgress： 网络请求发送的进度
</span></span><span class=line><span class=cl>    ProgressCallback? onReceiveProgress,      # onSendProgress： 网络请求发送的进度
</span></span><span class=line><span class=cl>  }) {
</span></span><span class=line><span class=cl>    return request<span class=p>&lt;</span><span class=nt>T</span><span class=p>&gt;</span>(                        # 返回request方法     
</span></span><span class=line><span class=cl>      path,
</span></span><span class=line><span class=cl>      data: data,
</span></span><span class=line><span class=cl>      options: checkOptions(&#39;POST&#39;, options),
</span></span><span class=line><span class=cl>      queryParameters: queryParameters,
</span></span><span class=line><span class=cl>      cancelToken: cancelToken,
</span></span><span class=line><span class=cl>      onSendProgress: onSendProgress,
</span></span><span class=line><span class=cl>      onReceiveProgress: onReceiveProgress,
</span></span><span class=line><span class=cl>    );
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p>get() post() 等调用时，返回request方法，request 方法对请求参数处理，并返回 fetch 方法，fetch 进行响应数据设定、构建请求流、添加拦截器、请求分发。</p><h2 id=webview>WebView</h2><p>WebView是应用内显示网页的功能，查看项目的官网、文档、条款等经常用到。推荐使用flutter_inappwebview，比官方webview_flutter有更丰富的功能和详尽的<a class=link href=https://inappwebview.dev/docs/5.x.x/intro target=_blank rel=noopener>文档</a>。主要功能：</p><ul><li><p><a class=link href=https://inappwebview.dev/docs/webview/in-app-webview target=_blank rel=noopener>InAppWebView</a>：是一个内嵌原生 WebView 小部件，集成到 Flutter 小部件树中。</p><ul><li><a class=link href=https://inappwebview.dev/docs/webview/context-menu target=_blank rel=noopener>ContextMenu</a>：WebView 的快捷菜单。例如长按网页文本后的复制。</li><li><a class=link href=https://inappwebview.dev/docs/webview/headless-in-app-webview target=_blank rel=noopener>HeadlessInAppWebView</a>：无头模式下的 WebView。在没有界面或UI的情况下运行WebView。它可以在没有用户界面的情况下执行网页加载和渲染操作，而不需要在用户界面中显示网页，用于后台处理网页数据、自动化测试、网络爬虫等。</li></ul></li><li><p>InAppBrowser</p><ul><li><a class=link href=https://inappwebview.dev/docs/in-app-browsers/in-app-browser target=_blank rel=noopener>InAppBrowser</a>：显示在 Flutter 应用程序顶部的原生 WebView，它没有集成到 Flutter 小部件树中。</li><li><a class=link href=https://inappwebview.dev/docs/in-app-browsers/chrome-safari-browser target=_blank rel=noopener>ChromeSafariBrowser</a>：Android 上的 <a class=link href=https://developer.chrome.com/docs/android/custom-tabs/overview/ target=_blank rel=noopener>Chrome 自定义选项卡</a>和 iOS 上的<a class=link href=https://developer.apple.com/documentation/safariservices/sfsafariviewcontroller target=_blank rel=noopener>SFSafariViewController</a>。</li></ul></li><li><p><a class=link href=https://inappwebview.dev/docs/in-app-localhost-server target=_blank rel=noopener>InAppLocalhostServer</a>：这个类允许你在 http://localhost:[port] 上创建一个简单的服务器。默认端口值为 8080。能够在本地服务器上缓存 js，html等资产文件，优化加载时间。</p></li><li><p><a class=link href=https://inappwebview.dev/docs/cookie-manager target=_blank rel=noopener>CookieManager</a>：此类实现了一个单例对象（共享实例），该对象管理 WebView 实例使用的 cookie。</p></li><li><p><a class=link href=https://inappwebview.dev/docs/http-auth-credential-database target=_blank rel=noopener>HttpAuthCredentialDatabase</a>：此类实现管理共享 HTTP 身份验证凭据缓存的单例对象（共享实例）。</p></li><li><p><a class=link href=https://inappwebview.dev/docs/web-storage-manager target=_blank rel=noopener>WebStorageManager</a>：这个类实现了一个单例对象（共享实例），它管理 WebView 实例使用的 Web 存储。</p></li><li><p><a class=link href=https://inappwebview.dev/docs/service-worker target=_blank rel=noopener>Service Worker</a>：Service Worker 是 PWA 的基本组成部分。它们支持快速加载（无论网络如何）、离线访问、推送通知和其他功能。</p></li></ul><details class=spoiler id=spoiler-21><summary>InAppWebView官方示例注释</summary><p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>import &#39;dart:async&#39;;
</span></span><span class=line><span class=cl>import &#39;package:flutter/foundation.dart&#39;;
</span></span><span class=line><span class=cl>import &#39;package:flutter/material.dart&#39;;
</span></span><span class=line><span class=cl>import &#39;package:flutter_inappwebview/flutter_inappwebview.dart&#39;;
</span></span><span class=line><span class=cl>import &#39;package:url_launcher/url_launcher.dart&#39;;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>Future main() async {
</span></span><span class=line><span class=cl>  WidgetsFlutterBinding.ensureInitialized();
</span></span><span class=line><span class=cl>  // 如果是Android，则对加载到 WebView 中的 Web内容（HTML/CSS/JavaScript）启用调试
</span></span><span class=line><span class=cl>  if (!kIsWeb <span class=err>&amp;&amp;</span> defaultTargetPlatform == TargetPlatform.android) {
</span></span><span class=line><span class=cl>    await InAppWebViewController.setWebContentsDebuggingEnabled(true);
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  runApp(const MaterialApp(home: MyApp()));
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>class MyApp extends StatefulWidget {
</span></span><span class=line><span class=cl>  const MyApp({super.key});
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  @override
</span></span><span class=line><span class=cl>  State<span class=p>&lt;</span><span class=nt>MyApp</span><span class=p>&gt;</span> createState() =&gt; _MyAppState();
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>class _MyAppState extends State<span class=p>&lt;</span><span class=nt>MyApp</span><span class=p>&gt;</span> {
</span></span><span class=line><span class=cl>  final GlobalKey webViewKey = GlobalKey();
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  InAppWebViewController? webViewController;
</span></span><span class=line><span class=cl>  InAppWebViewSettings settings = InAppWebViewSettings(
</span></span><span class=line><span class=cl>      // 能够监听 WebView.shouldOverrideUrlLoading（URL即将加载时）的事件。
</span></span><span class=line><span class=cl>      useShouldOverrideUrlLoading: true,
</span></span><span class=line><span class=cl>      // 设置为 true 以防止 HTML5 音频或视频自动播放。
</span></span><span class=line><span class=cl>      mediaPlaybackRequiresUserGesture: false,
</span></span><span class=line><span class=cl>      // 允许 HTML5 媒体播放在屏幕布局中内嵌显示，即让媒体播放器嵌入到网页的其他内容中一起显示
</span></span><span class=line><span class=cl>      allowsInlineMediaPlayback: true,
</span></span><span class=line><span class=cl>      // 根据请求的来源定义了哪些功能可供使用（例如，访问麦克风、摄像头、电池、网络共享等）
</span></span><span class=line><span class=cl>      iframeAllow: &#34;camera; microphone&#34;,
</span></span><span class=line><span class=cl>      // 如果 iframe 可以通过调用 requestFullscreen() 方法激活全屏模式，则设置为 true。
</span></span><span class=line><span class=cl>      iframeAllowFullscreen: true
</span></span><span class=line><span class=cl>  );
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  PullToRefreshController? pullToRefreshController;
</span></span><span class=line><span class=cl>  String url = &#34;&#34;;
</span></span><span class=line><span class=cl>  double progress = 0;
</span></span><span class=line><span class=cl>  final urlController = TextEditingController();
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  @override
</span></span><span class=line><span class=cl>  void initState() {
</span></span><span class=line><span class=cl>    super.initState();
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    // 在 WebView 中开启下拉刷新
</span></span><span class=line><span class=cl>    pullToRefreshController = kIsWeb ? null : PullToRefreshController(
</span></span><span class=line><span class=cl>      settings: PullToRefreshSettings(
</span></span><span class=line><span class=cl>        color: Colors.blue,
</span></span><span class=line><span class=cl>      ),
</span></span><span class=line><span class=cl>      onRefresh: () async {
</span></span><span class=line><span class=cl>        if (defaultTargetPlatform == TargetPlatform.android) {
</span></span><span class=line><span class=cl>          webViewController?.reload();
</span></span><span class=line><span class=cl>        } else if (defaultTargetPlatform == TargetPlatform.iOS) {
</span></span><span class=line><span class=cl>          webViewController?.loadUrl(
</span></span><span class=line><span class=cl>              urlRequest: URLRequest(url: await webViewController?.getUrl()));
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>      },
</span></span><span class=line><span class=cl>    );
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  @override
</span></span><span class=line><span class=cl>  Widget build(BuildContext context) {
</span></span><span class=line><span class=cl>    return Scaffold(
</span></span><span class=line><span class=cl>      appBar: AppBar(title: const Text(&#34;Official InAppWebView website&#34;)),
</span></span><span class=line><span class=cl>      body: SafeArea(
</span></span><span class=line><span class=cl>        child: Column(children: <span class=p>&lt;</span><span class=nt>Widget</span><span class=p>&gt;</span>[
</span></span><span class=line><span class=cl>          TextField(
</span></span><span class=line><span class=cl>            decoration: const InputDecoration(prefixIcon: Icon(Icons.search)),
</span></span><span class=line><span class=cl>            controller: urlController,
</span></span><span class=line><span class=cl>            keyboardType: TextInputType.url,
</span></span><span class=line><span class=cl>            onSubmitted: (value) {
</span></span><span class=line><span class=cl>              var url = WebUri(value);
</span></span><span class=line><span class=cl>              if (url.scheme.isEmpty) {
</span></span><span class=line><span class=cl>                url = WebUri(&#34;https://www.google.com/search?q=$value&#34;);
</span></span><span class=line><span class=cl>              }
</span></span><span class=line><span class=cl>              webViewController?.loadUrl(urlRequest: URLRequest(url: url));
</span></span><span class=line><span class=cl>            },
</span></span><span class=line><span class=cl>          ),
</span></span><span class=line><span class=cl>          Expanded(
</span></span><span class=line><span class=cl>            child: Stack(
</span></span><span class=line><span class=cl>              children: [
</span></span><span class=line><span class=cl>                InAppWebView(
</span></span><span class=line><span class=cl>                  key: webViewKey,
</span></span><span class=line><span class=cl>                  // 初始化URL
</span></span><span class=line><span class=cl>                  initialUrlRequest:
</span></span><span class=line><span class=cl>                  URLRequest(url: WebUri(&#34;https://inappwebview.dev/&#34;)),
</span></span><span class=line><span class=cl>                  // 初始化设置
</span></span><span class=line><span class=cl>                  initialSettings: settings,
</span></span><span class=line><span class=cl>                  // 下拉刷新
</span></span><span class=line><span class=cl>                  pullToRefreshController: pullToRefreshController,
</span></span><span class=line><span class=cl>                  // 创建 WebView 时触发的事件
</span></span><span class=line><span class=cl>                  onWebViewCreated: (controller) {
</span></span><span class=line><span class=cl>                    webViewController = controller;
</span></span><span class=line><span class=cl>                  },
</span></span><span class=line><span class=cl>                  // 当 WebView 开始加载 url 时触发的事件。
</span></span><span class=line><span class=cl>                  onLoadStart: (controller, url) {
</span></span><span class=line><span class=cl>                    setState(() {
</span></span><span class=line><span class=cl>                      this.url = url.toString();
</span></span><span class=line><span class=cl>                      urlController.text = this.url;
</span></span><span class=line><span class=cl>                    });
</span></span><span class=line><span class=cl>                  },
</span></span><span class=line><span class=cl>                  // 请求无访问权限资源 时触发的事件。
</span></span><span class=line><span class=cl>                  onPermissionRequest: (controller, request) async {
</span></span><span class=line><span class=cl>                    return PermissionResponse(
</span></span><span class=line><span class=cl>                        resources: request.resources,
</span></span><span class=line><span class=cl>                        action: PermissionResponseAction.GRANT);
</span></span><span class=line><span class=cl>                  },
</span></span><span class=line><span class=cl>                  // 让APP有机会在 URL即将加载 时进行控制。
</span></span><span class=line><span class=cl>                  shouldOverrideUrlLoading:
</span></span><span class=line><span class=cl>                      (controller, navigationAction) async {
</span></span><span class=line><span class=cl>                    var uri = navigationAction.request.url!;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                    if (![
</span></span><span class=line><span class=cl>                      &#34;http&#34;,
</span></span><span class=line><span class=cl>                      &#34;https&#34;,
</span></span><span class=line><span class=cl>                      &#34;file&#34;,
</span></span><span class=line><span class=cl>                      &#34;chrome&#34;,
</span></span><span class=line><span class=cl>                      &#34;data&#34;,
</span></span><span class=line><span class=cl>                      &#34;javascript&#34;,
</span></span><span class=line><span class=cl>                      &#34;about&#34;
</span></span><span class=line><span class=cl>                    ].contains(uri.scheme)) {
</span></span><span class=line><span class=cl>                      if (await canLaunchUrl(uri)) {
</span></span><span class=line><span class=cl>                        // Launch the App
</span></span><span class=line><span class=cl>                        await launchUrl(
</span></span><span class=line><span class=cl>                          uri,
</span></span><span class=line><span class=cl>                        );
</span></span><span class=line><span class=cl>                        // and cancel the request
</span></span><span class=line><span class=cl>                        return NavigationActionPolicy.CANCEL;
</span></span><span class=line><span class=cl>                      }
</span></span><span class=line><span class=cl>                    }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                    return NavigationActionPolicy.ALLOW;
</span></span><span class=line><span class=cl>                  },
</span></span><span class=line><span class=cl>                  // 完成加载 url 时触发的事件。
</span></span><span class=line><span class=cl>                  onLoadStop: (controller, url) async {
</span></span><span class=line><span class=cl>                    pullToRefreshController?.endRefreshing();
</span></span><span class=line><span class=cl>                    setState(() {
</span></span><span class=line><span class=cl>                      this.url = url.toString();
</span></span><span class=line><span class=cl>                      urlController.text = this.url;
</span></span><span class=line><span class=cl>                    });
</span></span><span class=line><span class=cl>                  },
</span></span><span class=line><span class=cl>                  // 加载请求时遇到错误 时触发的事件。
</span></span><span class=line><span class=cl>                  onReceivedError: (controller, request, error) {
</span></span><span class=line><span class=cl>                    pullToRefreshController?.endRefreshing();
</span></span><span class=line><span class=cl>                  },
</span></span><span class=line><span class=cl>                  // 更改正在加载的页面 时触发的事件。
</span></span><span class=line><span class=cl>                  onProgressChanged: (controller, progress) {
</span></span><span class=line><span class=cl>                    if (progress == 100) {
</span></span><span class=line><span class=cl>                      pullToRefreshController?.endRefreshing();
</span></span><span class=line><span class=cl>                    }
</span></span><span class=line><span class=cl>                    setState(() {
</span></span><span class=line><span class=cl>                      this.progress = progress / 100;
</span></span><span class=line><span class=cl>                      urlController.text = url;
</span></span><span class=line><span class=cl>                    });
</span></span><span class=line><span class=cl>                  },
</span></span><span class=line><span class=cl>                  // APP更新其访问的链接 时触发的事件。
</span></span><span class=line><span class=cl>                  onUpdateVisitedHistory: (controller, url, androidIsReload) {
</span></span><span class=line><span class=cl>                    setState(() {
</span></span><span class=line><span class=cl>                      this.url = url.toString();
</span></span><span class=line><span class=cl>                      urlController.text = this.url;
</span></span><span class=line><span class=cl>                    });
</span></span><span class=line><span class=cl>                  },
</span></span><span class=line><span class=cl>                  // WebView收到控制台报错 时触发的事件。
</span></span><span class=line><span class=cl>                  onConsoleMessage: (controller, consoleMessage) {
</span></span><span class=line><span class=cl>                    if (kDebugMode) {
</span></span><span class=line><span class=cl>                      print(consoleMessage);
</span></span><span class=line><span class=cl>                    }
</span></span><span class=line><span class=cl>                  },
</span></span><span class=line><span class=cl>                ),
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                // 进度指示器
</span></span><span class=line><span class=cl>                progress <span class=p>&lt;</span> <span class=nt>1.0</span>
</span></span><span class=line><span class=cl>                    <span class=err>?</span> <span class=na>LinearProgressIndicator</span><span class=err>(</span><span class=na>value:</span> <span class=na>progress</span><span class=err>)</span>
</span></span><span class=line><span class=cl>                    <span class=na>:</span> <span class=na>Container</span><span class=err>(),</span>
</span></span><span class=line><span class=cl>              <span class=err>],</span>
</span></span><span class=line><span class=cl>            <span class=err>),</span>
</span></span><span class=line><span class=cl>          <span class=err>),</span>
</span></span><span class=line><span class=cl>          <span class=na>ButtonBar</span><span class=err>(</span>
</span></span><span class=line><span class=cl>            <span class=na>alignment:</span> <span class=na>MainAxisAlignment</span><span class=err>.</span><span class=na>center</span><span class=err>,</span>
</span></span><span class=line><span class=cl>            <span class=na>children:</span> <span class=err>&lt;</span><span class=na>Widget</span><span class=p>&gt;</span>[
</span></span><span class=line><span class=cl>              // 后退按钮
</span></span><span class=line><span class=cl>              ElevatedButton(
</span></span><span class=line><span class=cl>                child: const Icon(Icons.arrow_back),
</span></span><span class=line><span class=cl>                onPressed: () {
</span></span><span class=line><span class=cl>                  webViewController?.goBack();
</span></span><span class=line><span class=cl>                },
</span></span><span class=line><span class=cl>              ),
</span></span><span class=line><span class=cl>              // 前进按钮
</span></span><span class=line><span class=cl>              ElevatedButton(
</span></span><span class=line><span class=cl>                child: const Icon(Icons.arrow_forward),
</span></span><span class=line><span class=cl>                onPressed: () {
</span></span><span class=line><span class=cl>                  webViewController?.goForward();
</span></span><span class=line><span class=cl>                },
</span></span><span class=line><span class=cl>              ),
</span></span><span class=line><span class=cl>              // 刷新按钮
</span></span><span class=line><span class=cl>              ElevatedButton(
</span></span><span class=line><span class=cl>                child: const Icon(Icons.refresh),
</span></span><span class=line><span class=cl>                onPressed: () {
</span></span><span class=line><span class=cl>                  webViewController?.reload();
</span></span><span class=line><span class=cl>                },
</span></span><span class=line><span class=cl>              ),
</span></span><span class=line><span class=cl>            ],
</span></span><span class=line><span class=cl>          ),
</span></span><span class=line><span class=cl>        ])
</span></span><span class=line><span class=cl>      )
</span></span><span class=line><span class=cl>    );
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div></p></details><h2 id=flexcolorpicker>FlexColorPicker</h2><p>FlexColorPicker 是 Fl​​utter 的可定制颜色选择器。可以使用 Material 2 和 Material 3。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>// 属性
</span></span><span class=line><span class=cl>ColorPicker(
</span></span><span class=line><span class=cl>    color: selectedColor,
</span></span><span class=line><span class=cl>    // 启用tab栏选择器:both, primary, accent, bw, custom, wheel
</span></span><span class=line><span class=cl>    pickersEnabled: const <span class=p>&lt;</span><span class=nt>ColorPickerType</span><span class=err>,</span> <span class=na>bool</span><span class=p>&gt;</span>{
</span></span><span class=line><span class=cl>      ColorPickerType.both: true,
</span></span><span class=line><span class=cl>      ColorPickerType.primary: false,
</span></span><span class=line><span class=cl>      ColorPickerType.accent: false,
</span></span><span class=line><span class=cl>      ColorPickerType.bw: false,
</span></span><span class=line><span class=cl>      ColorPickerType.custom: false,
</span></span><span class=line><span class=cl>      ColorPickerType.wheel: true,
</span></span><span class=line><span class=cl>    },
</span></span><span class=line><span class=cl>    // 自定义颜色
</span></span><span class=line><span class=cl>    // customColorSwatchesAndNames: customSwatches,
</span></span><span class=line><span class=cl>    // 定制tab标签
</span></span><span class=line><span class=cl>    pickerTypeLabels: <span class=p>&lt;</span><span class=nt>ColorPickerType</span><span class=err>,</span> <span class=na>String</span><span class=p>&gt;</span>{
</span></span><span class=line><span class=cl>      ColorPickerType.both: &#39;preset&#39;.tr,
</span></span><span class=line><span class=cl>      ColorPickerType.wheel: &#39;custom&#39;.tr,
</span></span><span class=line><span class=cl>    },
</span></span><span class=line><span class=cl>    // 在选择主要颜色后，基于所选颜色为您提供一组它的深浅颜色,禁用时才需要此属性
</span></span><span class=line><span class=cl>    // enableShadesSelection:false,
</span></span><span class=line><span class=cl>    // 生成所选颜色的 15 种色调的 Material 3 色调调色板
</span></span><span class=line><span class=cl>    enableTonalPalette: true,
</span></span><span class=line><span class=cl>    // 颜色不透明度滑块
</span></span><span class=line><span class=cl>    enableOpacity: true,
</span></span><span class=line><span class=cl>    // 显示所选颜色名称
</span></span><span class=line><span class=cl>    showMaterialName: true,
</span></span><span class=line><span class=cl>    materialNameTextStyle: Theme.of(context).textTheme.bodySmall,
</span></span><span class=line><span class=cl>    showColorName: true,
</span></span><span class=line><span class=cl>    colorNameTextStyle: Theme.of(context).textTheme.bodySmall,
</span></span><span class=line><span class=cl>    // 显示所选颜色的 RGB 颜色值
</span></span><span class=line><span class=cl>    showColorCode: true,
</span></span><span class=line><span class=cl>    // colorCodeHasColor: true,
</span></span><span class=line><span class=cl>    // showColorValue: true,
</span></span><span class=line><span class=cl>    colorCodeTextStyle: Theme.of(context).textTheme.bodyMedium,
</span></span><span class=line><span class=cl>    colorCodePrefixStyle: Theme.of(context).textTheme.bodySmall,
</span></span><span class=line><span class=cl>    // 显示最近选择的颜色
</span></span><span class=line><span class=cl>    // showRecentColors: true,
</span></span><span class=line><span class=cl>    // maxRecentColors: 8, 
</span></span><span class=line><span class=cl>    // recentColors: ,
</span></span><span class=line><span class=cl>    // onRecentColorsChanged: ,
</span></span><span class=line><span class=cl>    // 标题
</span></span><span class=line><span class=cl>    title: Text(
</span></span><span class=line><span class=cl>    &#39;ColorPicker&#39;,
</span></span><span class=line><span class=cl>    style: Theme.of(context).textTheme.headline6,
</span></span><span class=line><span class=cl>    ),
</span></span><span class=line><span class=cl>    heading: Text(
</span></span><span class=line><span class=cl>    &#39;Select color&#39;,
</span></span><span class=line><span class=cl>    style: Theme.of(context).textTheme.headline5,
</span></span><span class=line><span class=cl>    ),
</span></span><span class=line><span class=cl>    subheading: Text(
</span></span><span class=line><span class=cl>    &#39;Select color shade&#39;,
</span></span><span class=line><span class=cl>    style: Theme.of(context).textTheme.headline1,
</span></span><span class=line><span class=cl>    ),
</span></span><span class=line><span class=cl>    wheelSubheading: Text(
</span></span><span class=line><span class=cl>    &#39;Selected color and its shades&#39;,
</span></span><span class=line><span class=cl>    style: Theme.of(context).textTheme.headline1,
</span></span><span class=line><span class=cl>    ),
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    opacitySubheading: Text(
</span></span><span class=line><span class=cl>    &#39;Opacity&#39;,
</span></span><span class=line><span class=cl>    style: Theme.of(context).textTheme.headline1,
</span></span><span class=line><span class=cl>    ),
</span></span><span class=line><span class=cl>    recentColorsSubheading: Text(
</span></span><span class=line><span class=cl>    &#39;Selected color and its color swatch&#39;,
</span></span><span class=line><span class=cl>    style: Theme.of(context).textTheme.headline1,
</span></span><span class=line><span class=cl>    ),
</span></span><span class=line><span class=cl>    // 各个颜色小部件的大小、形状和间距以及色轮和不透明度滑块大小的属性。
</span></span><span class=line><span class=cl>    width: 40,
</span></span><span class=line><span class=cl>    height: 40,
</span></span><span class=line><span class=cl>    borderRadius: 4,
</span></span><span class=line><span class=cl>    spacing: 5,
</span></span><span class=line><span class=cl>    runSpacing: 5,
</span></span><span class=line><span class=cl>    hasBorder: false,
</span></span><span class=line><span class=cl>    // borderColor: Theme.of(context).dividerColor,
</span></span><span class=line><span class=cl>    elevation: 0,
</span></span><span class=line><span class=cl>    // 轮盘直径、宽度和边框
</span></span><span class=line><span class=cl>    wheelDiameter: 155,
</span></span><span class=line><span class=cl>    wheelWidth: 16,
</span></span><span class=line><span class=cl>    wheelHasBorder: false,
</span></span><span class=line><span class=cl>    // borderColor: Theme.of(context).dividerColor,
</span></span><span class=line><span class=cl>    // 颜色元素的间距、对齐方式和填充
</span></span><span class=line><span class=cl>    crossAxisAlignment: CrossAxisAlignment.center,
</span></span><span class=line><span class=cl>    padding: const EdgeInsets.all(16),
</span></span><span class=line><span class=cl>    columnSpacing: 0,
</span></span><span class=line><span class=cl>    // 复制按钮,确定按钮,取消按钮,关闭按钮
</span></span><span class=line><span class=cl>    enableTooltips: ture,
</span></span><span class=line><span class=cl>    // Dialog“确定”和“取消”操作按钮以及样式
</span></span><span class=line><span class=cl>    actionButtons: const ColorPickerActionButtons(...),
</span></span><span class=line><span class=cl>    // 颜色的复制粘贴行为
</span></span><span class=line><span class=cl>    copyPasteBehavior: const ColorPickerCopyPasteBehavior(
</span></span><span class=line><span class=cl>        // 颜色代码后缀复制按钮
</span></span><span class=line><span class=cl>        editFieldCopyButton: ture,
</span></span><span class=line><span class=cl>        // 键盘快捷键
</span></span><span class=line><span class=cl>        ctrlC: ture,
</span></span><span class=line><span class=cl>        ctrlV: ture,
</span></span><span class=line><span class=cl>        // 工具栏按钮
</span></span><span class=line><span class=cl>        copyButton: ture,
</span></span><span class=line><span class=cl>        copyIcon: ture,
</span></span><span class=line><span class=cl>        copyTooltip: MaterialLocalizations.of(context).copyButtonLabel,
</span></span><span class=line><span class=cl>        pasteButton: ture,
</span></span><span class=line><span class=cl>        pasteIcon: ture,
</span></span><span class=line><span class=cl>        pasteTooltip: MaterialLocalizations.of(context).pasteButtonLabel,
</span></span><span class=line><span class=cl>        // 从选取器复制颜色并将颜色粘贴
</span></span><span class=line><span class=cl>        longPressMenu: ture,
</span></span><span class=line><span class=cl>        secondaryMenu: ture,
</span></span><span class=line><span class=cl>        secondaryOnDesktopLongOnDevice: ture,
</span></span><span class=line><span class=cl>        // 颜色代码格式和粘贴解析
</span></span><span class=line><span class=cl>        copyFormat: ColorPickerCopyFormat.dartCode，
</span></span><span class=line><span class=cl>        parseShortHexCode: ture,
</span></span><span class=line><span class=cl>        editUsesParsedPaste: ture,
</span></span><span class=line><span class=cl>        snackBarParseError: ture,
</span></span><span class=line><span class=cl>        snackBarMessage: ture,
</span></span><span class=line><span class=cl>        snackBarDuration: const Duration(milliseconds: 1800),
</span></span><span class=line><span class=cl>        feedbackParseError: false,
</span></span><span class=line><span class=cl>    ),
</span></span><span class=line><span class=cl>    // 回调
</span></span><span class=line><span class=cl>    // 当选择具有所选新颜色值的新颜色时调用
</span></span><span class=line><span class=cl>    onColorChanged: (Color color) {
</span></span><span class=line><span class=cl>      selectedColor = color;
</span></span><span class=line><span class=cl>    },
</span></span><span class=line><span class=cl>    // 开始颜色选择时调用
</span></span><span class=line><span class=cl>    onColorChangeStart: ,
</span></span><span class=line><span class=cl>    // 结束颜色选择时调用
</span></span><span class=line><span class=cl>    onColorChangeEnd: ,
</span></span><span class=line><span class=cl>    // 返回最近选择的颜色的当前列表
</span></span><span class=line><span class=cl>    onRecentColorsChanged: ,
</span></span><span class=line><span class=cl>  ),
</span></span><span class=line><span class=cl>  
</span></span><span class=line><span class=cl>// dialog方法：
</span></span><span class=line><span class=cl>// 在对话框打开时跟踪 ColorPicker 的不同onChange回调
</span></span><span class=line><span class=cl>ColorPicker(...).showPickerDialog;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// dialog函数：
</span></span><span class=line><span class=cl>// 只需传入对话框的构建上下文以及所需的起始颜色值，并等待它在对话框关闭时返回选定的颜色
</span></span><span class=line><span class=cl>showColorPickerDialog(...)
</span></span></code></pre></div><h2 id=widgetbook仅作了解>Widgetbook(仅作了解)</h2><p>使用Widgetbook可以管理组件、使用不同设备尺寸测试组件、实时修改组件参数、协作共享。</p><h3 id=windows配置>Windows配置</h3><p>确保安装Visual Studio，及其应用：
<img src=/p/flutter/7.png width=1085 height=312 srcset="/p/flutter/7_hu4fa1ec2a00219a167f5b56770646289b_37010_480x0_resize_box_3.png 480w, /p/flutter/7_hu4fa1ec2a00219a167f5b56770646289b_37010_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=347 data-flex-basis=834px></p><p>从<a class=link href=https://www.nuget.org/downloads target=_blank rel=noopener>https://www.nuget.org/downloads</a>下载最新的nuget.exe,并放入任意文件夹（我的在C:\Program Files\Microsoft Visual Studio），配置系统环境变量。</p><h3 id=使用-1>使用</h3><ul><li>在pubspec.yaml安装 widgetbook 组件</li></ul><div class="box info"><span class="icon-box baseline"><svg><use href="#info-box"/></svg></span><p>注意是放在 dev_dependencies 下面</p></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>dev_dependencies:
</span></span><span class=line><span class=cl>  flutter_test:
</span></span><span class=line><span class=cl>    sdk: flutter
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  flutter_lints: ^2.0.0
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  widgetbook: ^3.0.0-beta.14
</span></span></code></pre></div><ul><li>新建lib/app.widgetbook.dart</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>import &#39;package:flutter/material.dart&#39;;
</span></span><span class=line><span class=cl>// ignore: depend_on_referenced_packages
</span></span><span class=line><span class=cl>import &#39;package:widgetbook/widgetbook.dart&#39;;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>import &#39;你的组件&#39;;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>void main() {
</span></span><span class=line><span class=cl>  runApp(const HotReload());
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>class HotReload extends StatelessWidget {
</span></span><span class=line><span class=cl>  const HotReload({Key? key}) : super(key: key);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  @override
</span></span><span class=line><span class=cl>  Widget build(BuildContext context) {
</span></span><span class=line><span class=cl>    return Widgetbook.material(
</span></span><span class=line><span class=cl>      // Widgetbook 属性选择
</span></span><span class=line><span class=cl>      addons: [
</span></span><span class=line><span class=cl>        // 主题
</span></span><span class=line><span class=cl>        // buildMaterialThemeAddon(),
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        // 字体大小
</span></span><span class=line><span class=cl>        // buildTextScaleAddon(),
</span></span><span class=line><span class=cl>      ],
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      // 可以容纳包、文件夹、类别、组件和用例
</span></span><span class=line><span class=cl>      directories: [
</span></span><span class=line><span class=cl>        //
</span></span><span class=line><span class=cl>        buildWidgetbookCategory(),
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        //
</span></span><span class=line><span class=cl>        //buildWidgetbookCategory2(),
</span></span><span class=line><span class=cl>      ],
</span></span><span class=line><span class=cl>    );
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  TextScaleAddon buildTextScaleAddon() {
</span></span><span class=line><span class=cl>    return TextScaleAddon(
</span></span><span class=line><span class=cl>        setting: TextScaleSetting.firstAsSelected(
</span></span><span class=line><span class=cl>            textScales: [1.0, 1.25, 1.5, 1.75, 2]));
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  MaterialThemeAddon buildMaterialThemeAddon() {
</span></span><span class=line><span class=cl>    return MaterialThemeAddon(
</span></span><span class=line><span class=cl>        setting: MaterialThemeSetting.firstAsSelected(themes: [
</span></span><span class=line><span class=cl>      WidgetbookTheme(name: &#34;dark&#34;, data: ThemeData.dark()),
</span></span><span class=line><span class=cl>      WidgetbookTheme(name: &#34;light&#34;, data: ThemeData.light()),
</span></span><span class=line><span class=cl>    ]));
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  WidgetbookCategory buildWidgetbookCategory() {
</span></span><span class=line><span class=cl>    return WidgetbookCategory(
</span></span><span class=line><span class=cl>      // 分类名
</span></span><span class=line><span class=cl>      name: &#39;公共组件&#39;,
</span></span><span class=line><span class=cl>      children: [
</span></span><span class=line><span class=cl>        WidgetbookComponent(
</span></span><span class=line><span class=cl>          // 组件名
</span></span><span class=line><span class=cl>          name: &#39;Spinkit加载&#39;,
</span></span><span class=line><span class=cl>          useCases: [
</span></span><span class=line><span class=cl>            WidgetbookUseCase.center(
</span></span><span class=line><span class=cl>              // 组件用例名
</span></span><span class=line><span class=cl>              name: &#34;SpinKitFadingCircle&#34;,
</span></span><span class=line><span class=cl>              child: mySpinkit(),
</span></span><span class=line><span class=cl>            ),
</span></span><span class=line><span class=cl>          ],
</span></span><span class=line><span class=cl>        ),
</span></span><span class=line><span class=cl>      ],
</span></span><span class=line><span class=cl>    );
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><h2 id=plugin>Plugin</h2><p>Flutter Plugin是可以插入到主程序中，扩展功能的独立组件，我们实现原生平台的功能就需要用到。</p><p><strong>创建</strong></p><p>使用 Android Studio 创建 Flutter 项目，项目类型选 plugin 。目录如下</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>project
</span></span><span class=line><span class=cl>├── android       // 原生
</span></span><span class=line><span class=cl>├── example       // 运行调试
</span></span><span class=line><span class=cl>├── ios           // 原生
</span></span><span class=line><span class=cl>├── lib           
</span></span></code></pre></div><h3 id=flutter-1>Flutter</h3><p><img src=/p/flutter/PlatformChannels.png width=580 height=647 srcset="/p/flutter/PlatformChannels_hu9187f560825b219b5824e0b76846e06f_23082_480x0_resize_box_3.png 480w, /p/flutter/PlatformChannels_hu9187f560825b219b5824e0b76846e06f_23082_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=89 data-flex-basis=215px></p><p><strong>Flutter有三种类型的Channel:</strong></p><ul><li>BasicMessageChannel:用于传递字符串和半结构化的信息。持续通信，收到消息后可以回复此次消息，如：Native将遍历到的文件信息陆续传递到Dart。</li><li>MethodChannel:用于传递方法调用(method invocation)。一次性通信：如Flutteri调用Native拍照；</li><li>EventChannel:用于数据流(event streams)的通信。持续通信，收到消息后无法回复此次消息，通过长用于Native向Dat的通信，如：手机电量变化，网络连接变化，陀螺仪，传感器等；</li></ul><p><strong>Channel支持的数据类型：</strong></p><div class=table-wrapper><table><thead><tr><th>Dart</th><th>Android</th><th>ios</th></tr></thead><tbody><tr><td>null</td><td>null</td><td>nil (NSNull when nested)</td></tr><tr><td>bool</td><td>java.lang.Boolean</td><td>NSNumber numberWithBool:</td></tr><tr><td>int</td><td>java.lang.Integer</td><td>NSNumber numberWithInt:</td></tr><tr><td>int, if 32 bits notenough</td><td>java.lang.Long</td><td>NSNumber numberWithLong:</td></tr><tr><td>double</td><td>java.lang.Double</td><td>NSNumber numberWithDouble:</td></tr><tr><td>String</td><td>java.lang.String</td><td>NSString</td></tr><tr><td>Uint8List</td><td>byte[]</td><td>FlutterStandardTypedData typedDataWithBytes:</td></tr><tr><td>Int32List</td><td>int][]</td><td>FlutterStandardTypedData typedDataWithInt32:</td></tr><tr><td>Int64List</td><td>long[]</td><td>FlutterStandardTypedData typedDataWithInt64:</td></tr><tr><td>Float64List</td><td>double[]</td><td>FlutterStandardTypedData typedDataWithFloat64:</td></tr><tr><td>List</td><td>java.util.ArrayList</td><td>NSArray</td></tr><tr><td>Map</td><td>java.util.HashMap</td><td>NSDictionary</td></tr></tbody></table></div><h3 id=android>Android</h3><h4 id=java>Java</h4><p><img src=/p/flutter/10.jpg width=757 height=292 srcset="/p/flutter/10_hu9850a35ccc7cfd8280aafa0e3eada853_24691_480x0_resize_q75_box.jpg 480w, /p/flutter/10_hu9850a35ccc7cfd8280aafa0e3eada853_24691_1024x0_resize_q75_box.jpg 1024w" loading=lazy class=gallery-image data-flex-grow=259 data-flex-basis=622px></p><ul><li>访问修饰符</li></ul><div class=table-wrapper><table><thead><tr><th>访问范围</th><th>private</th><th>default</th><th>protected</th><th>public</th></tr></thead><tbody><tr><td>同一类中</td><td>√</td><td>√</td><td>√</td><td>√</td></tr><tr><td>同一包中(子类和非子类)</td><td>×</td><td>√</td><td>√</td><td>√</td></tr><tr><td>不同包中的子类</td><td>×</td><td>×</td><td>√</td><td>√</td></tr><tr><td>不同包中的非子类</td><td>×</td><td>×</td><td>×</td><td>√</td></tr></tbody></table></div><h4 id=进程和线程>进程和线程</h4><p><strong>进程</strong></p><ul><li>Android系统会为每个应用程序创建一个进程</li><li>如果该应用程序的进程已经存在（已有组件已经在运行），那么刚启动的组件会在已有的进程和线程中启动运行</li><li>组件可以运行在指定的其他线程，在AndroidManifest文件中的每种组件标签都支持设置 android:process 属性</li><li>系统会依据进程的“importance hierarchy”等级清除进程，这是为了回收系统资源和新建进程</li><li>Binder/Socket用于进程间通信</li></ul><p><strong>线程</strong></p><ul><li>系统会为应用程序创建一个名为“main”的主线程，不会为每个组件的实例创建单独的线程</li><li>通常实现Runnable接口来定义线程的执行逻辑，然后将其传递给Thread类来启动线程</li><li>Handler用于同进程的线程间通信，子线程运行并生成Message，Looper获取message并传递给Handler，Handler逐个获取子线程中的Message</li></ul><div class=table-wrapper><table><thead><tr><th>概念</th><th>定义</th><th>作用</th></tr></thead><tbody><tr><td>主线程 (UI线程、Main Thread)</td><td>当应用程序启动时，会自动开启1条主线程</td><td>处理与UI相关的事件(如更新、操作等)</td></tr><tr><td>子线程 (工作线程)</td><td>人为手动开启的线程</td><td>执行耗时操作(如网络请求、数据加载等)</td></tr><tr><td>消息 (Message)</td><td>线程间通讯的数据单元 (即Handler接受&处理的消息对象)</td><td>存储需操作的通信信息</td></tr><tr><td>消息队列 (Message Queue)</td><td>一种数据结构(存储特点：先进先出)</td><td>存储Handler发送过来的消息(Message)</td></tr><tr><td>处理者 (Handler)</td><td>主线程与子线程的通信媒介线程消息的主要处理者</td><td>* 添加消息(Message)到消息队列(Message Queue)<br>*处理循环器(Looper)分派过来的消息(Message)</td></tr><tr><td>循环器 (Looper)</td><td>消息队列(Message Queue)与处理者(Handler)的通信媒介<br>每个线程中只能拥有1个Looper，多个线程可往1个Looper所持有的MessageQueue 中发送消息，提供了线程间通信的可能</td><td>* 消息获取：循环取出消息队列(Message Queue)的消息(Message)<br>* 消息分发：将取出的消息(Message)发送给对应的处理者(Handler)</td></tr><tr><td>View.post()</td><td>View类中的方法，适用于任何View对象</td><td>* 将Runnable对象添加到View的事件队列中<br>* 获取View的宽高等属性值</td></tr><tr><td>ThreadLocal</td><td>提供线程本地变量</td><td>ThreadLocal为每一个线程开辟了一个独立的存储器，只有对应的线程才能够访问其数据</td></tr><tr><td>runOnUiThread()</td><td>Activity类中的方法，仅适用于Activity</td><td>将Runnable对象添加到Activity的事件队列中，可以确保其在当前主线程中执行</td></tr></tbody></table></div><p>参考：<a class=link href=https://blog.csdn.net/qq_32907491/article/details/132645806 target=_blank rel=noopener>Handler</a>、<a class=link href=https://www.cnblogs.com/andy-songwei/category/1609976.html target=_blank rel=noopener>Android多线程</a></p><h4 id=生命周期>生命周期</h4><p><strong>View的生命周期方法</strong></p><p><a class=link href=https://developer.android.com/develop/ui/views/layout/custom-views/custom-components#extend-ondraw-and-onmeasure target=_blank rel=noopener>英文原表</a></p><html><head><meta charset=utf-8></head><body><table border=2 width=85% align=center cellpadding=5><thead><tr><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">类别</font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">方法</font></font></th><th><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">描述</font></font></th></tr></thead><tbody><tr><td rowspan=2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">创建</font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">构造函数</font></font></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">构造函数有两种形式，一种是在通过代码创建视图时调用的，另一种是在通过布局文件填充视图时调用的。第二种形式解析并应用布局文件中定义的属性。</font></font></td></tr><tr><td><code translate=no dir=ltr><code translate=no dir=ltr><a href=file:///C:/reference/android/view/View#onFinishInflate()>onFinishInflate()</a></code></code></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">在视图及其所有子视图都从 XML 中映射后调用。</font></font></td></tr><tr><td rowspan=3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">布局</font></font></td><td><code translate=no dir=ltr><code translate=no dir=ltr><a href=file:///C:/reference/android/view/View#onMeasure(int,%20int)>onMeasure(<wbr>int,<wbr> int)</a></code></code></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">调用来确定此视图及其所有子视图的尺寸要求。</font></font></td></tr><tr><td><code translate=no dir=ltr><code translate=no dir=ltr><a href=file:///C:/reference/android/view/View#onLayout(boolean,%20int,%20int,%20int,%20int)>onLayout(<wbr>boolean,<wbr> int,<wbr> int,<wbr> int,<wbr> int)</a></code></code></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当此视图必须为其所有子视图分配大小和位置时调用。</font></font></td></tr><tr><td><code translate=no dir=ltr><code translate=no dir=ltr><a href=file:///C:/reference/android/view/View#onSizeChanged(int,%20int,%20int,%20int)>onSizeChanged(<wbr>int,<wbr> int,<wbr> int,<wbr> int)</a></code></code></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当此视图的大小改变时调用。</font></font></td></tr><tr><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">绘画</font></font></td><td><code translate=no dir=ltr><code translate=no dir=ltr><a href=file:///C:/reference/android/view/View#onDraw(android.graphics.Canvas)>onDraw(<wbr>Canvas)</a></code></code></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当视图必须呈现其内容时调用。</font></font></td></tr><tr><td rowspan=4><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">事件处理</font></font></td><td><code translate=no dir=ltr><code translate=no dir=ltr><a href=file:///C:/reference/android/view/View#onKeyDown(int,%20android.view.KeyEvent)>onKeyDown(<wbr>int,<wbr> KeyEvent)</a></code></code></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当发生按键事件时调用。</font></font></td></tr><tr><td><code translate=no dir=ltr><code translate=no dir=ltr><a href=file:///C:/reference/android/view/View#onKeyUp(int,%20android.view.KeyEvent)>onKeyUp(<wbr>int,<wbr> KeyEvent)</a></code></code></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当发生按键释放事件时调用。</font></font></td></tr><tr><td><code translate=no dir=ltr><code translate=no dir=ltr><a href=file:///C:/reference/android/view/View#onTrackballEvent(android.view.MotionEvent)>onTrackballEvent(<wbr>MotionEvent)</a></code></code></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当轨迹球运动事件发生时调用。</font></font></td></tr><tr><td><code translate=no dir=ltr><code translate=no dir=ltr><a href=file:///C:/reference/android/view/View#onTouchEvent(android.view.MotionEvent)>onTouchEvent(<wbr>MotionEvent)</a></code></code></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当发生触摸屏运动事件时调用。</font></font></td></tr><tr><td rowspan=2><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">焦点</font></font></td><td><code translate=no dir=ltr><code translate=no dir=ltr><a href=file:///C:/reference/android/view/View#onFocusChanged(boolean,%20int,%20android.graphics.Rect)>onFocusChanged(<wbr>boolean,<wbr> int,<wbr> Rect)</a></code></code></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当视图获得或失去焦点时调用。</font></font></td></tr><tr><td><code translate=no dir=ltr><code translate=no dir=ltr><a href=file:///C:/reference/android/view/View#onWindowFocusChanged(boolean)>onWindowFocusChanged(<wbr>boolean)</a></code></code></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当包含视图的窗口获得或失去焦点时调用。</font></font></td></tr><tr><td rowspan=3><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">附加</font></font></td><td><code translate=no dir=ltr><code translate=no dir=ltr><a href=file:///C:/reference/android/view/View#onAttachedToWindow()>onAttachedToWindow()</a></code></code></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当视图附加到窗口时调用。</font></font></td></tr><tr><td><code translate=no dir=ltr><code translate=no dir=ltr><a href=file:///C:/reference/android/view/View#onDetachedFromWindow()>onDetachedFromWindow()</a></code></code></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当视图与其窗口分离时调用。</font></font></td></tr><tr><td><code translate=no dir=ltr><code translate=no dir=ltr><a href=file:///C:/reference/android/view/View#onWindowVisibilityChanged(int)>onWindowVisibilityChanged(<wbr>int)</a></code></code></td><td><font style="vertical-align: inherit;"><font style="vertical-align: inherit;">当包含视图的窗口的可见性发生改变时调用。</font></font></td></tr></tbody></table></body></html><p><strong>Activity生命周期</strong></p><p><img src=/p/flutter/14.png width=1030 height=1250 srcset="/p/flutter/14_huc8ed9721ed893a209efda528a311345b_26410_480x0_resize_box_3.png 480w, /p/flutter/14_huc8ed9721ed893a209efda528a311345b_26410_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=82 data-flex-basis=197px></p><p><strong>Activity的启动</strong></p><ol><li><strong>Activity</strong> 调用<strong>onCreate</strong>方法，将资源 ID <code>R.layout.main_activity</code> 更改为 <code>setContentView()</code></li><li><strong>Activity</strong> 调用onWindowAttributesChanged 方法，而且这个方法连续调用多次</li><li><code>View</code> 调用构造方法</li><li><code>View</code> 调用onFinishInflate方法，说明这个时候View已经填充完毕，但是还没开始触发绘制过程</li><li><strong>Activity</strong> 调用<strong>onstart</strong>方法， 进入“已启动”状态</li><li><strong>Activity</strong> 再次调用 onWindowAttributesChanged 方法</li><li><strong>Activity</strong> 调用<strong>onResume</strong>，“已恢复”状态，进行后面初始化步骤，并进入与用户互动的状态</li><li><strong>Activity</strong> 调用onAttachedToWindow，Activity跟Window进行绑定</li><li><code>View</code> 调用onAttachedToWindow，View跟Window进行绑定</li><li><code>View</code> 调用 onWindowVisibilityChanged(int visibility)，参数变为 <code>View.VISIABLE</code></li><li><code>View</code> 调用onMeasure，开始测量</li><li><code>View</code> 调用onSizeChanged，表示测量完成，尺寸发生了变化</li><li><code>View</code> 调用onLayout，开始摆放位置</li><li><code>View</code> 调用 onDraw，开始绘制</li><li><strong>Activity</strong> 调用onWindowFocusChanged(boolean hasFocus)，此时为true，代表窗体已经获取了焦点</li><li><code>View</code> 调用 onWindowFocusChanged(boolean hasWindowFocus)，此时为true，代表当前的控件获取了Window焦点，当调用这个方法后说明当前Activity中的View才是真正的可见了</li></ol><p><strong>Activity的退出</strong></p><ol><li><strong>Activity</strong> 调用 <strong>onPause</strong>，中断时的暂停状态</li><li><code>View</code> 调用 onWindowVisibilityChanged(int visibility)，参数变为 <code>View.GONE</code>，View中对应的Window隐藏</li><li><strong>Activity</strong> 调用onWindowFocusChanged(boolean hasFocus)，此时为false，说明Actvity所在的Window已经失去焦点</li><li><strong>Activity</strong> 调用 onStop，此时Activity已经切换到后台</li><li><strong>Activity</strong> 调用 onDestory，此时Activity开始准备销毁，实际上并不代表Activity已经销毁</li><li><code>View</code> 调用 onDetachedFromWindow，此时View 与Window解除绑定</li><li><strong>Activity</strong> 调用 onDetathedFromWindow ，此时Activity 与Window 解除绑定</li><li>View即将被销毁，可以在 <code>onDetachedFromWindow</code> 方法中做一些资源释放，防止内存泄漏</li></ol><h4 id=android四大组件>android四大组件</h4><p>1、activity
（1）一个Activity通常就是一个单独的屏幕（窗口）。</p><p>（2）Activity之间通过Intent进行通信。</p><p>（3）android应用中每一个Activity都必须要在AndroidManifest.xml配置文件中声明，否则系统将不识别也不执行该Activity。</p><p>2、service
（1）service用于在后台完成用户指定的操作。service分为两种：</p><p>（a）started（启动）：当应用程序组件（如activity）调用startService()方法启动服务时，服务处于started状态。</p><p>（b）bound（绑定）：当应用程序组件调用bindService()方法绑定到服务时，服务处于bound状态。</p><p>（2）startService()与bindService()区别：</p><p>（a）started service（启动服务）是由其他组件调用startService()方法启动的，这导致服务的onStartCommand()方法被调用。当服务是started状态时，其生命周期与启动它的组件无关，并且可以在后台无限期运行，即使启动服务的组件已经被销毁。因此，服务需要在完成任务后调用stopSelf()方法停止，或者由其他组件调用stopService()方法停止。</p><p>（b）使用bindService()方法启用服务，调用者与服务绑定在了一起，调用者一旦退出，服务也就终止，大有“不求同时生，必须同时死”的特点。</p><p>（3）开发人员需要在应用程序配置文件中声明全部的service，使用<service></service>标签。</p><p>（4）Service通常位于后台运行，它一般不需要与用户交互，因此Service组件没有图形用户界面。Service组件需要继承Service基类。Service组件通常用于为其他组件提供后台服务或监控其他组件的运行状态。</p><p>3、content provider
（1）android平台提供了Content Provider使一个应用程序的指定数据集提供给其他应用程序。其他应用可以通过ContentResolver类从该内容提供者中获取或存入数据。</p><p>（2）只有需要在多个应用程序间共享数据是才需要内容提供者。例如，通讯录数据被多个应用程序使用，且必须存储在一个内容提供者中。它的好处是统一数据访问方式。</p><p>（3）ContentProvider实现数据共享。ContentProvider用于保存和获取数据，并使其对所有应用程序可见。这是不同应用程序间共享数据的唯一方式，因为android没有提供所有应用共同访问的公共存储区。</p><p>（4）开发人员不会直接使用ContentProvider类的对象，大多数是通过ContentResolver对象实现对ContentProvider的操作。</p><p>（5）ContentProvider使用URI来唯一标识其数据集，这里的URI以content://作为前缀，表示该数据由ContentProvider来管理。</p><p>4、broadcast receiver
（1）你的应用可以使用它对外部事件进行过滤，只对感兴趣的外部事件(如当电话呼入时，或者数据网络可用时)进行接收并做出响应。广播接收器没有用户界面。然而，它们可以启动一个activity或serice来响应它们收到的信息，或者用NotificationManager来通知用户。通知可以用很多种方式来吸引用户的注意力，例如闪动背灯、震动、播放声音等。一般来说是在状态栏上放一个持久的图标，用户可以打开它并获取消息。</p><p>（2）广播接收者的注册有两种方法，分别是程序动态注册和AndroidManifest文件中进行静态注册。</p><p>（3）动态注册广播接收器特点是当用来注册的Activity关掉后，广播也就失效了。静态注册无需担忧广播接收器是否被关闭，只要设备是开启状态，广播接收器也是打开着的。也就是说哪怕app本身未启动，该app订阅的广播在触发时也会对它起作用。</p><h4 id=builder模式>builder模式</h4><p>当一个对象有很多属性，比如用户对象有很多属性：用户名、ID、性别、地址、工作类型、联系方式等等，写多个构造方法和set、get将难以阅读维护，我们可以采用java链式调用这种更优雅的方式。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>public class User {
</span></span><span class=line><span class=cl>    private final String name;
</span></span><span class=line><span class=cl>    private int age;
</span></span><span class=line><span class=cl>    private String address;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    private User(Builder builder) {
</span></span><span class=line><span class=cl>        // 初始化变量
</span></span><span class=line><span class=cl>        this.name = builder.name;
</span></span><span class=line><span class=cl>        this.age = builder.age;
</span></span><span class=line><span class=cl>        this.address = builder.address;
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    static class Builder {
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>        // 与外部User类属性一致
</span></span><span class=line><span class=cl>        private final String name;
</span></span><span class=line><span class=cl>        private int age;
</span></span><span class=line><span class=cl>        private String address;
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>        // 必填属性
</span></span><span class=line><span class=cl>        public Builder(String name) {
</span></span><span class=line><span class=cl>            this.name = name;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        // 可选属性
</span></span><span class=line><span class=cl>        public Builder Age(int age) {
</span></span><span class=line><span class=cl>            this.age = age;
</span></span><span class=line><span class=cl>            return this;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        // 可选属性
</span></span><span class=line><span class=cl>        public Builder Address(String address) {
</span></span><span class=line><span class=cl>            this.address = address;
</span></span><span class=line><span class=cl>            return this;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        // 提供外部类实例对象
</span></span><span class=line><span class=cl>        public User build() {
</span></span><span class=line><span class=cl>       		 // 合理性做判断
</span></span><span class=line><span class=cl>            if (age <span class=err>&lt;</span>= 0) {
</span></span><span class=line><span class=cl>                throw new RuntimeException(&#34;年龄不合法&#34;);
</span></span><span class=line><span class=cl>            }
</span></span><span class=line><span class=cl>            return new User(this);
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>//使用
</span></span><span class=line><span class=cl>User user = new User.Builder(&#34;UserName&#34;)
</span></span><span class=line><span class=cl>        .Age(18)
</span></span><span class=line><span class=cl>        .Address(&#34;China&#34;)
</span></span><span class=line><span class=cl>        .build();
</span></span></code></pre></div><p>另外，可以使用IDE中的插件InnerBuilder生成代码。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>// 在类中右键Generate选择Builder
</span></span><span class=line><span class=cl>public class User {
</span></span><span class=line><span class=cl>    private final String name;
</span></span><span class=line><span class=cl>    private int age;
</span></span><span class=line><span class=cl>    private String address;
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><h4 id=channel>Channel</h4><ol><li><p>创建Channel</p><p>三种Channel 的构造十分相似：</p></li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>// 传递字符串、JSON
</span></span><span class=line><span class=cl>BasicMessageChannel(BinaryMessenger messenger,String name,MessageCodec<span class=p>&lt;</span><span class=nt>T</span><span class=p>&gt;</span> codec)
</span></span><span class=line><span class=cl>// 方法调用
</span></span><span class=line><span class=cl>MethodChannel(BinaryMessenger messenger,String name,MethodCodec codec)
</span></span><span class=line><span class=cl>// 事件流监听，包括用户事件监听，电量变化，网络连接变化，陀螺仪，传感器等
</span></span><span class=line><span class=cl>EventChannel(BinaryMessenger messenger,String name,MethodCodec codec)
</span></span></code></pre></div><ul><li><code>BinaryMessenger messenger</code> 消息的发送与接收的工具；</li><li><code>String name</code> Channel的名字；</li><li><code>MessageCodec&lt;T> codec</code> 消息的编解码器，它有几种不同类型的实现：<ul><li><code>BinaryCodec</code> 最为简单的一种Codec,因为其返回值类型和入参的类型相同，均为二进制格式(Android中为ByteBuffer,.iS中为NSData)。实际上，BinaryCodec在编解码过程中什么都没做，只是原封不动将二进制数据消息返回而已。或许你会因此觉得BinaryCodec没有意义，但是在某些情况下它非常有用，比如使用BinaryCodec可以使传递内存数据块时在编解码阶段免于内存拷贝；</li><li><code>StringCodec</code> 用于字符串与二进制数据之间的编解码，其编码格式为UTF-8;</li><li><code>JSONMessageCodec</code> 用于基础数据与二进制数据之间的编解码，其支持基础数据类型以及列表、字典。其在iOS端使用了NSJSONSerialization作为序列化的工具，而在Android端则使用了其自定义的JSONUtil.与StringCodec作为序列化工具；</li><li><code>StandardMessageCodec</code> 是BasicMessageChannel的默认编解码器，其支持基础数据类型、二进制数据、列表、字典。比JSONMessageCodec更通用。</li></ul></li></ul><ol start=2><li>接收/发送消息</li></ol><p><strong>接收Dart发来的消息：</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>// BasicMessageChannel
</span></span><span class=line><span class=cl>setMessageHandler(MessageHandler<span class=p>&lt;</span><span class=nt>T</span><span class=p>&gt;</span> handler)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// MethodChannel
</span></span><span class=line><span class=cl>setMethodCallHandler(MethodCallHandler handler)
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// EventChannel
</span></span><span class=line><span class=cl>void setstreamHandler(EventChannel.StreamHandler handler)
</span></span></code></pre></div><p>其参数：</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>// BasicMessageChannel
</span></span><span class=line><span class=cl>// var1 是消息内容
</span></span><span class=line><span class=cl>// var2 是回复此消息的回调函数
</span></span><span class=line><span class=cl>public interface MessageHandler<span class=p>&lt;</span><span class=nt>T</span><span class=p>&gt;</span> {
</span></span><span class=line><span class=cl>    void onMessage(T var1, BasicMessageChannel.Reply<span class=p>&lt;</span><span class=nt>T</span><span class=p>&gt;</span> var2);
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// MethodChannel
</span></span><span class=line><span class=cl>// var1.methed 表示 var1方法名的String
</span></span><span class=line><span class=cl>// var1.arguments 表示 var1方法的参数
</span></span><span class=line><span class=cl>// var2：提供 var2.success、 var2.error、 var2.notImplemented 三种回复
</span></span><span class=line><span class=cl>public interface MethodCallHandler {
</span></span><span class=line><span class=cl>    void onMethodCall(MethodCall var1,Result var2);
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>    
</span></span><span class=line><span class=cl>// EventChannel
</span></span><span class=line><span class=cl>// args 是传递的参数
</span></span><span class=line><span class=cl>// eventSink 提供 success、error、endOfStream 三个回调方法
</span></span><span class=line><span class=cl>// onCancel 取消监听时调用
</span></span><span class=line><span class=cl>public interface StreamHandler {
</span></span><span class=line><span class=cl>    void onListen(Object args,EventChannel.Eventsink eventsink);
</span></span><span class=line><span class=cl>    void onCancel(Object o);
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p><strong>向dart发送消息：</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>void send(T message)                                        // dart不回复
</span></span><span class=line><span class=cl>void send(T message,BasicMessageChannel.Reply<span class=p>&lt;</span><span class=nt>T</span><span class=p>&gt;</span> callback)  //dart回复
</span></span></code></pre></div><p><strong>pigeon生成代码</strong></p><ol><li><p>新建flutter plugin项目</p></li><li><p>pubspec.yaml添加依赖</p></li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>dev_dependencies:
</span></span><span class=line><span class=cl>  pigeon: ^16.0.5
</span></span></code></pre></div><ol start=3><li>编写pigeon配置文件，定义通信接口</li></ol><p>lib同级目录创建一个pigeons文件夹，新建<code>input_message.dart</code>文件</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>// ignore_for_file: public_member_api_docs, sort_constructors_first
</span></span><span class=line><span class=cl>import &#39;package:pigeon/pigeon.dart&#39;;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 输出配置
</span></span><span class=line><span class=cl>// https://github.com/flutter/packages/blob/main/packages/pigeon/example/README.md
</span></span><span class=line><span class=cl>@ConfigurePigeon(PigeonOptions(
</span></span><span class=line><span class=cl>  // dart输出位置
</span></span><span class=line><span class=cl>  dartOut: &#39;./lib/pigeon/message.dart&#39;,
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  // Android输出位置
</span></span><span class=line><span class=cl>  javaOut:
</span></span><span class=line><span class=cl>      &#39;android/src/main/java/com/example/flutter_plugin/pigeon/Messages.java&#39;,
</span></span><span class=line><span class=cl>  javaOptions: JavaOptions(
</span></span><span class=line><span class=cl>    // 包名
</span></span><span class=line><span class=cl>    package: &#39;com.example.flutter_plugin.pigeon&#39;,
</span></span><span class=line><span class=cl>  ),
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  // // ios输出位置
</span></span><span class=line><span class=cl>  // // ios/flutter_pigeon_plugin.podspec -&gt; s.source_files = &#39;Classes/**/*&#39;
</span></span><span class=line><span class=cl>  // objcHeaderOut: &#39;ios/Classes/Pigeon.h&#39;,
</span></span><span class=line><span class=cl>  // objcSourceOut: &#39;ios/Classes/Pigeon.m&#39;,
</span></span><span class=line><span class=cl>  // objcOptions: ObjcOptions(
</span></span><span class=line><span class=cl>  //   // 默认前缀
</span></span><span class=line><span class=cl>  //   prefix: &#39;FLT&#39;,
</span></span><span class=line><span class=cl>  // ),
</span></span><span class=line><span class=cl>))
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 请求参数类型
</span></span><span class=line><span class=cl>class SearchRequest {
</span></span><span class=line><span class=cl>  SearchRequest({required this.query});
</span></span><span class=line><span class=cl>  String query;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 返回参数类型
</span></span><span class=line><span class=cl>class SearchReply {
</span></span><span class=line><span class=cl>  SearchReply({required this.result});
</span></span><span class=line><span class=cl>  String result;
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// flutter 调用 native
</span></span><span class=line><span class=cl>@HostApi()
</span></span><span class=line><span class=cl>abstract class FlutterCallNativeApi {
</span></span><span class=line><span class=cl>  SearchReply search(SearchRequest request);
</span></span><span class=line><span class=cl>}
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// native 调用 flutter
</span></span><span class=line><span class=cl>@FlutterApi()
</span></span><span class=line><span class=cl>abstract class NativeCallFlutterApi {
</span></span><span class=line><span class=cl>  SearchReply query(SearchRequest request);
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><p><strong>生成代码：</strong></p><p>项目目录下运行<code>dart run pigeon --input pigeons/input_message.dart</code></p><p><strong>依赖：</strong>
由于该项目作为 Flutter 插件加载，不能识别Android依赖，如果打开Android目录请在build.gradle添加以下依赖。</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>    def flutterRoot = &#34;C:\\flutter&#34;
</span></span><span class=line><span class=cl>    dependencies {
</span></span><span class=line><span class=cl>        compileOnly files(&#34;$flutterRoot/bin/cache/artifacts/engine/android-arm/flutter.jar&#34;)
</span></span><span class=line><span class=cl>        compileOnly &#39;androidx.annotation:annotation:1.9.1&#39;
</span></span><span class=line><span class=cl>    }
</span></span></code></pre></div><ol start=4><li>Android端具体实现</li></ol><p>编辑Android目录下flutterpluginPlugin.java</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>package com.example.flutterplugin;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>import android.content.Context;
</span></span><span class=line><span class=cl>import android.widget.Toast;
</span></span><span class=line><span class=cl>import androidx.annotation.NonNull;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>import com.example.flutterplugin.pigeon.Messages;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>import io.flutter.embedding.engine.plugins.FlutterPlugin;
</span></span><span class=line><span class=cl>import io.flutter.plugin.common.MethodCall;
</span></span><span class=line><span class=cl>import io.flutter.plugin.common.MethodChannel;
</span></span><span class=line><span class=cl>import io.flutter.plugin.common.MethodChannel.MethodCallHandler;
</span></span><span class=line><span class=cl>import io.flutter.plugin.common.MethodChannel.Result;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 1. 继承FlutterCallNativeApi
</span></span><span class=line><span class=cl>/** FlutterPigeonPlugin */
</span></span><span class=line><span class=cl>public class FlutterpluginPlugin implements FlutterPlugin, Messages.FlutterCallNativeApi {
</span></span><span class=line><span class=cl>  private Messages.NativeCallFlutterApi nativeApi;
</span></span><span class=line><span class=cl>  private Context context;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  @Override
</span></span><span class=line><span class=cl>  public void onAttachedToEngine(@NonNull FlutterPlugin.FlutterPluginBinding flutterPluginBinding) {
</span></span><span class=line><span class=cl>    context = flutterPluginBinding.getApplicationContext();
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    // 2. setup初始化FlutterCallNativeApi
</span></span><span class=line><span class=cl>    Messages.FlutterCallNativeApi.setUp(flutterPluginBinding.getBinaryMessenger(), this);
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    nativeApi = new Messages.NativeCallFlutterApi(flutterPluginBinding.getBinaryMessenger());
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  @Override
</span></span><span class=line><span class=cl>  public void onDetachedFromEngine(@NonNull FlutterPlugin.FlutterPluginBinding binding) {
</span></span><span class=line><span class=cl>    Messages.FlutterCallNativeApi.setUp(binding.getBinaryMessenger(), null);
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  // 3. 自定义具体search方法
</span></span><span class=line><span class=cl>  // flutter调用native
</span></span><span class=line><span class=cl>  @Override
</span></span><span class=line><span class=cl>  public Messages.SearchReply search(Messages.SearchRequest arg) {
</span></span><span class=line><span class=cl>    Messages.SearchReply reply = new Messages.SearchReply.Builder()
</span></span><span class=line><span class=cl>            .setResult(arg.getQuery() + &#34;-nativeResult&#34;)
</span></span><span class=line><span class=cl>            .build();
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    // native调用flutter
</span></span><span class=line><span class=cl>    nativeApi.query(arg, new Messages.Result<span class=p>&lt;</span><span class=nt>Messages.SearchReply</span><span class=p>&gt;</span>() {
</span></span><span class=line><span class=cl>      @Override
</span></span><span class=line><span class=cl>      public void success(Messages.SearchReply result) {
</span></span><span class=line><span class=cl>        Toast.makeText(context, result.getResult(), Toast.LENGTH_SHORT).show();
</span></span><span class=line><span class=cl>      }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>      @Override
</span></span><span class=line><span class=cl>      public void error(Throwable error) {
</span></span><span class=line><span class=cl>        // 处理错误
</span></span><span class=line><span class=cl>      }
</span></span><span class=line><span class=cl>    });
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    return reply;
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><ol start=5><li>flutter调用channel</li></ol><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>class _MyAppState extends State<span class=p>&lt;</span><span class=nt>MyApp</span><span class=p>&gt;</span> {
</span></span><span class=line><span class=cl>  String _platformVersion = &#39;Unknown&#39;;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  // 调用
</span></span><span class=line><span class=cl>  Future<span class=p>&lt;</span><span class=nt>void</span><span class=p>&gt;</span> getNativeResult() async{
</span></span><span class=line><span class=cl>    FlutterCallNativeApi api = FlutterCallNativeApi();
</span></span><span class=line><span class=cl>    SearchRequest request = SearchRequest(query: &#34;Zero&#34;);
</span></span><span class=line><span class=cl>    SearchReply reply = await api.search(request);
</span></span><span class=line><span class=cl>    setState(() {
</span></span><span class=line><span class=cl>      _platformVersion = reply.result;
</span></span><span class=line><span class=cl>    });
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>  @override
</span></span><span class=line><span class=cl>  Widget build(BuildContext context) {
</span></span><span class=line><span class=cl>    return MaterialApp(
</span></span><span class=line><span class=cl>      home: Scaffold(
</span></span><span class=line><span class=cl>        appBar: AppBar(
</span></span><span class=line><span class=cl>          title: const Text(&#39;Plugin example app&#39;),
</span></span><span class=line><span class=cl>        ),
</span></span><span class=line><span class=cl>        body: Center(
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>          child: Column(
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>            children: [
</span></span><span class=line><span class=cl>              Text(&#39;Running on: $_platformVersion\n&#39;),
</span></span><span class=line><span class=cl>              MaterialButton(
</span></span><span class=line><span class=cl>                  height: 40,
</span></span><span class=line><span class=cl>                  color: Colors.blue,
</span></span><span class=line><span class=cl>                  textColor: Colors.white,
</span></span><span class=line><span class=cl>                  elevation: 5,
</span></span><span class=line><span class=cl>                  splashColor: Colors.teal,
</span></span><span class=line><span class=cl>                  padding: EdgeInsets.all(8),
</span></span><span class=line><span class=cl>                  child: Text(&#34;点击调用 native&#34;),
</span></span><span class=line><span class=cl>                  onPressed: ()=&gt;{
</span></span><span class=line><span class=cl>                    getNativeResult()
</span></span><span class=line><span class=cl>                  })
</span></span><span class=line><span class=cl>            ],
</span></span><span class=line><span class=cl>          ),
</span></span><span class=line><span class=cl>        ),
</span></span><span class=line><span class=cl>      ),
</span></span><span class=line><span class=cl>    );
</span></span><span class=line><span class=cl>  }
</span></span><span class=line><span class=cl>}
</span></span></code></pre></div><h4 id=androidmanifestxml>AndroidManifest.xml</h4><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl><span class=cp>&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34;?&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;</span><span class=nt>manifest</span> <span class=na>xmlns:android</span><span class=o>=</span><span class=s>&#34;http://schemas.android.com/apk/res/android&#34;</span>
</span></span><span class=line><span class=cl>	<span class=err>&lt;!</span><span class=na>--</span> <span class=err>应用的包名、版本</span> <span class=na>--</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>    package=&#34;com.example.app&#34;
</span></span><span class=line><span class=cl>    android:versionCode=&#34;1&#34;
</span></span><span class=line><span class=cl>    android:versionName=&#34;1.0.1&#34;&gt;
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!-- 权限设置 ---&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.INTERNET&#34;</span><span class=p>/&gt;</span>           <span class=c>&lt;!---访问网络&gt;  
</span></span></span><span class=line><span class=cl><span class=c>    &lt;uses-permission android:name=&#34;android.permission.ACCESS_NETWORK_STATE&#34;/&gt; &lt;!---网络连接是否有效&gt;
</span></span></span><span class=line><span class=cl><span class=c>    &lt;uses-permission android:name=&#34;android.permission.WRITE_EXTERNAL_STORAGE&#34;/&gt; &lt;!--读写外部存储器&gt;
</span></span></span><span class=line><span class=cl><span class=c>
</span></span></span><span class=line><span class=cl><span class=c>    &lt;application
</span></span></span><span class=line><span class=cl><span class=c>    	&lt;!---参考：https://juejin.cn/post/7006296858494500877--&gt;</span>
</span></span><span class=line><span class=cl>        android:allowBackup=&#34;true&#34;                <span class=c>&lt;!---允许app数据备份--&gt;</span>
</span></span><span class=line><span class=cl>        android:icon=&#34;@mipmap/ic_launcher&#34;        <span class=c>&lt;!--图标--&gt;</span>
</span></span><span class=line><span class=cl>        android:label=&#34;@string/app_name&#34;          <span class=c>&lt;!--标题--&gt;</span>
</span></span><span class=line><span class=cl>        android:name=&#34;.App&#34;                       <span class=c>&lt;!--应用程序开始的类名--&gt;</span>
</span></span><span class=line><span class=cl>        android:theme=&#34;@style/AppTheme&#34; &gt;         <span class=c>&lt;!--主题--&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>activity</span>
</span></span><span class=line><span class=cl>            <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;.ui.activities.MainActivity&#34;</span>   <span class=err>&lt;!</span><span class=na>--activity</span><span class=err>名称</span><span class=na>--</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            android:screenOrientation=&#34;portrait&#34;         <span class=c>&lt;!--限制此页为竖屏显示--&gt;</span>
</span></span><span class=line><span class=cl>            android:label=&#34;@string/app_name&#34; &gt;           <span class=c>&lt;!--标签名称--&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>intent-filter</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>action</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.intent.action.MAIN&#34;</span> <span class=p>/&gt;</span>        <span class=c>&lt;!--Main point--&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>category</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.intent.category.LAUNCHER&#34;</span> <span class=p>/&gt;</span>  <span class=c>&lt;!--启动时有效--&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;/</span><span class=nt>intent-filter</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>activity</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>activity</span>
</span></span><span class=line><span class=cl>                <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;.ui.activities.LoginActivity&#34;</span>
</span></span><span class=line><span class=cl>                <span class=na>android:screenOrientation</span><span class=o>=</span><span class=s>&#34;portrait&#34;</span>
</span></span><span class=line><span class=cl>                <span class=na>android:label</span><span class=o>=</span><span class=s>&#34;@string/app_name&#34;</span> <span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>activity</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>service</span>
</span></span><span class=line><span class=cl>            <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;com.csr.csrmesh2.MeshService&#34;</span>
</span></span><span class=line><span class=cl>            <span class=na>android:enabled</span><span class=o>=</span><span class=s>&#34;true&#34;</span>
</span></span><span class=line><span class=cl>            <span class=na>android:exported</span><span class=o>=</span><span class=s>&#34;false&#34;</span> <span class=p>&gt;</span>      <span class=c>&lt;!--禁止此服务被其他组件调用和交互--&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>service</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>receiver</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;.events.ConnectionChangeReceiver&#34;</span>
</span></span><span class=line><span class=cl>                  <span class=na>android:label</span><span class=o>=</span><span class=s>&#34;ConnectionChangeReceiver&#34;</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;</span><span class=nt>intent-filter</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>                <span class=p>&lt;</span><span class=nt>action</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.net.conn.CONNECTIVITY_CHANGE&#34;</span> <span class=p>/&gt;</span>    <span class=c>&lt;!--网络连接发生变化--&gt;</span>
</span></span><span class=line><span class=cl><span class=c>&lt;!--                &lt;action android:name=&#34;android.net.wifi.WIFI_STATE_CHANGED&#34; /&gt;--&gt;</span>
</span></span><span class=line><span class=cl>            <span class=p>&lt;/</span><span class=nt>intent-filter</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;/</span><span class=nt>receiver</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>        
</span></span><span class=line><span class=cl>         <span class=c>&lt;!--组件相关配置--&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>meta-data</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;com.facebook.sdk.ApplicationId&#34;</span> <span class=na>android:value</span><span class=o>=</span><span class=s>&#34;@string/facebook_app_id&#34;</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>        <span class=p>&lt;</span><span class=nt>meta-data</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;com.facebook.sdk.ApplicationName&#34;</span> <span class=na>android:value</span><span class=o>=</span><span class=s>&#34;@string/app_name&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;/</span><span class=nt>application</span><span class=p>&gt;</span>
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl><span class=p>&lt;/</span><span class=nt>manifest</span><span class=p>&gt;</span>
</span></span></code></pre></div><p><strong>常用权限（<a class=link href=https://www.ecjson.com/android/ target=_blank rel=noopener>查看权限大全</a>）</strong></p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>    <span class=c>&lt;!--网络--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.INTERNET&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.ACCESS_NETWORK_STATE&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.ACCESS_WIFI_STATE&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.CHANGE_WIFI_STATE&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.MODIFY_AUDIO_SETTINGS&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--文件读写--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.READ_EXTERNAL_STORAGE&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.WRITE_EXTERNAL_STORAGE&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--录音机--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.RECORD_AUDIO&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--读取手机状态，获取IMEI --&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.READ_PHONE_STATE&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.MANAGE_EXTERNAL_STORAGE&#34;</span><span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--蓝牙--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.BLUETOOTH&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.BLUETOOTH_ADMIN&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--相机，及硬件支持--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.CAMERA&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-feature</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.hardware.camera&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-feature</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.hardware.camera.autofocus&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--接收彩信--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.RECEIVE_MMS&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--访问GMail账户列表--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.GET_ACCOUNTS&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--精确位置、粗略位置--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.ACCESS_FINE_LOCATION&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.ACCESS_COARSE_LOCATION&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>  	
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--以下不太常用--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--读写日历--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.READ_CALENDAR&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.WRITE_CALENDAR&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--读写通讯录--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.READ_CONTACTS&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.WRITE_CONTACTS&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--读取电话号码，Android11及以上使用READ_PHONE_NUMBERS--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.READ_PHONE_STATE&#34;</span>
</span></span><span class=line><span class=cl>                     <span class=na>android:maxSdkVersion</span><span class=o>=</span><span class=s>&#34;29&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.READ_PHONE_NUMBERS&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--获取传感器（心率等）信息--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.BODY_SENSORS&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--收发短信--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.RECEIVE_SMS&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.SEND_SMS&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=c>&lt;!--悬浮窗、在其他应用上显示--&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.SYSTEM_ALERT_WINDOW&#34;</span> <span class=p>/&gt;</span>
</span></span><span class=line><span class=cl>    <span class=p>&lt;</span><span class=nt>uses-permission</span> <span class=na>android:name</span><span class=o>=</span><span class=s>&#34;android.permission.SYSTEM_OVERLAY_WINDOW&#34;</span> <span class=p>/&gt;</span>
</span></span></code></pre></div><p><strong>存储权限</strong>（Android 10 版本引入了分区存储机制）</p><p><a class=link href="https://juejin.cn/post/7306815404562137128?from=search-suggest#heading-6" target=_blank rel=noopener>参考</a></p><p><img src=/p/flutter/11.png width=4790 height=1559 srcset="/p/flutter/11_hu2dbc4b639928f45267efbc5a735e5ee6_617115_480x0_resize_box_3.png 480w, /p/flutter/11_hu2dbc4b639928f45267efbc5a735e5ee6_617115_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=307 data-flex-basis=737px></p><h4 id=xml视图>XML视图</h4><p><img src=/p/flutter/layout-editor.png width=3788 height=2182 srcset="/p/flutter/layout-editor_hu7509936c93e21b6fdf351cf9effaac61_485398_480x0_resize_box_3.png 480w, /p/flutter/layout-editor_hu7509936c93e21b6fdf351cf9effaac61_485398_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=173 data-flex-basis=416px></p><p><strong>常见属性</strong></p><p><img src=/p/flutter/12.png width=980 height=1881 srcset="/p/flutter/12_hue237523be3f464234383965a561bdf14_119818_480x0_resize_box_3.png 480w, /p/flutter/12_hue237523be3f464234383965a561bdf14_119818_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=52 data-flex-basis=125px></p><div class=table-wrapper><table><thead><tr><th>gravity属性值</th><th>说明</th></tr></thead><tbody><tr><td>top</td><td>不改变控件大小，对齐到容器顶部</td></tr><tr><td>bottom</td><td>不改变控件大小，对齐到容器底部</td></tr><tr><td>left</td><td>不改变控件大小，对齐到容器左侧</td></tr><tr><td>right</td><td>不改变控件大小，对齐到容器右侧</td></tr><tr><td>center_vertical</td><td>不改变控件大小，对齐到容器纵向中央位置</td></tr><tr><td>center_horizontal</td><td>不改变控件大小，对齐到容器横向中央位置</td></tr><tr><td>center</td><td>不改变控件大小，对齐到容器中央位置</td></tr><tr><td>fill_vertical</td><td>若有可能，纵向拉伸以填满容器</td></tr><tr><td>fill_horizontal</td><td>若有可能，横向拉伸以填满容器</td></tr><tr><td>fill</td><td>若有可能，纵向横向同时拉伸填满容器</td></tr></tbody></table></div><p><strong>特殊属性</strong></p><p><img src=/p/flutter/13.png width=1220 height=950 srcset="/p/flutter/13_hu92ff4c80d80fef0ba3551a77eba7b327_183074_480x0_resize_box_3.png 480w, /p/flutter/13_hu92ff4c80d80fef0ba3551a77eba7b327_183074_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=128 data-flex-basis=308px></p><h3 id=常用-api>常用 API：</h3><p><a class=link href=https://api.flutter.dev/javadoc/io/flutter/embedding/engine/plugins/FlutterPlugin.FlutterPluginBinding.html target=_blank rel=noopener>FlutterPluginBinding</a>: 向所有 FlutterEngine 注册的插件提供可用的资源。</p><p><a class=link href=https://api.flutter.dev/javadoc/io/flutter/embedding/engine/plugins/activity/ActivityPluginBinding.html target=_blank rel=noopener>ActivityPluginBinding</a> : 绑定使ActivityAware插件可以访问关联的Activity和Activity的生命周期方法。</p><p><a class=link href=https://api.flutter.dev/javadoc/io/flutter/embedding/engine/plugins/activity/ActivityAware.html target=_blank rel=noopener>ActivityAware</a>: FlutterPlugin 把 Activity生命周期事件 关联到 FlutterEngine中运行的Activity</p><p><a class=link href=https://api.flutter-io.cn/javadoc/io/flutter/embedding/android/FlutterView.html target=_blank rel=noopener>FlutterView</a>: 在 Android 设备上显示 Flutter UI</p><p><a class=link href=https://developer.android.com/reference/android/app/NotificationManager target=_blank rel=noopener>NotificationManager</a>：用于通知用户发生的事件</p><p><a class=link href=https://developer.android.com/reference/android/content/res/Resources target=_blank rel=noopener>Resources</a>: 用于访问应用程序资源的类。</p><h2 id=调试>调试</h2><h3 id=vs-code-debug>VS Code debug</h3><p><a class=link href="https://www.bilibili.com/video/BV1Jf4y1S7Bw/?spm%5C_id%5C_from=333.788.videocard.0&amp;vd_source=e3bb7819c2465f903aea3ffaa2d0773b" target=_blank rel=noopener>参考</a></p><p><strong>运行前提</strong></p><ul><li>当前编程语言环境</li><li>当前编程语言用于调试的扩展，例如Java Extension Pack</li><li>配置文件launch.json</li></ul><p><strong>按钮介绍</strong></p><p><img src=/p/flutter/toolbar.png width=216 height=32 srcset="/p/flutter/toolbar_hu7580616d3674f764d0b734204110ef29_439_480x0_resize_box_3.png 480w, /p/flutter/toolbar_hu7580616d3674f764d0b734204110ef29_439_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=675 data-flex-basis=1620px></p><p>继续：跳到下一个断点</p><p>单步跳过：跳过当前语句（调用其他文件夹的所有语句），运行下一行</p><p>单步调试：进入当前函数内，运行下一行</p><p>单步跳出：当debug陷入某个循环时，跳出循环并执行循环外的语句</p><p>重启</p><p><strong>配置文件</strong></p><p>launch.json是用于调试的配置文件，位于<code>.vscode</code>文件夹，大多数情况下会自动创建，也可以在左侧边栏<code>Run and Debug</code>点击<code>create a launch.json file</code>
<details class=spoiler id=spoiler-23><summary>launch.json注释（无需了解）</summary><p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>    &#34;configurations&#34;: [
</span></span><span class=line><span class=cl>        {
</span></span><span class=line><span class=cl>            // 正在调试的项目名称（左侧边栏下拉菜单）
</span></span><span class=line><span class=cl>            &#34;name&#34;: &#34;flutter_project&#34;,   
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            // 指定调试模式
</span></span><span class=line><span class=cl>            // launch模式：支持断点调试
</span></span><span class=line><span class=cl>            // attach模式：支持对运行中的程序（多为远程服务器)断点调试，点击Add Configuration，选择Attach to Process
</span></span><span class=line><span class=cl>            &#34;request&#34;: &#34;launch&#34;,
</span></span><span class=line><span class=cl>            
</span></span><span class=line><span class=cl>            // 编程语言                    
</span></span><span class=line><span class=cl>            &#34;type&#34;: &#34;dart&#34;
</span></span><span class=line><span class=cl>        },
</span></span><span class=line><span class=cl>    ]
</span></span></code></pre></div></p></details></p><p><strong>断点类型</strong></p><p>在代码行左侧断点出右键看到3种类型：</p><ul><li>Add Breakpoint：在断点处阻塞程序</li><li>Add Conditional Breakpoint：在条件为true时断点生效</li><li>Add Logpoint：程序运行中，以非阻塞的方式，记录调试日志</li><li>Inline Breakpoint：当一行代码中有多个函数，光标定位在函数前，Run -> New Breakpoint -> Inline Breakpoint，断点在当前函数之前生效，点击单步调试可以进入当前函数</li></ul><h3 id=布局调试>布局调试</h3><p><a class=link href="https://www.bilibili.com/video/BV1qN4y1M7nR/?spm_id_from=888.80997.embed_other.whitelist&amp;t=48.359897&amp;bvid=BV1qN4y1M7nR&amp;vd_source=e3bb7819c2465f903aea3ffaa2d0773b" target=_blank rel=noopener>参考</a></p><p><img src=/p/flutter/8.png width=1988 height=1660 srcset="/p/flutter/8_hud8585a5925bc821c6f6926c73e3a70ba_436204_480x0_resize_box_3.png 480w, /p/flutter/8_hud8585a5925bc821c6f6926c73e3a70ba_436204_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=119 data-flex-basis=287px></p><h3 id=模拟器>模拟器</h3><p><strong>开启hyper-v</strong></p><p>Windows搜索 -> 启用与关闭Windows功能 -> hyper-v</p><p>模拟器报错：找不到libandroid-emu-metrics.dll，重启hyper-v</p><p><strong>vscode连接第三方模拟器</strong></p><p>项目目录下执行：<code>adb connect 127.0.0.1:[port]</code></p><h2 id=ai画图>AI画图</h2><p>Ai 设置：视图->显示网格</p><p>多边形变换：多边形工具->自定义变换工具</p><p>缩放：鼠标左键向右划放大、向左划缩小</p><p>形状合成：选中区域->形状生成器工具->穿过需要的区域->按住Alt穿过不要的区域</p><p>渐变：双击圆圈弹出调色板</p><h2 id=动画>动画</h2><p><img src=/p/flutter/donghua.png width=1396 height=785 srcset="/p/flutter/donghua_hub3ab5e6cde8a9a4aeac5a591ce269148_435997_480x0_resize_box_3.png 480w, /p/flutter/donghua_hub3ab5e6cde8a9a4aeac5a591ce269148_435997_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=177 data-flex-basis=426px></p><p>lottie需要用到Ae，rive是在线编辑。</p><h2 id=上架>上架</h2><h3 id=包名>包名</h3><ul><li>Android 是在 <code>android</code> ▸ <code>app</code> ▸ <code>src</code> ▸ <code>main</code> ▸ <code>AndroidManifest.xml</code></li><li>iOS 在 <code>ios</code> ▸ <code>Runner</code> ▸ <code>Info.plist</code></li></ul><h3 id=应用名称>应用名称</h3><ul><li>Android 是在 <code>android</code> ▸ <code>app</code> ▸ <code>src</code> ▸ <code>main</code> ▸ <code>AndroidManifest.xml</code> 中修改<code>android:label="XXX"</code>;</li><li>iOS 在 <code>ios</code> ▸ <code>Runner</code> ▸ <code>Info.plist</code> 中修改<code>CFBundleName</code>对应的Value</li></ul><h3 id=图标>图标</h3><ul><li>Android 在<code>android</code> ▸ <code>app</code> ▸ <code>src</code> ▸ <code>res</code> ▸ <code>mipmap-...</code> 文件夹中替换相应图片</li><li>iOS 在 <code>ios</code> ▸ <code>Runner</code> ▸ <code>Assets.xcassets</code> ▸ <code>AppIcon.appiconset</code>文件夹中替换相应尺寸的图片， 如果使用不同的文件名，那还必须更新同一目录中的<code>Contents.json</code>文件。</li></ul><h3 id=启动图片>启动图片</h3><ul><li>Android 在<code>android</code> ▸ <code>app</code> ▸ <code>src</code> ▸ <code>res</code> ▸ <code>drawable</code> ▸ <code>launch_background.xml</code> 通过自定义drawable来实现自定义启动界面。</li><li>iOS 在 <code>ios</code> ▸ <code>Runner</code> ▸ <code>Assets.xcassets</code> ▸ <code>LaunchImage.imageset</code>文件夹中替换相应尺寸的图片， 如果使用不同的文件名，那还必须更新同一目录中的<code>Contents.json</code>文件。</li></ul><h3 id=签名安卓>签名（安卓）</h3><ol><li>创建</li></ol><ul><li>android studio方法</li></ul><p>以管理员身份运行 android studio -> 打开项目下的Android文件夹 -> Build -> Generate Signed Bundle / APK -> 选择 APK 点击 Next -> Create new</p><p><img src=/p/flutter/keystore.png width=658 height=669 srcset="/p/flutter/keystore_hu9e11625d68bcb57a0089d116b2122c43_27301_480x0_resize_box_3.png 480w, /p/flutter/keystore_hu9e11625d68bcb57a0089d116b2122c43_27301_1024x0_resize_box_3.png 1024w" loading=lazy class=gallery-image data-flex-grow=98 data-flex-basis=236px></p><ul><li><strong>命令行ketool方法（推荐）</strong></li></ul><p>ketool容易修改密钥，参考<a class=link href=https://docs.oracle.com/javase/8/docs/technotes/tools/windows/keytool.html#keytool_option_gencert target=_blank rel=noopener>Java8版官方文档</a>或<a class=link href=https://docs.oracle.com/en/java/javase/index.html target=_blank rel=noopener>更多版本</a>。</p><p><strong>使用：</strong></p><p>项目下的Android/app文件夹打开cmd</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>// 创建keystore和密钥对
</span></span><span class=line><span class=cl>keytool -genkeypair -alias key -keyalg RSA -keysize 2048 -validity 10000 -keystore ./release.keystore.jks
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 列出可用的证书别名（指定路径）
</span></span><span class=line><span class=cl>keytool -list -v -keystore ./release.keystore.jks
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>// 删除证书（指定别名、路径）                    
</span></span><span class=line><span class=cl>keytool -delete -alias key -keystore ./release.keystore.jks
</span></span></code></pre></div><details class=spoiler id=spoiler-24><summary>详细参数</summary><p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>-genkeypair 生成密钥对（公钥和关联的私钥）。将该证书链和私钥存储在由alias标识的新密钥库条目中
</span></span><span class=line><span class=cl>-alias 别名，每个keystore都关联这一个独一无二的alias，这个alias通常不区分大小写
</span></span><span class=line><span class=cl>-keystore 密钥库位置
</span></span><span class=line><span class=cl>-keyalg 指定密钥的算法 (默认值：DSA)
</span></span><span class=line><span class=cl>-keysize 指定密钥长度 （默认值取决于keyalg：RSA为2048，DSA为1024）
</span></span><span class=line><span class=cl>-validity 指定创建的证书有效期多少天(默认 90)
</span></span><span class=line><span class=cl>-storepass 指定密钥库的密码(获取keystore信息所需的密码)
</span></span><span class=line><span class=cl>-keypass 指定别名条目的密码(私钥的密码)
</span></span><span class=line><span class=cl>-dname 指定证书发行者信息 其中： “CN=名字与姓氏,OU=组织单位名称,O=组织名称,L=城市或区域名 称,ST=州或省份名称,C=单位的两字母国家代码”
</span></span><span class=line><span class=cl>-list 显示密钥库中的证书信息 
</span></span><span class=line><span class=cl>-export 将别名指定的证书导出到文件 keytool -export -alias 需要导出的别名 -keystore 指定keystore -file 指定导出的证书位置及证书名称 -storepass 密码
</span></span><span class=line><span class=cl>-file 参数指定导出到文件的文件名
</span></span><span class=line><span class=cl>-delete 删除密钥库中某条目 keytool -delete -alias 指定需删除的别 -keystore 指定keystore – storepass 密码
</span></span><span class=line><span class=cl>-printcert 查看导出的证书信息 keytool -printcert -file g:\sso\michael.crt
</span></span><span class=line><span class=cl>-keypasswd 修改密钥库中指定条目口令 keytool -keypasswd -alias 需修改的别名 -keypass 旧密码 -new 新密码 -storepass keystore密码 -keystore sage
</span></span><span class=line><span class=cl>-storepasswd 修改keystore口令 keytool -storepasswd -keystore g:\sso\michael.keystore(需修改口令的keystore) -storepass pwdold(原始密码) -new pwdnew(新密码)
</span></span><span class=line><span class=cl>-import 将已签名数字证书导入密钥库 keytool -import -alias 指定导入条目的别名 -keystore 指定keystore -file 需导入的证书
</span></span><span class=line><span class=cl>中创建一个默认文件”.keystore”,还会产生一个mykey的别名，mykey中包含用户的公钥、私钥和证书(在没有指定生成位置的情况下,keystore会存在用户系统默认目录)
</span></span></code></pre></div></p></details><ol start=2><li><strong>配置</strong></li></ol><ul><li>为防止 build.gradle 协作时被修改、上线后反编译泄露，把密钥信息保存到 android/local.properties：</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>storePassword=12345678
</span></span><span class=line><span class=cl>keyPassword=12345678
</span></span><span class=line><span class=cl>keyAlias=key
</span></span><span class=line><span class=cl>storeFile=./release.keystore.jks
</span></span></code></pre></div><p>local.properties默认不会被添加到Git提交到远程仓库。</p><ul><li>在android/app/build.gradle添加：</li></ul><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>// 读取 local.properties
</span></span><span class=line><span class=cl>def mystoreFile = file(localProperties.getProperty(&#39;storeFile&#39;))
</span></span><span class=line><span class=cl>def mystorePassword = localProperties.getProperty(&#39;storePassword&#39;)
</span></span><span class=line><span class=cl>def mykeyAlias = localProperties.getProperty(&#39;keyAlias&#39;)
</span></span><span class=line><span class=cl>def mykeyPassword = localProperties.getProperty(&#39;keyPassword&#39;)
</span></span></code></pre></div><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>    // 签名配置
</span></span><span class=line><span class=cl>    signingConfigs {
</span></span><span class=line><span class=cl>        release {
</span></span><span class=line><span class=cl>            keyAlias mykeyAlias
</span></span><span class=line><span class=cl>            keyPassword mykeyPassword
</span></span><span class=line><span class=cl>            storeFile mystoreFile
</span></span><span class=line><span class=cl>            storePassword mystorePassword
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>        // // debug模式使用默认的 C:\Users<span class=err>&lt;</span>用户名&gt;.Android\debug.keystore 进行签名，密码是 android
</span></span><span class=line><span class=cl>        // debug {
</span></span><span class=line><span class=cl>        //     keyAlias &#39;androiddebugkey&#39;
</span></span><span class=line><span class=cl>        //     keyPassword &#39;android&#39;
</span></span><span class=line><span class=cl>        //     storeFile file(&#39;C:\\Users\\90487\\.android\\debug.keystore&#39;)
</span></span><span class=line><span class=cl>        //     storePassword &#39;android&#39;
</span></span><span class=line><span class=cl>        // }
</span></span><span class=line><span class=cl>    }
</span></span><span class=line><span class=cl>
</span></span><span class=line><span class=cl>    buildTypes {
</span></span><span class=line><span class=cl>        release {
</span></span><span class=line><span class=cl>            // TODO: Add your own signing config for the release build.
</span></span><span class=line><span class=cl>            // Signing with the debug keys for now, so `flutter run --release` works.
</span></span><span class=line><span class=cl>            signingConfig signingConfigs.release
</span></span><span class=line><span class=cl>            // // 混淆
</span></span><span class=line><span class=cl>            // minifyEnabled false
</span></span><span class=line><span class=cl>            // // 混淆文件
</span></span><span class=line><span class=cl>            // proguardFiles getDefaultProguardFile(&#39;proguard-android-optimize.txt&#39;), &#39;proguard-rules.pro&#39;
</span></span><span class=line><span class=cl>        }
</span></span><span class=line><span class=cl>        // debug {
</span></span><span class=line><span class=cl>        //     signingConfig signingConfigs.debug
</span></span><span class=line><span class=cl>        //     // // 包名后添加.debug，可以同时安装多个应用
</span></span><span class=line><span class=cl>        //     // applicationIdSuffix &#39;.debug&#39;
</span></span><span class=line><span class=cl>        // }
</span></span><span class=line><span class=cl>    }
</span></span></code></pre></div><p>android studio验证配置：File -> Project Structure -> Modules -> Signing Configs</p><p>参考：<a class=link href=https://developer.android.com/studio/publish/app-signing#generate-key target=_blank rel=noopener>官方文档</a> <a class=link href=https://juejin.cn/post/6844903942007029773#heading-5 target=_blank rel=noopener>buildTypes</a></p><ol start=3><li><strong>生成签名报告（可以获得md5）</strong></li></ol><p>点击右侧Gradle选项卡，android -> app -> Tasks -> android -> signingReport。</p><p>如果 Gradle 面板目录中没有 signingReport 文件，进入设置项：File -> Settings -> Experimental -> 取消选中 Only include&mldr;during Gradle Sync。然后同步一下：File -> Sync Project with Gradle Files。</p><h3 id=编译>编译</h3><ul><li>apk</li></ul><p>项目根目录下执行</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>flutter build apk --split-per-abi
</span></span></code></pre></div><ul><li>bundles（google 平台需要 bundle 文件格式）</li></ul><p>项目根目录下执行</p><div class=highlight><pre tabindex=0 class=chroma><code class=language-html data-lang=html><span class=line><span class=cl>flutter build appbundle
</span></span></code></pre></div><p>输出 build/app/outputs/bundle/release/app-release.aab</p><h2 id=其他-1>其他</h2><p>double width = MediaQuery.of(context).size.width; 屏幕宽度</p><p>double height = MediaQuery.of(context).size.height; 屏幕高度</p></section><footer class=article-footer><section class=article-copyright><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-copyright" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><path d="M14.5 9a3.5 4 0 100 6"/></svg><span>Licensed under CC BY-NC-SA 4.0</span></section><section class=article-lastmod><svg xmlns="http://www.w3.org/2000/svg" class="icon icon-tabler icon-tabler-clock" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentcolor" fill="none" stroke-linecap="round" stroke-linejoin="round" style="margin:0 5px"><path stroke="none" d="M0 0h24v24H0z"/><circle cx="12" cy="12" r="9"/><polyline points="12 7 12 12 15 15"/></svg><span>最后更新于 2024-11-30</span></section></footer><div class=article-details></div></article><script src=//unpkg.com/@waline/client@v2/dist/waline.js></script>
<link href=//unpkg.com/@waline/client@v2/dist/waline.css rel=stylesheet><div id=waline class=waline-container></div><style>.waline-container{background-color:var(--card-background);border-radius:var(--card-border-radius);box-shadow:var(--shadow-l1);padding:var(--card-padding);--waline-font-size:var(--article-font-size)}.waline-container .wl-count{color:var(--card-text-color-main)}</style><script>Waline.init({dark:'html[data-scheme="dark"]',el:"#waline",emoji:["https://cdn.jsdelivr.net/gh/walinejs/emojis/weibo"],locale:{admin:"Admin",placeholder:null},requiredMeta:["name","email","url"],serverURL:"https://myblog-rho-ebon.vercel.app/"})</script><footer class=site-footer><section class=copyright>&copy;
2021 -
2025 Janus</section><section class=powerby>Built with <a href=https://gohugo.io/ target=_blank rel=noopener>Hugo</a><br>主题 <b><a href=https://github.com/CaiJimmy/hugo-theme-stack target=_blank rel=noopener data-version=3.16.0>Stack</a></b> 由 <a href=https://jimmycai.com target=_blank rel=noopener>Jimmy</a> 设计</section></footer><div class=pswp tabindex=-1 role=dialog aria-hidden=true><div class=pswp__bg></div><div class=pswp__scroll-wrap><div class=pswp__container><div class=pswp__item></div><div class=pswp__item></div><div class=pswp__item></div></div><div class="pswp__ui pswp__ui--hidden"><div class=pswp__top-bar><div class=pswp__counter></div><button class="pswp__button pswp__button--close" title="Close (Esc)"></button>
<button class="pswp__button pswp__button--share" title=Share></button>
<button class="pswp__button pswp__button--fs" title="Toggle fullscreen"></button>
<button class="pswp__button pswp__button--zoom" title="Zoom in/out"></button><div class=pswp__preloader><div class=pswp__preloader__icn><div class=pswp__preloader__cut><div class=pswp__preloader__donut></div></div></div></div></div><div class="pswp__share-modal pswp__share-modal--hidden pswp__single-tap"><div class=pswp__share-tooltip></div></div><button class="pswp__button pswp__button--arrow--left" title="Previous (arrow left)"></button>
<button class="pswp__button pswp__button--arrow--right" title="Next (arrow right)"></button><div class=pswp__caption><div class=pswp__caption__center></div></div></div></div></div><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.js integrity="sha256-ePwmChbbvXbsO02lbM3HoHbSHTHFAeChekF1xKJdleo=" crossorigin=anonymous defer></script><script src=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe-ui-default.min.js integrity="sha256-UKkzOn/w1mBxRmLLGrSeyB4e1xbrp4xylgAWb3M42pU=" crossorigin=anonymous defer></script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/default-skin/default-skin.min.css crossorigin=anonymous><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/photoswipe@4.1.3/dist/photoswipe.min.css crossorigin=anonymous></main></div><script type=text/javascript src=/ts/main.js defer></script>
<script>function adsenseDelay(){var t=document.getElementsByTagName("head")[0],e=document.createElement("script");e.type="text/javascript",e.src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-1748363845231571",e.setAttribute("crossorigin","anonymous"),t.appendChild(e)}function analyticsDelay(){var t=document.getElementsByTagName("head")[0],e=document.createElement("script");e.type="text/javascript",e.src="https://www.googletagmanager.com/gtag/js?id=UA-124746836-1",t.appendChild(e)}function gtag(){dataLayer.push(arguments)}setTimeout(adsenseDelay,1500),setTimeout(analyticsDelay,1500),window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-124746836-1")</script></body></html>